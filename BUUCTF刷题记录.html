<!DOCTYPE html>
<html lang="zh-CN">





<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.png">
  <link rel="icon" type="image/png" href="/img/favicon.ico">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="description" content="有梦就去追，没死就别停">
  <meta name="author" content="bufsnake">
  <meta name="keywords" content="web安全,逆向,ctf,pwn,crypto,misc,android,安卓,破解,底层">
  <title>BUUCTF刷题记录 ~ bufsnake</title>

  <link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<link rel="stylesheet" href="/lib/bootstrap/css/bootstrap.min.css">
<link rel="stylesheet" href="/lib/mdbootstrap/css/mdb.min.css">
<link rel="stylesheet" href="/lib/github-markdown/github-markdown.min.css">
<link rel="stylesheet" href="//at.alicdn.com/t/font_1067060_qzomjdt8bmp.css">


  <link rel="stylesheet" href="/lib/prettify/tomorrow.min.css">

<link rel="stylesheet" href="/css/main.css">


  <link rel="stylesheet" href="/lib/fancybox/jquery.fancybox.min.css">


</head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">&nbsp;<strong>bufsnake</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/">首页</a>
          </li>
        
          
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/archives/">归档</a>
          </li>
        
          
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/categories/">分类</a>
          </li>
        
          
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/tags/">标签</a>
          </li>
        
          
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/about/">关于</a>
          </li>
        
          
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/links/">友链</a>
          </li>
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;&nbsp;<i class="iconfont icon-search"></i>&nbsp;&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="view intro-2" id="background" false
         style="background: url('/img/default.webp')no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask rgba-black-light flex-center">
          <div class="container text-center white-text fadeInUp">
            <span class="h2" id="subtitle">
              
            </span>

            
              <br>
              
                <p class="mt-3">
                  <i class="fas fa-calendar-alt" aria-hidden="true"></i>&nbsp;
                  星期四, 四月 30日 2020, 1:30 下午
                </p>
              

              <p>
                
                  
                  &nbsp;<i class="far fa-chart-bar"></i>
                  <span class="post-count">
                    3.6k 字
                  </span>&nbsp;
                

                
                  
                  &nbsp;<i class="far fa-clock"></i>
                  <span class="post-count">
                      18 分钟
                  </span>&nbsp;
                

                
                  <!-- 不蒜子统计文章PV -->
                  
                  &nbsp;<i class="far fa-eye" aria-hidden="true"></i>&nbsp;
                  <span id="busuanzi_container_page_pv">
                    <span id="busuanzi_value_page_pv"></span> 次
                  </span>&nbsp;
                
              </p>
            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid">
  <div class="row">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-md">
      <div class="py-5 z-depth-3" id="board">
        <div class="post-content mx-auto" id="post">
          <div class="markdown-body">
            <h2 id="不一样的flag"><a href="#不一样的flag" class="headerlink" title="不一样的flag"></a>不一样的flag</h2><p>ida F5得到伪代码</p>
<p><img src="/images/BUUCTF-RE.assets/image-20200427142729388.png" srcset="/img/loading.gif" alt="image-20200427142729388"></p>
<p>查看字符串，得到一串特殊字符</p>
<p><img src="/images/BUUCTF-RE.assets/image-20200427142748004.png" srcset="/img/loading.gif" alt="image-20200427142748004"></p>
<p>长度为25，综合考虑了一下，发现考点为”迷宫”</p>
<pre><code class="python">*1111
01000
01010
00010
1111#
</code></pre>
<p>输入一下代码</p>
<p><code>222441144222</code></p>
<p>可以得到</p>
<p><img src="/images/BUUCTF-RE.assets/image-20200427144407701.png" srcset="/img/loading.gif" alt="image-20200427144407701"></p>
<p>flag为:flag{222441144222}</p>
<h2 id="CrackRTF"><a href="#CrackRTF" class="headerlink" title="CrackRTF"></a>CrackRTF</h2><p>首先分析一下sub_40100A函数</p>
<p><img src="/images/BUUCTF-RE.assets/image-20200429090809250.png" srcset="/img/loading.gif" alt="image-20200429090809250"></p>
<p>打开后发现调用的是sub_401230函数，接下来分析sub_401230函数</p>
<p><img src="/images/BUUCTF-RE.assets/image-20200429090905109.png" srcset="/img/loading.gif" alt="image-20200429090905109"></p>
<pre><code class="c">// 主要函数 
BOOL CryptCreateHash(
  HCRYPTPROV hProv,
  ALG_ID     Algid,  // 指定加密的密码 这里 0x8004 指定的是sha1
  HCRYPTKEY  hKey,
  DWORD      dwFlags,
  HCRYPTHASH *phHash
);


</code></pre>
<p>对照表如下</p>
<table>
<thead>
<tr>
<th>0x00006603</th>
<th style="text-align:left">CALG_3DES</th>
</tr>
</thead>
<tbody>
<tr>
<td>0x00006609</td>
<td style="text-align:left">CALG_3DES_112</td>
</tr>
<tr>
<td>0x00006611</td>
<td style="text-align:left">CALG_AES</td>
</tr>
<tr>
<td>0x0000660e</td>
<td style="text-align:left">CALG_AES_128</td>
</tr>
<tr>
<td>0x0000660f</td>
<td style="text-align:left">CALG_AES_192</td>
</tr>
<tr>
<td>0x00006610</td>
<td style="text-align:left">CALG_AES_256</td>
</tr>
<tr>
<td>0x0000aa03</td>
<td style="text-align:left">CALG_AGREEDKEY_ANY</td>
</tr>
<tr>
<td>0x0000660c</td>
<td style="text-align:left">CALG_CYLINK_MEK</td>
</tr>
<tr>
<td>0x00006601</td>
<td style="text-align:left">CALG_DES</td>
</tr>
<tr>
<td>0x00006604</td>
<td style="text-align:left">CALG_DESX</td>
</tr>
<tr>
<td>0x0000aa02</td>
<td style="text-align:left">CALG_DH_EPHEM</td>
</tr>
<tr>
<td>0x0000aa01</td>
<td style="text-align:left">CALG_DH_SF</td>
</tr>
<tr>
<td>0x00002200</td>
<td style="text-align:left">CALG_DSS_SIGN</td>
</tr>
<tr>
<td>0x0000aa05</td>
<td style="text-align:left">CALG_ECDH</td>
</tr>
<tr>
<td>0x0000ae06</td>
<td style="text-align:left">CALG_ECDH_EPHEM</td>
</tr>
<tr>
<td>0x00002203</td>
<td style="text-align:left">CALG_ECDSA</td>
</tr>
<tr>
<td>0x0000a001</td>
<td style="text-align:left">CALG_ECMQV</td>
</tr>
<tr>
<td>0x0000800b</td>
<td style="text-align:left">CALG_HASH_REPLACE_OWF</td>
</tr>
<tr>
<td>0x0000a003</td>
<td style="text-align:left">CALG_HUGHES_MD5</td>
</tr>
<tr>
<td>0x00008009</td>
<td style="text-align:left">CALG_HMAC</td>
</tr>
<tr>
<td>0x0000aa04</td>
<td style="text-align:left">CALG_KEA_KEYX</td>
</tr>
<tr>
<td>0x00008005</td>
<td style="text-align:left">CALG_MAC</td>
</tr>
<tr>
<td>0x00008001</td>
<td style="text-align:left">CALG_MD2</td>
</tr>
<tr>
<td>0x00008002</td>
<td style="text-align:left">CALG_MD4</td>
</tr>
<tr>
<td>0x00008003</td>
<td style="text-align:left">CALG_MD5</td>
</tr>
<tr>
<td>0x00002000</td>
<td style="text-align:left">CALG_NO_SIGN</td>
</tr>
<tr>
<td>0xffffffff</td>
<td style="text-align:left">CALG_OID_INFO_CNG_ONLY</td>
</tr>
<tr>
<td>0xfffffffe</td>
<td style="text-align:left">CALG_OID_INFO_PARAMETERS</td>
</tr>
<tr>
<td>0x00004c04</td>
<td style="text-align:left">CALG_PCT1_MASTER</td>
</tr>
<tr>
<td>0x00006602</td>
<td style="text-align:left">CALG_RC2</td>
</tr>
<tr>
<td>0x00006801</td>
<td style="text-align:left">CALG_RC4</td>
</tr>
<tr>
<td>0x0000660d</td>
<td style="text-align:left">CALG_RC5</td>
</tr>
<tr>
<td>0x0000a400</td>
<td style="text-align:left">CALG_RSA_KEYX</td>
</tr>
<tr>
<td>0x00002400</td>
<td style="text-align:left">CALG_RSA_SIGN</td>
</tr>
<tr>
<td>0x00004c07</td>
<td style="text-align:left">CALG_SCHANNEL_ENC_KEY</td>
</tr>
<tr>
<td>0x00004c03</td>
<td style="text-align:left">CALG_SCHANNEL_MAC_KEY</td>
</tr>
<tr>
<td>0x00004c02</td>
<td style="text-align:left">CALG_SCHANNEL_MASTER_HASH</td>
</tr>
<tr>
<td>0x00006802</td>
<td style="text-align:left">CALG_SEAL</td>
</tr>
<tr>
<td>0x00008004</td>
<td style="text-align:left">CALG_SHA</td>
</tr>
<tr>
<td>0x00008004</td>
<td style="text-align:left">CALG_SHA1</td>
</tr>
<tr>
<td>0x0000800c</td>
<td style="text-align:left">CALG_SHA_256</td>
</tr>
<tr>
<td>0x0000800d</td>
<td style="text-align:left">CALG_SHA_384</td>
</tr>
<tr>
<td>0x0000800e</td>
<td style="text-align:left">CALG_SHA_512</td>
</tr>
<tr>
<td>0x0000660a</td>
<td style="text-align:left">CALG_SKIPJACK</td>
</tr>
<tr>
<td>0x00004c05</td>
<td style="text-align:left">CALG_SSL2_MASTER</td>
</tr>
<tr>
<td>0x00004c01</td>
<td style="text-align:left">CALG_SSL3_MASTER</td>
</tr>
<tr>
<td>0x00008008</td>
<td style="text-align:left">CALG_SSL3_SHAMD5</td>
</tr>
<tr>
<td>0x0000660b</td>
<td style="text-align:left">CALG_TEK</td>
</tr>
<tr>
<td>0x00004c06</td>
<td style="text-align:left">CALG_TLS1_MASTER</td>
</tr>
<tr>
<td>0x0000800a</td>
<td style="text-align:left">CALG_TLS1PRF</td>
</tr>
</tbody>
</table>
<p>所以密码1可爆破，但是直接找个在线的网站也解出来了，爆破截包如下：</p>
<pre><code class="python">import hashlib

for i in range(100000,999999):
    if hashlib.sha1((str(i) + &#39;@DBApp&#39;).encode(&#39;utf-8&#39;)).hexdigest().upper() == &#39;6E32D0943418C2C33385BC35A1470250DD8923A9&#39;:
        print(str(i))

// 123321   密码1为 123321
</code></pre>
<p>继续往下分析，密码2为6位，未指定范围，sub_401019函数也是个hash加密，指向的是MD5加密，可以爆破可见字符.</p>
<p><img src="/images/BUUCTF-RE.assets/image-20200429092130004.png" srcset="/img/loading.gif" alt="image-20200429092130004"></p>
<p>硬盘够大，时间够多的情况下还是可以的。</p>
<p><img src="/images/BUUCTF-RE.assets/image-20200429093343379.png" srcset="/img/loading.gif" alt="image-20200429093343379"></p>
<p>无奈，只能继续往下分析</p>
<p><img src="/images/BUUCTF-RE.assets/image-20200429093453782.png" srcset="/img/loading.gif" alt="image-20200429093453782"></p>
<p>这里sub_40100F函数使用了密码2，而且会根据密码2来判断是否退出程序，所以，应该是解出密码2的关键点。</p>
<p><img src="/images/BUUCTF-RE.assets/image-20200429093701931.png" srcset="/img/loading.gif" alt="image-20200429093701931"></p>
<p>分析一波函数</p>
<pre><code class="go">HRSRC FindResourceA(
  HMODULE hModule, 
  LPCSTR  lpName,
  LPCSTR  lpType
); // 在程序的资源列表里打开类型为lpType，名称为lpName的资源。
</code></pre>
<p>分析程序得到</p>
<p><img src="/images/BUUCTF-RE.assets/image-20200429094408594.png" srcset="/img/loading.gif" alt="image-20200429094408594"></p>
<p>关键点在sub_401005函数，分析它：</p>
<p><img src="/images/BUUCTF-RE.assets/image-20200429094527735.png" srcset="/img/loading.gif" alt="image-20200429094527735"></p>
<p>表示将资源的数据逐字节的与(密码二+密码一+@DBApp)循环xor。</p>
<p>查看资源，0x65 = 101</p>
<p><img src="/images/BUUCTF-RE.assets/image-20200429094834994.png" srcset="/img/loading.gif" alt="image-20200429094834994"></p>
<p>资源有了，密码2为6位由用户输入，该输入啥呢。</p>
<p>可以看到因为创建的文件为rtf格式，所以文件头是固定的，所以，可以查看rtf的文件头格式，只需要前6位，搜索得到文件头前六位为<code>7B5C72746631</code>与资源的前6个字节xor得到密码二<code>~!3a@0</code></p>
<p>密码1: 123321</p>
<p>密码2: ~!3a@0</p>
<p>解密得到文件，打开即是flag{N0_M0re_Free_Bugs}</p>
<h2 id="简单注册器"><a href="#简单注册器" class="headerlink" title="简单注册器"></a>简单注册器</h2><p><img src="/images/BUUCTF-RE.assets/image-20200429103020976.png" srcset="/img/loading.gif" alt="image-20200429103020976"></p>
<pre><code class="python">输入长度为32
第31个为a
第一个为b
第0+第2 - 48 = 56
</code></pre>
<p>继续往下分析，发现用户输入的只是用来更改flag标志，并没有参与flag加密，所以直接copy代码</p>
<pre><code class="java">public class A {
    public static void main(String[] args) {
        char[] x = &quot;dd2940c04462b4dd7c450528835cca15&quot;.toCharArray();
        x[2] = (char) ((x[2] + x[3]) - 50);
        x[4] = (char) ((x[2] + x[5]) - 48);
        x[30] = (char) ((x[31] + x[9]) - 48);
        x[14] = (char) ((x[27] + x[28]) - 97);
        for (int i = 0; i &lt; 16; i++) {
            char a = x[31 - i];
            x[31 - i] = x[i];
            x[i] = a;
        }
        System.out.println(&quot;flag{&quot; + String.valueOf(x) + &quot;}&quot;);
    }
}

// flag{59acc538825054c7de4b26440c0999dd}
</code></pre>
<h2 id="GXYCTF2019-luck-guy"><a href="#GXYCTF2019-luck-guy" class="headerlink" title="[GXYCTF2019]luck_guy"></a>[GXYCTF2019]luck_guy</h2><pre><code class="bash">└&gt; file luck_guy
luck_guy: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/l, for GNU/Linux 2.6.32, BuildID[sha1]=38f6b7066f73e3b41dca3ab5b6da405f8edf2ec5, not stripped
</code></pre>
<p>64位，Linux可执行文件</p>
<p><img src="/images/BUUCTF-RE.assets/image-20200429104857439.png" srcset="/img/loading.gif" alt="image-20200429104857439"></p>
<ol>
<li><p>输入数字调用patch_me</p>
<p><img src="/images/BUUCTF-RE.assets/image-20200429105043506.png" srcset="/img/loading.gif" alt="image-20200429105043506"></p>
</li>
<li><p>分析patch_me，输入为偶数调用get_flag</p>
<p><img src="/images/BUUCTF-RE.assets/image-20200429105113603.png" srcset="/img/loading.gif" alt="image-20200429105113603"></p>
</li>
<li><p>输入偶数试试，发现他在骗我…</p>
<p><img src="/images/BUUCTF-RE.assets/image-20200429105203757.png" srcset="/img/loading.gif" alt="image-20200429105203757"></p>
</li>
<li><p>分析get_flag</p>
<p><img src="/images/BUUCTF-RE.assets/image-20200429105334001.png" srcset="/img/loading.gif" alt="image-20200429105334001"></p>
<p>循环四次，由随机数分发，有一定几率拿到flag。</p>
<p>在分支1中是可以得到flag的：flag由f1和f2组成。</p>
<p>在分支2和分支3中都是错误的。</p>
<p>在分支4中给f2赋值。</p>
<p>在分支5中操作f2。</p>
<p>默认输出错误。</p>
</li>
<li><p>由此，可以推断，执行流，4，5，1.</p>
<pre><code class="python">In [1]: flag = &#39;7F666F6067756369&#39;

In [2]: s = &#39;&#39;
   ...: for i in range(0,len(flag),2):
   ...:     s += chr(int(flag[i:i+2],16))
   ...:

In [3]: s = list(s)

In [4]: s.reverse()

In [5]: s
Out[5]: [&#39;i&#39;, &#39;c&#39;, &#39;u&#39;, &#39;g&#39;, &#39;`&#39;, &#39;o&#39;, &#39;f&#39;, &#39;\x7f&#39;]

In [6]: flag = &#39;&#39;
   ...: pre = &#39;GXY{do_not_&#39;
   ...: for i in range(0,8):
   ...:     if i % 2 == 1:
   ...:         flag += chr(ord(s[i]) - 2)
   ...:     else:
   ...:         flag += chr(ord(s[i]) - 1)
   ...: print(pre+flag)
GXY{do_not_hate_me}
</code></pre>
</li>
</ol>
<h2 id="Youngter-drive"><a href="#Youngter-drive" class="headerlink" title="Youngter-drive"></a>Youngter-drive</h2><p>查壳，upx壳</p>
<p><img src="/images/BUUCTF-RE.assets/image-20200429111813488.png" srcset="/img/loading.gif" alt="image-20200429111813488"></p>
<p>脱壳</p>
<p><img src="/images/BUUCTF-RE.assets/image-20200429111944821.png" srcset="/img/loading.gif" alt="image-20200429111944821"></p>
<p>分析，反调试还挺多的</p>
<p><img src="/images/BUUCTF-RE.assets/image-20200429112224296.png" srcset="/img/loading.gif" alt="image-20200429112224296"></p>
<p>分析程序Source是全局变量，由用户输入</p>
<p><img src="/images/BUUCTF-RE.assets/image-20200429113115925.png" srcset="/img/loading.gif" alt="image-20200429113115925"></p>
<p>用户输入的数据copy到Dest，创建了两个线程StartAddress和sub_41119F</p>
<p><img src="/images/BUUCTF-RE.assets/image-20200429113203312.png" srcset="/img/loading.gif" alt="image-20200429113203312"></p>
<p>查看线程StartAddress</p>
<p>主要作用是对Source加密</p>
<p><img src="/images/BUUCTF-RE.assets/image-20200429125136740.png" srcset="/img/loading.gif" alt="image-20200429125136740"></p>
<p>查看线程sub_41119F</p>
<p><img src="/images/BUUCTF-RE.assets/image-20200429125239913.png" srcset="/img/loading.gif" alt="image-20200429125239913"></p>
<p>对数字dword_418008进行减一操作</p>
<p>回过头看加密函数</p>
<p>反编译，发现堆栈不平衡错误，修复之后</p>
<p><img src="/images/BUUCTF-RE.assets/image-20200429114403280.png" srcset="/img/loading.gif" alt="image-20200429114403280"></p>
<p>分析</p>
<p><img src="/images/BUUCTF-RE.assets/image-20200429120908393.png" srcset="/img/loading.gif" alt="111"></p>
<p>所以线程一的作用为：对用户输入的字符逐字节加密，数组下标减一，睡眠0.1s</p>
<p>线程二的作用为：数组下标减一，睡眠0.1s</p>
<p>所以，综合作用就是对用户输入的字符逐字节加密，数组下标减二</p>
<p><img src="/images/BUUCTF-RE.assets/image-20200429113224171.png" srcset="/img/loading.gif" alt="111"></p>
<p>得到加密后的字符串与off_418004出的字符串对比</p>
<p>脚本</p>
<pre><code class="python">dic = &#39;QWERTYUIOPASDFGHJKLZXCVBNMqwertyuiopasdfghjklzxcvbnm&#39;
res = &#39;TOiZiZtOrYaToUwPnToBsOaOapsyS&#39;

flag = &#39;&#39;
for j in range(len(res)-1,-1,-1):
    if j % 2 == 0:
        flag += res[j]
        continue
    for i in range(64,123):
        if i &lt; ord(&#39;Z&#39;):
            if dic[i-38] == res[j]:
                flag += chr(i)
                break
        elif i &gt;= ord(&#39;a&#39;):
            if dic[i-96] == res[j]:
                flag += chr(i)
                break
flag = list(flag)
flag.reverse()
print(&#39;&#39;.join(i for i in flag))

// ThisisthreadofwindowshahaIsES
</code></pre>
<p>注意：Flag为flag{ThisisthreadofwindowshahaIsESE}，出题问题</p>
<p>题目加密部分出的很奇怪，如果我输入Z的时候，ord(‘Z’) - 38 = 52， dic[52] 会超出数组下标，程序不会会崩溃，因为他是C语言啊，作者的本意应该是输入大写字母就-97，小写字母-39，才能实现大写转成小写，小写转成大写。</p>
<p>总体来说：</p>
<p>程序输入30个字符串，从后往前每隔一位加一次密，最后与29位的字符串比较，太坑了。</p>
<h2 id="相册"><a href="#相册" class="headerlink" title="相册"></a>相册</h2><p>提取APK中完整的邮箱</p>
<p><img src="/images/BUUCTF-RE.assets/image-20200429140953932.png" srcset="/img/loading.gif" alt="image-20200429140953932"></p>
<p>在主活动中看到程序会将调试的信息显示在终端，安装程序后启动，可以使用adb获取输出的信息，包含email地址。</p>
<p><img src="/images/BUUCTF-RE.assets/image-20200429141143180.png" srcset="/img/loading.gif" alt="image-20200429141143180"></p>
<p><img src="/images/BUUCTF-RE.assets/image-20200429141411297.png" srcset="/img/loading.gif" alt="image-20200429141411297"></p>
<p><img src="/images/BUUCTF-RE.assets/image-20200429141539042.png" srcset="/img/loading.gif" alt="image-20200429141539042"></p>
<p>以上应该是非预期解</p>
<p>分析下程序，查找和mail相关的代码，发现了下面一段代码</p>
<p><img src="/images/BUUCTF-RE.assets/image-20200429142322065.png" srcset="/img/loading.gif" alt="image-20200429142322065"></p>
<p>分析连接的函数</p>
<p><img src="/images/BUUCTF-RE.assets/image-20200429142421602.png" srcset="/img/loading.gif" alt="image-20200429142421602"></p>
<p>发现配置都定义在了C0005C2中，且有些数据时在native层。</p>
<p><img src="/images/BUUCTF-RE.assets/image-20200429142516081.png" srcset="/img/loading.gif" alt="image-20200429142516081"></p>
<p><img src="/images/BUUCTF-RE.assets/image-20200429142750461.png" srcset="/img/loading.gif" alt="image-20200429142750461"></p>
<p>直接查看so库的硬编码字符串碰碰运气，可以得到邮件的base64编码</p>
<p><img src="/images/BUUCTF-RE.assets/image-20200429142935213.png" srcset="/img/loading.gif" alt="image-20200429142935213"></p>
<h2 id="GWCTF-2019-pyre"><a href="#GWCTF-2019-pyre" class="headerlink" title="[GWCTF 2019]pyre"></a>[GWCTF 2019]pyre</h2><p>反编译得到如下代码</p>
<pre><code class="python">print &#39;Welcome to Re World!&#39;
print &#39;Your input1 is your flag~&#39;
l = len(input1)
for i in range(l):
    num = ((input1[i] + i) % 128 + 128) % 128
    code += num

for i in range(l - 1):
    code[i] = code[i] ^ code[i + 1]

print code
code = [
    &#39;\x1f&#39;,
    &#39;\x12&#39;,
    &#39;\x1d&#39;,
    &#39;(&#39;,
    &#39;0&#39;,
    &#39;4&#39;,
    &#39;\x01&#39;,
    &#39;\x06&#39;,
    &#39;\x14&#39;,
    &#39;4&#39;,
    &#39;,&#39;,
    &#39;\x1b&#39;,
    &#39;U&#39;,
    &#39;?&#39;,
    &#39;o&#39;,
    &#39;6&#39;,
    &#39;*&#39;,
    &#39;:&#39;,
    &#39;\x01&#39;,
    &#39;D&#39;,
    &#39;;&#39;,
    &#39;%&#39;,
    &#39;\x13&#39;]
</code></pre>
<p>solve</p>
<pre><code class="python">code = [&#39;\x1f&#39;,&#39;\x12&#39;,&#39;\x1d&#39;,&#39;(&#39;,&#39;0&#39;,&#39;4&#39;,&#39;\x01&#39;,&#39;\x06&#39;,&#39;\x14&#39;,&#39;4&#39;,&#39;,&#39;,&#39;\x1b&#39;,&#39;U&#39;,&#39;?&#39;,&#39;o&#39;,&#39;6&#39;,&#39;*&#39;,&#39;:&#39;,&#39;\x01&#39;,&#39;D&#39;,&#39;;&#39;,&#39;%&#39;,&#39;\x13&#39;]
for i in range(len(code)-2,-1,-1):
    code[i] = chr(ord(code[i]) ^ ord(code[i+1]))

flag = &#39;&#39;
for i in range(0,len(code)):
    for j in range(0,255):
        if ((j + i) % 128 + 128) % 128 == ord(code[i]):
            flag += (chr(j))
            break
print(flag)

// GWHT{Just_Re_1s_Ha66y!}
</code></pre>
<h2 id="2019红帽杯-easyRE-藏函数"><a href="#2019红帽杯-easyRE-藏函数" class="headerlink" title="[2019红帽杯]easyRE-藏函数"></a>[2019红帽杯]easyRE-藏函数</h2><pre><code class="c">signed __int64 __fastcall sub_4009C6(double a1, double a2, double a3, double a4, double a5, double a6, double a7, double a8)
{
  double v8; // xmm4_8
  double v9; // xmm5_8
  signed __int64 result; // rax
  __int64 v11; // ST10_8
  __int64 v12; // ST18_8
  __int64 v13; // ST20_8
  __int64 v14; // ST28_8
  __int64 v15; // ST30_8
  __int64 v16; // ST38_8
  __int64 v17; // ST40_8
  __int64 v18; // ST48_8
  __int64 v19; // ST50_8
  __int64 v20; // ST58_8
  int i; // [rsp+Ch] [rbp-114h]
  char v22; // [rsp+60h] [rbp-C0h]
  char v23; // [rsp+61h] [rbp-BFh]
  char v24; // [rsp+62h] [rbp-BEh]
  char v25; // [rsp+63h] [rbp-BDh]
  char v26; // [rsp+64h] [rbp-BCh]
  char v27; // [rsp+65h] [rbp-BBh]
  char v28; // [rsp+66h] [rbp-BAh]
  char v29; // [rsp+67h] [rbp-B9h]
  char v30; // [rsp+68h] [rbp-B8h]
  char v31; // [rsp+69h] [rbp-B7h]
  char v32; // [rsp+6Ah] [rbp-B6h]
  char v33; // [rsp+6Bh] [rbp-B5h]
  char v34; // [rsp+6Ch] [rbp-B4h]
  char v35; // [rsp+6Dh] [rbp-B3h]
  char v36; // [rsp+6Eh] [rbp-B2h]
  char v37; // [rsp+6Fh] [rbp-B1h]
  char v38; // [rsp+70h] [rbp-B0h]
  char v39; // [rsp+71h] [rbp-AFh]
  char v40; // [rsp+72h] [rbp-AEh]
  char v41; // [rsp+73h] [rbp-ADh]
  char v42; // [rsp+74h] [rbp-ACh]
  char v43; // [rsp+75h] [rbp-ABh]
  char v44; // [rsp+76h] [rbp-AAh]
  char v45; // [rsp+77h] [rbp-A9h]
  char v46; // [rsp+78h] [rbp-A8h]
  char v47; // [rsp+79h] [rbp-A7h]
  char v48; // [rsp+7Ah] [rbp-A6h]
  char v49; // [rsp+7Bh] [rbp-A5h]
  char v50; // [rsp+7Ch] [rbp-A4h]
  char v51; // [rsp+7Dh] [rbp-A3h]
  char v52; // [rsp+7Eh] [rbp-A2h]
  char v53; // [rsp+7Fh] [rbp-A1h]
  char v54; // [rsp+80h] [rbp-A0h]
  char v55; // [rsp+81h] [rbp-9Fh]
  char v56; // [rsp+82h] [rbp-9Eh]
  char v57; // [rsp+83h] [rbp-9Dh]
  char v58[32]; // [rsp+90h] [rbp-90h]
  int v59; // [rsp+B0h] [rbp-70h]
  char v60; // [rsp+B4h] [rbp-6Ch]
  char v61; // [rsp+C0h] [rbp-60h]
  char v62; // [rsp+E7h] [rbp-39h]
  char v63; // [rsp+100h] [rbp-20h]
  unsigned __int64 v64; // [rsp+108h] [rbp-18h]

  v64 = __readfsqword(0x28u);
  v22 = 73;
  v23 = 111;
  v24 = 100;
  v25 = 108;
  v26 = 62;
  v27 = 81;
  v28 = 110;
  v29 = 98;
  v30 = 40;
  v31 = 111;
  v32 = 99;
  v33 = 121;
  v34 = 127;
  v35 = 121;
  v36 = 46;
  v37 = 105;
  v38 = 127;
  v39 = 100;
  v40 = 96;
  v41 = 51;
  v42 = 119;
  v43 = 125;
  v44 = 119;
  v45 = 101;
  v46 = 107;
  v47 = 57;
  v48 = 123;
  v49 = 105;
  v50 = 121;
  v51 = 61;
  v52 = 126;
  v53 = 121;
  v54 = 76;
  v55 = 64;
  v56 = 69;
  v57 = 67;
  memset(v58, 0, sizeof(v58));
  v59 = 0;
  v60 = 0;
  sub_4406E0(0LL, v58);
  v60 = 0;
  if ( sub_424BA0(v58) == 36 )
  {
    for ( i = 0; i &lt; sub_424BA0(v58); ++i ) // xor运算
    {
      if ( (v58[i] ^ i) != *(&amp;v22 + i) )
      {
        result = 4294967294LL;
        goto LABEL_13;
      }
    }
    sub_410CC0(&quot;continue!&quot;);
    memset(&amp;v61, 0, 0x40uLL);
    v63 = 0;
    sub_4406E0(0LL, &amp;v61);
    v62 = 0;
    if ( sub_424BA0(&amp;v61) == 39 )
    {
      v11 = sub_400E44(&amp;v61);
      v12 = sub_400E44(v11);
      v13 = sub_400E44(v12);
      v14 = sub_400E44(v13);
      v15 = sub_400E44(v14);
      v16 = sub_400E44(v15);
      v17 = sub_400E44(v16);
      v18 = sub_400E44(v17);
      v19 = sub_400E44(v18);
      v20 = sub_400E44(v19);
      if ( !sub_400360(v20, off_6CC090) ) // base64运算
      {
        sub_410CC0(&quot;You found me!!!&quot;);
        sub_410CC0(&quot;bye bye~&quot;);
      }
      result = 0LL;
    }
    else
    {
      result = 4294967293LL;
    }
  }
  else
  {
    result = 0xFFFFFFFFLL;
  }
LABEL_13:
  if ( __readfsqword(0x28u) != v64 )
    sub_444020(a1, a2, a3, a4, v8, v9, a7, a8);
  return result;
}
</code></pre>
<ol>
<li><p>第一处加密得到的结果</p>
<pre><code class="bash">Info:The first four chars are `flag`
</code></pre>
</li>
<li><p>第二处加密得到的结果</p>
<pre><code class="bash">https://bbs.pediy.com/thread-254172.htm
</code></pre>
</li>
<li><p>都没啥太大的意义</p>
<p>一番查看，发现了在初始化段存在另外一处程序不运行的函数。</p>
<p><img src="/images/BUUCTF-RE.assets/image-20200430101131336.png" srcset="/img/loading.gif" alt="image-20200430101131336"></p>
<pre><code class="c">__int64 __fastcall sub_400D35(double a1, double a2, double a3, double a4, double a5, double a6, double a7, double a8)
{
  double v8; // xmm4_8
  double v9; // xmm5_8
  __int64 result; // rax
  unsigned __int64 v11; // rt1
  unsigned int v12; // [rsp+Ch] [rbp-24h]
  signed int i; // [rsp+10h] [rbp-20h]
  signed int j; // [rsp+14h] [rbp-1Ch]
  unsigned int v15; // [rsp+24h] [rbp-Ch]
  unsigned __int64 v16; // [rsp+28h] [rbp-8h]

  v16 = __readfsqword(0x28u);
  v12 = sub_43FD20() - qword_6CEE38;
  for ( i = 0; i &lt;= 1233; ++i )
  {
    sub_40F790(v12);
    sub_40FE60();
    sub_40FE60();
    v12 = sub_40FE60() ^ 0x98765432;
  }
  v15 = v12;
  if ( (v12 ^ byte_6CC0A0[0]) == 102 &amp;&amp; (HIBYTE(v15) ^ byte_6CC0A3) == 103 )
  {
    for ( j = 0; j &lt;= 24; ++j )
      sub_410E90((byte_6CC0A0[j] ^ *(&amp;v15 + j % 4)));
  }
  v11 = __readfsqword(0x28u);
  result = v11 ^ v16;
  if ( v11 != v16 )
    sub_444020(a1, a2, a3, a4, v8, v9, a7, a8);
  return result;
}
</code></pre>
<p>byte_6CC0A0与byte_6CC0A3数据如下</p>
<pre><code class="bash">.data:00000000006CC0A0     byte_6CC0A0     db 40h                  ; DATA XREF: sub_400D35+95↑r
.data:00000000006CC0A0                                             ; sub_400D35+C1↑r
.data:00000000006CC0A1                     db  35h ; 5
.data:00000000006CC0A2                     db  20h
.data:00000000006CC0A3     byte_6CC0A3     db 56h                  ; DATA XREF: sub_400D35+A6↑r
.data:00000000006CC0A4                     db  5Dh ; ]
.data:00000000006CC0A5                     db  18h
.data:00000000006CC0A6                     db  22h ; &quot;
.data:00000000006CC0A7                     db  45h ; E
.data:00000000006CC0A8                     db  17h
.data:00000000006CC0A9                     db  2Fh ; /
.data:00000000006CC0AA                     db  24h ; $
.data:00000000006CC0AB                     db  6Eh ; n
.data:00000000006CC0AC                     db  62h ; b
.data:00000000006CC0AD                     db  3Ch ; &lt;
.data:00000000006CC0AE                     db  27h ; &#39;
.data:00000000006CC0AF                     db  54h ; T
.data:00000000006CC0B0                     db  48h ; H
.data:00000000006CC0B1                     db  6Ch ; l
.data:00000000006CC0B2                     db  24h ; $
.data:00000000006CC0B3                     db  6Eh ; n
.data:00000000006CC0B4                     db  72h ; r
.data:00000000006CC0B5                     db  3Ch ; &lt;
.data:00000000006CC0B6                     db  32h ; 2
.data:00000000006CC0B7                     db  45h ; E
.data:00000000006CC0B8                     db  5Bh ; [
.data:00000000006CC0B9                     db    0
.data:00000000006CC0BA                     db    0
.data:00000000006CC0BB                     db    0
.data:00000000006CC0BC                     db    0
.data:00000000006CC0BD                     db    0
.data:00000000006CC0BE                     db    0
.data:00000000006CC0BF                     db    0
</code></pre>
<p>主要代码如下</p>
<pre><code class="bash">v15 = v12;
if ( (v12 ^ byte_6CC0A0[0]) == &#39;f&#39; &amp;&amp; (HIBYTE(v15) ^ byte_6CC0A3) == &#39;g&#39; ){
    for ( j = 0; j &lt;= 24; ++j )
        sub_410E90((byte_6CC0A0[j] ^ *(&amp;v15 + j % 4)));
}

假设 v12 = 0xAABBCCDD
则v12 ^ byte_6CC0A0[0] == 0xDD ^ byte_6CC0A0[0]
  HIBYTE(v15) ^ byte_6CC0A3 == 0xAA ^ byte_6CC0A3 // HIBYTE 提取16bit数的高8bit
</code></pre>
<p>前面提示了flag的前四位为flag</p>
<p>所以</p>
<p>Byte_6CC0A0 ^ v15 == flag…..</p>
<pre><code class="bash">In [5]: a = [0x40, 0x35, 0x20, 0x56, 0x5D, 0x18, 0x22, 0x45, 0x17, 0x2F, 0x24, 0x6E, 0x
   ...: 62, 0x3C, 0x27, 0x54, 0x48, 0x6C, 0x24, 0x6E, 0x72, 0x3C, 0x32, 0x45, 0x5B]

In [6]: v15 = [a[0] ^ ord(&#39;f&#39;),a[1] ^ ord(&#39;l&#39;),a[2] ^ ord(&#39;a&#39;),a[3] ^ ord(&#39;g&#39;)]

In [7]: flag = &#39;&#39;
   ...: for i in range(len(a)):
   ...:     flag += chr(a[i] ^ v15[i%4])
   ...:

In [8]: flag
Out[8]: &#39;flag{Act1ve_Defen5e_Test}&#39;
</code></pre>
</li>
</ol>
<h2 id="SUCTF2019-SignIn"><a href="#SUCTF2019-SignIn" class="headerlink" title="[SUCTF2019]SignIn"></a>[SUCTF2019]SignIn</h2><p><img src="/images/BUUCTF-RE.assets/image-20200430103624213.png" srcset="/img/loading.gif" alt="image-20200430103624213"></p>
<p>在线提取pq</p>
<p><img src="/images/BUUCTF-RE.assets/image-20200430103400951.png" srcset="/img/loading.gif" alt="image-20200430103400951"></p>
<p>代码如下</p>
<pre><code class="python">import base64

p= 282164587459512124844245113950593348271
q= 366669102002966856876605669837014229419
e= 65537
c= 0xad939ff59f6e70bcbfad406f2494993757eee98b91bc244184a377520d06fc35
n= 103461035900816914121390101299049044413950405173712170434161686539878160984549
def egcd(a, b):
    if a == 0:
        return (b, 0, 1)
    else:
        g, y, x = egcd(b % a, a)
        return (g, x - (b // a) * y, y)
def modinv(a, m):
    g, x, y = egcd(a, m)
    if g != 1:
        raise Exception(&#39;modular inverse does not exist&#39;)
    else:
        return x % m
d=modinv(e,(p-1)*(q-1))
print &#39;d=&#39;,d
m=pow(c,d,n)
print hex(m)[2:len(hex(m))-1].decode(&#39;hex&#39;)

# suctf{Pwn_@_hundred_years}
</code></pre>
<p>涉及的GNU高精度算法库</p>
<p><a href="https://gmplib.org/manual/" target="_blank" rel="noopener">https://gmplib.org/manual/</a></p>
<h2 id="V-amp-N2020-公开赛-strangeCpp-藏数据"><a href="#V-amp-N2020-公开赛-strangeCpp-藏数据" class="headerlink" title="[V&amp;N2020 公开赛]strangeCpp-藏数据"></a>[V&amp;N2020 公开赛]strangeCpp-藏数据</h2><p>主体作用就是输出系统信息，看了半天不知道数据在哪里加密的，查看wp后，知道了</p>
<pre><code class="c">__int64 __fastcall sub_140013AA0(__int64 a1, __int64 a2, __int64 *a3)
{
  char *v3; // rdi
  signed __int64 i; // rcx
  __int64 v5; // rax
  __int64 v6; // rax
  __int64 v7; // rax
  __int64 v8; // rax
  char v10; // [rsp+0h] [rbp-20h]
  struct _SYSTEM_INFO SystemInfo; // [rsp+28h] [rbp+8h]
  __int64 *j; // [rsp+78h] [rbp+58h]
  __int64 v13; // [rsp+98h] [rbp+78h]
  __int64 *v14; // [rsp+1A0h] [rbp+180h]

  v14 = a3;
  v3 = &amp;v10;
  for ( i = 94i64; i; --i )
  {
    *v3 = -858993460;
    v3 += 4;
  }
  sub_1400110AA(&amp;unk_140027033);
  GetSystemInfo(&amp;SystemInfo);
  putchar(unk_140021004[0]);
  putchar(unk_140021004[1]);
  putchar(unk_140021004[2]);
  putchar(unk_140021004[3]);
  putchar(unk_140021015[4]);
  putchar(unk_140021015[5]);
  putchar(unk_140021004[1]);
  putchar(10);
  puts(&quot;Let me have a look at your computer...&quot;);
  for ( j = v14; *j; ++j )
  {
    v13 = *j;
    sub_140011226(&quot;%s\n&quot;, v13);
  }
  std::basic_ostream&lt;char,std::char_traits&lt;char&gt;&gt;::operator&lt;&lt;(std::cout, sub_140011127);
  dword_140021190 = SystemInfo.dwNumberOfProcessors;
  sub_140011226(&quot;now system cpu num is %d\n&quot;, SystemInfo.dwNumberOfProcessors);
  if ( dword_140021190 &gt;= 8 )
  {
    puts(&quot;Are you in VM?&quot;);
    _exit(0);
  }
  if ( GetUserNameA(Str1, &amp;unk_140021000) )
  {
    v5 = sub_140011172(std::cout, &quot;this is useful&quot;);
    std::basic_ostream&lt;char,std::char_traits&lt;char&gt;&gt;::operator&lt;&lt;(v5, sub_140011127);
  }
  v6 = std::basic_ostream&lt;char,std::char_traits&lt;char&gt;&gt;::operator&lt;&lt;(std::cout, sub_140011127);
  v7 = sub_140011172(v6, &quot;ok,I am checking...&quot;);
  std::basic_ostream&lt;char,std::char_traits&lt;char&gt;&gt;::operator&lt;&lt;(v7, sub_140011127);
  if ( !j_strcmp(Str1, &quot;cxx&quot;) )
  {
    v8 = sub_140011172(std::cout, &quot;flag{where_is_my_true_flag?}&quot;);
    std::basic_ostream&lt;char,std::char_traits&lt;char&gt;&gt;::operator&lt;&lt;(v8, sub_140011127);
    _exit(0);
  }
  system(&quot;pause&quot;);
  sub_1400113E3(&amp;v10, &amp;unk_14001DE50);
  return 0i64;
}
</code></pre>
<p>与flag相关的数据都没用，简直脑洞</p>
<p>welcome数据中夹杂其他数据</p>
<p><img src="/images/BUUCTF-RE.assets/image-20200430125512331.png" srcset="/img/loading.gif" alt="image-20200430125512331"></p>
<p>点击查看数据</p>
<p><img src="/images/BUUCTF-RE.assets/image-20200430125528305.png" srcset="/img/loading.gif" alt="image-20200430125528305"></p>
<p>使用交叉引用定位函数</p>
<p><img src="/images/BUUCTF-RE.assets/image-20200430125551975.png" srcset="/img/loading.gif" alt="image-20200430125551975"></p>
<p>主要是for循环处，byte xor 直接爆破</p>
<pre><code class="python">In [1]: flag = [0x26, 0x2C, 0x21, 0x27, 0x3B, 0x0D, 0x04, 0x75, 0x68, 0x34, 0x28, 0x25,
   ...:  0x0E, 0x35, 0x2D, 0x69, 0x3D]

In [2]: for i in range(0,256):
   ...:     s = &#39;&#39;
   ...:     for j in flag:
   ...:         s += chr(i^j)
   ...:     print s

...
flag{MD5(theNum)}
...
</code></pre>
<p>theNum为知，可能是需要计算dword_140021190</p>
<p><code>sub_140011384(dword_140021190) = 0x242EE21A</code></p>
<pre><code class="c">signed __int64 __fastcall sub_140013890(int a1)
{
  __int64 *v1; // rdi
  signed __int64 i; // rcx
  signed __int64 result; // rax
  __int64 v4; // [rsp+0h] [rbp-20h]
  int v5; // [rsp+24h] [rbp+4h]
  int v6; // [rsp+44h] [rbp+24h]
  unsigned int v7; // [rsp+64h] [rbp+44h]
  int v8; // [rsp+160h] [rbp+140h]

  v8 = a1;
  v1 = &amp;v4;
  for ( i = 82i64; i; --i )
  {
    *v1 = -858993460;
    v1 = (v1 + 4);
  }
  sub_1400110AA(&amp;unk_140027033);
  v5 = v8 &gt;&gt; 12;
  v6 = v8 &lt;&lt; 8;
  v7 = (v8 &lt;&lt; 8) ^ (v8 &gt;&gt; 12);
  v7 *= 291;
  if ( v7 )
    result = v7;
  else
    result = 0x3DBi64;
  return result;
}
</code></pre>
<p>主要代码</p>
<pre><code class="c">v7 = (v8 &lt;&lt; 8) ^ (v8 &gt;&gt; 12);
v7 *= 291;

v7 == 0x242EE21A
</code></pre>
<p>代码如下</p>
<pre><code class="python">In [9]: for i in range(0,9999999999):
   ...:     if (((i &lt;&lt; 8) ^ (i &gt;&gt; 12)) * 291) &amp; 0xffffffff == 0x242EE21A:
   ...:         print i
   ...:         break
   ...:
123456
</code></pre>
<p>MD5加密</p>
<pre><code class="bash">┌[bufsnake☮ bufsnake.com]-(~)
└&gt; echo &#39;123456\c&#39; | md5
e10adc3949ba59abbe56e057f20f883e
</code></pre>
<p>Flag: flag{e10adc3949ba59abbe56e057f20f883e}</p>

            <hr>
          </div>
          <br>
          <div>
            <p>
            
              <span>
                <i class="iconfont icon-inbox"></i>
                
                  <a class="hover-with-bg" href="/categories/reverse">reverse</a>
                  &nbsp;
                
              </span>&nbsp;&nbsp;
            
            
              <span>
                <i class="iconfont icon-tag"></i>
                
                  <a class="hover-with-bg" href="/tags/buuctf">buuctf</a>
                
              </span>
            
            </p>
            
              <p class="note note-warning">本博客所有文章除特别声明外，均采用 <a href="https://zh.wikipedia.org/wiki/Wikipedia:CC_BY-SA_3.0%E5%8D%8F%E8%AE%AE%E6%96%87%E6%9C%AC" rel="nofollow noopener">CC BY-SA 3.0协议</a> 。转载请注明出处！</p>
            
          </div>
        </div>
      </div>
    </div>
    <div class="d-none d-lg-block col-lg-2 toc-container">
      
  <div id="toc">
    <p class="h4"><i class="far fa-list-alt"></i>&nbsp;目录</p>
    <div id="tocbot"></div>
  </div>

    </div>
  </div>
</div>

<!-- custom -->


<!-- Comments -->
<div class="col-lg-7 mx-auto nopadding-md">
  <div class="container comments mx-auto" id="comments">
    
  </div>
</div>

    
  </main>

  
    <a class="z-depth-1" id="scroll-top-button" href="#" role="button">
      <i class="fa fa-chevron-up scroll-top-arrow" aria-hidden="true"></i>
    </a>
  

  
    <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
  

  <footer class="mt-5">
  <div class="text-center py-3">
    <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><b>Hexo</b></a>
    <i class="iconfont icon-love"></i>
    <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"> <b>Fluid</b></a>
    <br>

    


    


    <!-- cnzz Analytics icon -->
    

  </div>
</footer>

<!-- SCRIPTS -->
<script src="/lib/jquery/jquery.min.js"></script>
<script src="/lib/popper/popper.min.js"></script>
<script src="/lib/bootstrap/js/bootstrap.min.js"></script>
<script src="/lib/mdbootstrap/js/mdb.min.js"></script>
<script src="/js/main.js"></script>


  <script src="/js/lazyload.js"></script>



  
    <script src="/lib/tocbot/tocbot.min.js"></script>
  
  <script src="/js/post.js"></script>



  <script src="/lib/smoothscroll/SmoothScroll.min.js"></script>



  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>


<!-- Plugins -->


  
    <!-- Baidu Analytics -->
    <script>
      var _hmt = _hmt || [];
      (function () {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?926b66e71d8f61b2a08a4f0da34fef80";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
      })();
    </script>
  

  
    <!-- Google Analytics -->
    <script>
      (function (i, s, o, g, r, a, m) {
        i['GoogleAnalyticsObject'] = r;
        i[r] = i[r] || function () {
          (i[r].q = i[r].q || []).push(arguments)
        }, i[r].l = 1 * new Date();
        a = s.createElement(o),
          m = s.getElementsByTagName(o)[0];
        a.async = 1;
        a.src = g;
        m.parentNode.insertBefore(a, m)
      })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');

      ga('create', 'UA-145389457-1', 'auto');
      ga('send', 'pageview');
    </script>
  

  

  

  <!-- cnzz Analytics -->
  



  <script src="/lib/prettify/prettify.min.js"></script>
  <script>
    $(document).ready(function () {
      $('pre').addClass('prettyprint  linenums');
      prettyPrint();
    })
  </script>



  <script src="/lib/typed/typed.min.js"></script>
  <script>
    var typed = new Typed('#subtitle', {
      strings: [
        '  ',
        "BUUCTF刷题记录&nbsp;",
      ],
      cursorChar: "_",
      typeSpeed: 50,
      loop: false,
    });
    typed.stop();
    $(document).ready(function () {
      $(".typed-cursor").addClass("h2");
      typed.start();
    });
  </script>



  <script src="/lib/anchor/anchor.min.js"></script>
  <script>
    anchors.options = {
      placement: "left",
      visible: "false",
      
      icon: "❡"
      
    };
    var el = "h1,h2,h3,h4,h5,h6".split(",");
    var res = [];
    for (item of el) {
      res.push(".markdown-body > " + item)
    }
    anchors.add(res.join(", "))
  </script>



  <script src="/js/local-search.js"></script>
  <script>
    var path = "/local-search.xml";
    var inputArea = document.querySelector("#local-search-input");
    inputArea.onclick = function () {
      getSearchFile(path);
      this.onclick = null
    }
  </script>



  <script src="/lib/fancybox/jquery.fancybox.min.js"></script>
  <script>
    $("#post img:not(.no-zoom img, img[no-zoom])").each(
      function () {
        var element = document.createElement("a");
        $(element).attr("data-fancybox", "images");
        $(element).attr("href", $(this).attr("src"));
        $(this).wrap(element);
      }
    );
  </script>





  
  
    <script>
      !function (e, t, a) {
        function r() {
          for (var e = 0; e < s.length; e++) s[e].alpha <= 0 ? (t.body.removeChild(s[e].el), s.splice(e, 1)) : (s[e].y--, s[e].scale += .004, s[e].alpha -= .013, s[e].el.style.cssText = "left:" + s[e].x + "px;top:" + s[e].y + "px;opacity:" + s[e].alpha + ";transform:scale(" + s[e].scale + "," + s[e].scale + ") rotate(45deg);background:" + s[e].color + ";z-index:99999");
          requestAnimationFrame(r)
        }

        function n() {
          var t = "function" == typeof e.onclick && e.onclick;
          e.onclick = function (e) {
            t && t(), o(e)
          }
        }

        function o(e) {
          var a = t.createElement("div");
          a.className = "heart", s.push({
            el: a,
            x: e.clientX - 5,
            y: e.clientY - 5,
            scale: 1,
            alpha: 1,
            color: c()
          }), t.body.appendChild(a)
        }

        function i(e) {
          var a = t.createElement("style");
          a.type = "text/css";
          try {
            a.appendChild(t.createTextNode(e))
          } catch (t) {
            a.styleSheet.cssText = e
          }
          t.getElementsByTagName("head")[0].appendChild(a)
        }

        function c() {
          return "rgb(" + ~~(255 * Math.random()) + "," + ~~(255 * Math.random()) + "," + ~~(255 * Math.random()) + ")"
        }

        var s = [];
        e.requestAnimationFrame = e.requestAnimationFrame || e.webkitRequestAnimationFrame || e.mozRequestAnimationFrame || e.oRequestAnimationFrame || e.msRequestAnimationFrame || function (e) {
          setTimeout(e, 1e3 / 60)
        }, i(".heart{width: 10px;height: 10px;position: fixed;background: #f00;transform: rotate(45deg);-webkit-transform: rotate(45deg);-moz-transform: rotate(45deg);}.heart:after,.heart:before{content: '';width: inherit;height: inherit;background: inherit;border-radius: 50%;-webkit-border-radius: 50%;-moz-border-radius: 50%;position: fixed;}.heart:after{top: -5px;}.heart:before{left: -5px;}"), n(), r()
      }(window, document);
    </script>
  








</body>
</html>
