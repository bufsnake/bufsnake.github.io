<!--
	作者：Sariay
	时间：2018-09-25
	描述：There may be a bug, but don't worry, QiLing(器灵) says that it can work normally!
-->
<!DOCTYPE html>
<html class="html-loading">
		

<head><meta name="generator" content="Hexo 3.8.0">
	<meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no">
  <title>
    
      bufsnake
    
  </title>
  <meta name="author" content="bufsnake">
  <meta name="keywords" content="web安全,逆向,ctf,pwn,crypto,misc,android,安卓,破解,底层">
  <meta name="description" content="香香张">
	<!-- favicon -->
  <link rel="shortcut icon" href="/img/favicon.ico">

  <!-- css -->
  <link rel="stylesheet" href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="/css/Annie.css">
  
  <!-- jquery -->
	<script src="/js/jquery.min.js"></script>

  <!-- leancloud -->
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"></script>
<script src="/js/leancloud.js"></script>
</head>
	<body>
		<!-- Preloader -->


<!-- header -->
<header class="fixbackground" data-img-mode="normal" data-normal-src="/img/bufsnake.png" data-random-max="110" data-random-src="https://sariay.github.io/Random-img/">
	<div class="mask">
		<!-- Logo and navigation -->
		<div class="h-header">
			<div id="logo">
				<a href="/">
						
						<img src="/images/bufsnake.png" alt="Logo">
					
				</a>
			</div>
			
			<div id="navigation-show">
				<ul>
	
		<li class="menu-home">
			<a href="/" class="menu-item-home">主页</a>
		</li>
	
		<li class="menu-archive">
			<a href="/archives" class="menu-item-archive">归档</a>
		</li>
	
		<li class="menu-categories">
			<a href="/categories" class="menu-item-categories">分类</a>
		</li>
	
		<li class="menu-tags">
			<a href="/tags" class="menu-item-tags">标签</a>
		</li>
	
		<li class="menu-about">
			<a href="/about" class="menu-item-about">关于</a>
		</li>
	
		<li class="menu-gallery">
			<a href="/gallery" class="menu-item-gallery">相册</a>
		</li>
	
		<li class="menu-friend">
			<a href="/friend" class="menu-item-friend">友链</a>
		</li>
	

	
		<li class="menu-search">
			<a href="javascript:;" class="popup-trigger">搜索</a>
		</li>
	
</ul>
			</div>				
		</div>

		<!-- motto -->
		<div class="h-body">	
			
				<p class="motto"></p>
			
		</div>
		
		<!-- others: such as time... -->			
		<div class="h-footer">
			<a href="javascript:;" id="read-more"><i class="fa fa-angle-double-down" aria-hidden="true"></i>
			</a>

			
				<!-- 
	This is only a demo, please go to "https://time.is" to set your city time! 
-->
<style type="text/css">
	.header-date {
		font-size: 1.6rem;
		color: #fff;
		position: absolute;
		bottom: 5px;
		right: 1rem;
		writing-mode: tb-rl;
	}	
	
	.header-date a {
		border-bottom: none;
	}

	@media only screen and (max-width: 768 ) {
		.header-date {
			font-size: 1rem;
		}			
	}
</style>
<div class="header-date">
	<a href="https://time.is/Beijing" id="time_is_link" rel="nofollow"></a>
	<span id="Beijing_z43d"></span>
</div>
<script src="//widget.time.is/zh.js"></script>
<script>
	time_is_widget.init({
		Beijing_z43d:{
			template:"DATE", 
			date_format:"year年 monthname dnum日"
		}
	});
</script>
			
		</div>
	</div>
</header>

<div id="navigation-hide">
	<!-- Progress bar -->
	<div id="progress-bar"></div>

	<!-- Progress percent -->
	<div id="progress-percentage"><h1>0.0%</h1></div>

	<div class="toc-switch"><span class="switch-button">目录</span></div>

	<!-- Page title -->
	<p>
		
			主页
		
	</p>

	<!-- Nav trigger for navigation-H-->
	<a class="nav-trigger"><span></span></a>
</div>

<!-- Navigation in div(id="navigation-H") -->
<nav class="nav-container" id="cd-nav">
	<div class="nav-header">
		<h3>Navigation</h3>
		<a href="javascript:;" class="nav-close"></a>
	</div>
	<div class="nav-body">
		<ul>
	
		<li class="menu-home">
			<a href="/" class="menu-item-home">主页</a>
		</li>
	
		<li class="menu-archive">
			<a href="/archives" class="menu-item-archive">归档</a>
		</li>
	
		<li class="menu-categories">
			<a href="/categories" class="menu-item-categories">分类</a>
		</li>
	
		<li class="menu-tags">
			<a href="/tags" class="menu-item-tags">标签</a>
		</li>
	
		<li class="menu-about">
			<a href="/about" class="menu-item-about">关于</a>
		</li>
	
		<li class="menu-gallery">
			<a href="/gallery" class="menu-item-gallery">相册</a>
		</li>
	
		<li class="menu-friend">
			<a href="/friend" class="menu-item-friend">友链</a>
		</li>
	

	
		<li class="menu-search">
			<a href="javascript:;" class="popup-trigger">搜索</a>
		</li>
	
</ul>
	</div>
	<div class="nav-footer">
		<ul>
	
		<li>
			<a href="http://github.com/bufsnake" target="_blank">
				<i class="fa fa-github"></i>
			</a>
		</li>
	
		<li>
			<a href="/atom.xml" target="_blank">
				<i class="fa fa-rss"></i>
			</a>
		</li>
			
</ul>

	</div>
</nav>
			
		<!--main-->
		<main>
			



	<!--pure style-->
	<div class="layout-pure">
	<div id="layout-pure">	
	
		<div class="post" id="post">
			<div class="post-text">
				<div class="post-title" id="post-title-index">			
					<i class="fa fa-paper-plane-o" aria-hidden="true"></i>
					
	<a href="/MacOS-IDA-pro-致最傻的我.html" itemprop="url">
		MacOS上IDA pro的小问题修复
	</a>

				</div>

				<div class="post-content">
					
						前言
每次打开ida32位版本的，都会出现卡顿几秒的情况，之前也想办法解决了，但是没能成功，趁着国庆的喜气，搞了一下，才知道是个啥情况，这里简单记录一下。

权限问题

第一次遇到文件权限后门带@的，以为是这个问题，然后就疯狂Google，才得知这是Mac OS X文件系统的附加属性


文件的读写权限中被加上了一个@符号，这就是 Mac OS X 文件系统的附加属性（extended attributes）


这个属性下，打开文件显示错误为：项目“XXX”已被OS X 使用，不能打开

xattr1xattr -c filename # 可以清除这个附加属性

天真的以为清除附加属性...
					
				</div>
				
				<div class="post-meta">
					<span>
						发布于
						<i>
							






	<a href="/MacOS-IDA-pro-致最傻的我.html" itemprop="url">
		<time datetime="2019-09-30T13:04:55.000Z" itemprop="datePublished">
	  		2019-09-30
	  </time>
	</a> 

						</i>
					</span>
					
					



					

	<!-- leancloud -->
	<!--
	时间：2018-11-27
	描述：
		文章访问量：visitors
		文章喜欢量：likes	
		文章排行榜：topNPost
		其他得说明：
			01-Cookie相关的函数 
				https://blog.csdn.net/somehow1002/article/details/78511541（Author：somehow1002）
			02-visitors相关的函数 
				https://blog.csdn.net/u013553529/article/details/63357382（Author：爱博客大伯）
				https://notes.doublemine.me/2015-10-21-为NexT主题添加文章阅读量统计功能.html（Author：夏末）
			03-topNPost相关的函数
				https://hoxis.github.io/hexo-next-read-rank.html（Author：hoxis）
			04-likes相关的函数，
				参考了01 & 02进行简单的设计与实现
-->


	

					
						<span class="right">      	
							<a href="/MacOS-IDA-pro-致最傻的我.html" title="阅读全文">阅读全文</a>	
						</span>
					
				</div>
			</div>
		</div>
	
		<div class="post" id="post">
			<div class="post-text">
				<div class="post-title" id="post-title-index">			
					<i class="fa fa-paper-plane-o" aria-hidden="true"></i>
					
	<a href="/PHPStudy后门研究.html" itemprop="url">
		PHPStudy后门研究
	</a>

				</div>

				<div class="post-content">
					
						
声明：分析文章仅限用于学习和研究目的,不得将学习成果用于商业或者非法用途,否则,一切后果请用户自负.


PHPStudy 后门文件
php/ext目录下的php_xmlrpc.dll文件 。


检测是否存在后门
记事本打开文件，查看是否存在如下所示的字符串，如果有说明存在后门，可升级官方最新版。


IDA分析后门文件
根据字符串信息，快速定位关键函数





根据判断请求头的Accept-Encoding是否为gzip,deflate进行判断Accept-Charset的值base64解密是否成功，如果成功就对它进行gzcompress压缩，然后执行@eval(gzuncomp...
					
				</div>
				
				<div class="post-meta">
					<span>
						发布于
						<i>
							






	<a href="/PHPStudy后门研究.html" itemprop="url">
		<time datetime="2019-09-25T04:07:14.000Z" itemprop="datePublished">
	  		2019-09-25
	  </time>
	</a> 

						</i>
					</span>
					
					



					

	<!-- leancloud -->
	<!--
	时间：2018-11-27
	描述：
		文章访问量：visitors
		文章喜欢量：likes	
		文章排行榜：topNPost
		其他得说明：
			01-Cookie相关的函数 
				https://blog.csdn.net/somehow1002/article/details/78511541（Author：somehow1002）
			02-visitors相关的函数 
				https://blog.csdn.net/u013553529/article/details/63357382（Author：爱博客大伯）
				https://notes.doublemine.me/2015-10-21-为NexT主题添加文章阅读量统计功能.html（Author：夏末）
			03-topNPost相关的函数
				https://hoxis.github.io/hexo-next-read-rank.html（Author：hoxis）
			04-likes相关的函数，
				参考了01 & 02进行简单的设计与实现
-->


	

					
						<span class="right">      	
							<a href="/PHPStudy后门研究.html" title="阅读全文">阅读全文</a>	
						</span>
					
				</div>
			</div>
		</div>
	
		<div class="post" id="post">
			<div class="post-text">
				<div class="post-title" id="post-title-index">			
					<i class="fa fa-paper-plane-o" aria-hidden="true"></i>
					
	<a href="/模2运算.html" itemprop="url">
		模2运算
	</a>

				</div>

				<div class="post-content">
					
						模2运算
简介：将数字换算成二进制的形式进行运算，无进位也无借位。

模2加法12345678910111213141516171 + 1 = 01 + 0 = 10 + 1 = 10 + 0 = 0    1010101+   1000101————————————    0010000     10101011+   10100111+   11100010————————————    11101110奇数个1相加得1，偶数个1相加得0
模2减法1234567891011121314151 - 1 = 01 - 0 = 10 - 1 = 10 - 0 = 0    1010101-...
					
				</div>
				
				<div class="post-meta">
					<span>
						发布于
						<i>
							






	<a href="/模2运算.html" itemprop="url">
		<time datetime="2019-09-17T10:13:39.000Z" itemprop="datePublished">
	  		2019-09-17
	  </time>
	</a> 

						</i>
					</span>
					
					



					

	<!-- leancloud -->
	<!--
	时间：2018-11-27
	描述：
		文章访问量：visitors
		文章喜欢量：likes	
		文章排行榜：topNPost
		其他得说明：
			01-Cookie相关的函数 
				https://blog.csdn.net/somehow1002/article/details/78511541（Author：somehow1002）
			02-visitors相关的函数 
				https://blog.csdn.net/u013553529/article/details/63357382（Author：爱博客大伯）
				https://notes.doublemine.me/2015-10-21-为NexT主题添加文章阅读量统计功能.html（Author：夏末）
			03-topNPost相关的函数
				https://hoxis.github.io/hexo-next-read-rank.html（Author：hoxis）
			04-likes相关的函数，
				参考了01 & 02进行简单的设计与实现
-->


	

					
						<span class="right">      	
							<a href="/模2运算.html" title="阅读全文">阅读全文</a>	
						</span>
					
				</div>
			</div>
		</div>
	
		<div class="post" id="post">
			<div class="post-text">
				<div class="post-title" id="post-title-index">			
					<i class="fa fa-paper-plane-o" aria-hidden="true"></i>
					
	<a href="/Xposed-hook框架学习.html" itemprop="url">
		Xposed hook框架学习
	</a>

				</div>

				<div class="post-content">
					
						Xposed 安装xposed.apk

框架

初次运行是点击 安装/更新 就行了，后续在激活模块的时候可以点击 软重启 重启手机(模拟器)

模块

显示已安装的模块，打勾的说明是已经激活的

下载

显示网上已经有的模块，别人开发好的，可以直接拿过来用的那种

设置
日志

显示模块运行时后的日志信息，可用来显示XposedBridge.log(“”);打印出来的消息

关于
第一个模块学习在build.gradle中添加信息12compileOnly 'de.robv.android.xposed:api:82'compileOnly 'de.robv.android.xpose...
					
				</div>
				
				<div class="post-meta">
					<span>
						发布于
						<i>
							






	<a href="/Xposed-hook框架学习.html" itemprop="url">
		<time datetime="2019-09-09T10:11:11.000Z" itemprop="datePublished">
	  		2019-09-09
	  </time>
	</a> 

						</i>
					</span>
					
					



					

	<!-- leancloud -->
	<!--
	时间：2018-11-27
	描述：
		文章访问量：visitors
		文章喜欢量：likes	
		文章排行榜：topNPost
		其他得说明：
			01-Cookie相关的函数 
				https://blog.csdn.net/somehow1002/article/details/78511541（Author：somehow1002）
			02-visitors相关的函数 
				https://blog.csdn.net/u013553529/article/details/63357382（Author：爱博客大伯）
				https://notes.doublemine.me/2015-10-21-为NexT主题添加文章阅读量统计功能.html（Author：夏末）
			03-topNPost相关的函数
				https://hoxis.github.io/hexo-next-read-rank.html（Author：hoxis）
			04-likes相关的函数，
				参考了01 & 02进行简单的设计与实现
-->


	

					
						<span class="right">      	
							<a href="/Xposed-hook框架学习.html" title="阅读全文">阅读全文</a>	
						</span>
					
				</div>
			</div>
		</div>
	
		<div class="post" id="post">
			<div class="post-text">
				<div class="post-title" id="post-title-index">			
					<i class="fa fa-paper-plane-o" aria-hidden="true"></i>
					
	<a href="/frida-Hook神器学习-1.html" itemprop="url">
		frida Hook神器学习-1
	</a>

				</div>

				<div class="post-content">
					
						Android三大框架对比Frida，Xposed，SubstrateCydia这三个Hook神器的区别和优缺点：Xposed的优缺点
优点：在编写Java层hook插件的时候非常好用，这一点完全优越于Frida和SubstrateCydia，因为他也是Android项目，可以直接编写Java代码调用各类api进行操作。而且可以安装到手机上直接使用。


缺点：配置安装环境繁琐，兼容性差，在Hook底层的时候就很无助了。

Frida的优缺点
优点：在上面我们可以看到他的优点在于配置环境很简单，操作也很便捷，对于破解者开发阶段非常好用。支持Java层和Native层hook操作，在Nat...
					
				</div>
				
				<div class="post-meta">
					<span>
						发布于
						<i>
							






	<a href="/frida-Hook神器学习-1.html" itemprop="url">
		<time datetime="2019-08-26T14:03:48.000Z" itemprop="datePublished">
	  		2019-08-26
	  </time>
	</a> 

						</i>
					</span>
					
					



					

	<!-- leancloud -->
	<!--
	时间：2018-11-27
	描述：
		文章访问量：visitors
		文章喜欢量：likes	
		文章排行榜：topNPost
		其他得说明：
			01-Cookie相关的函数 
				https://blog.csdn.net/somehow1002/article/details/78511541（Author：somehow1002）
			02-visitors相关的函数 
				https://blog.csdn.net/u013553529/article/details/63357382（Author：爱博客大伯）
				https://notes.doublemine.me/2015-10-21-为NexT主题添加文章阅读量统计功能.html（Author：夏末）
			03-topNPost相关的函数
				https://hoxis.github.io/hexo-next-read-rank.html（Author：hoxis）
			04-likes相关的函数，
				参考了01 & 02进行简单的设计与实现
-->


	

					
						<span class="right">      	
							<a href="/frida-Hook神器学习-1.html" title="阅读全文">阅读全文</a>	
						</span>
					
				</div>
			</div>
		</div>
	
		<div class="post" id="post">
			<div class="post-text">
				<div class="post-title" id="post-title-index">			
					<i class="fa fa-paper-plane-o" aria-hidden="true"></i>
					
	<a href="/记一次简单的条件竞争的题目.html" itemprop="url">
		记一次简单的条件竞争的题目
	</a>

				</div>

				<div class="post-content">
					
						前言
一直对这个漏洞只有概念上的认知，没有做过相关的题目，就找了一个入门的练练手

题目

我们可以控制文件的名字和文件的内容




但是当我们访问的时候去发现访问不到，猜想应该是被删了，这就要利用条件竞争这个漏洞了

概念
创建一个多线程程序不断的向服务器发起请求创建一个文件，在创建一个程序循环读取这个文件


这里使用burp suite进行申请创建文件，写一个死循环读取这个文件




在start attack之前需要先运行访问的脚本






可以得到内容，这题旨在能够访问到这个文件就能拿到flag

总结
Y3RmZXIldTY2MkYldTRFMEQldTY2MkYld...
					
				</div>
				
				<div class="post-meta">
					<span>
						发布于
						<i>
							






	<a href="/记一次简单的条件竞争的题目.html" itemprop="url">
		<time datetime="2019-08-22T12:50:08.000Z" itemprop="datePublished">
	  		2019-08-22
	  </time>
	</a> 

						</i>
					</span>
					
					



					

	<!-- leancloud -->
	<!--
	时间：2018-11-27
	描述：
		文章访问量：visitors
		文章喜欢量：likes	
		文章排行榜：topNPost
		其他得说明：
			01-Cookie相关的函数 
				https://blog.csdn.net/somehow1002/article/details/78511541（Author：somehow1002）
			02-visitors相关的函数 
				https://blog.csdn.net/u013553529/article/details/63357382（Author：爱博客大伯）
				https://notes.doublemine.me/2015-10-21-为NexT主题添加文章阅读量统计功能.html（Author：夏末）
			03-topNPost相关的函数
				https://hoxis.github.io/hexo-next-read-rank.html（Author：hoxis）
			04-likes相关的函数，
				参考了01 & 02进行简单的设计与实现
-->


	

					
						<span class="right">      	
							<a href="/记一次简单的条件竞争的题目.html" title="阅读全文">阅读全文</a>	
						</span>
					
				</div>
			</div>
		</div>
	
		<div class="post" id="post">
			<div class="post-text">
				<div class="post-title" id="post-title-index">			
					<i class="fa fa-paper-plane-o" aria-hidden="true"></i>
					
	<a href="/cookie欺骗-writeup.html" itemprop="url">
		cookie欺骗 writeup
	</a>

				</div>

				<div class="post-content">
					
						
Begin



发现filename为keys.txt的base64加密，试着读取index.php文件



发现能读到东西了，接下来读取整个文件

1234567from requests import *from base64 import *for i in range(0,20):    url = "http://123.206.87.240:8002/web11/index.php?line=%d&amp;filename=aW5kZXgucGhw"%i    respone = get(url=url)    print respone.text
1234567891...
					
				</div>
				
				<div class="post-meta">
					<span>
						发布于
						<i>
							






	<a href="/cookie欺骗-writeup.html" itemprop="url">
		<time datetime="2019-08-21T07:08:16.000Z" itemprop="datePublished">
	  		2019-08-21
	  </time>
	</a> 

						</i>
					</span>
					
					



					

	<!-- leancloud -->
	<!--
	时间：2018-11-27
	描述：
		文章访问量：visitors
		文章喜欢量：likes	
		文章排行榜：topNPost
		其他得说明：
			01-Cookie相关的函数 
				https://blog.csdn.net/somehow1002/article/details/78511541（Author：somehow1002）
			02-visitors相关的函数 
				https://blog.csdn.net/u013553529/article/details/63357382（Author：爱博客大伯）
				https://notes.doublemine.me/2015-10-21-为NexT主题添加文章阅读量统计功能.html（Author：夏末）
			03-topNPost相关的函数
				https://hoxis.github.io/hexo-next-read-rank.html（Author：hoxis）
			04-likes相关的函数，
				参考了01 & 02进行简单的设计与实现
-->


	

					
						<span class="right">      	
							<a href="/cookie欺骗-writeup.html" title="阅读全文">阅读全文</a>	
						</span>
					
				</div>
			</div>
		</div>
	
		<div class="post" id="post">
			<div class="post-text">
				<div class="post-title" id="post-title-index">			
					<i class="fa fa-paper-plane-o" aria-hidden="true"></i>
					
	<a href="/掘安RE_crypto.html" itemprop="url">
		jactf-reverse3
	</a>

				</div>

				<div class="post-content">
					
						RE_crypto
ida


程序逻辑不难，输入的字符作为unk_4021A0数组的下标，定位该下标所对应的值，与((v11 + v12) ^ 0x19)比较，这个值是可以自己算出来的

exp12345678910111213141516171819202122byte1=[0x32,0x61,0x34,0x39,0x66,0x36,0x39,0x63,0x33,0x38,0x33,0x39,0x35,0x63,0x64,0x65,0x39,0x36,0x64,0x36,0x64,0x65,0x39,0x36,0x64,0x36,0x66,0x34,0x65,0x30,0x32,0x...
					
				</div>
				
				<div class="post-meta">
					<span>
						发布于
						<i>
							






	<a href="/掘安RE_crypto.html" itemprop="url">
		<time datetime="2019-08-16T11:55:57.000Z" itemprop="datePublished">
	  		2019-08-16
	  </time>
	</a> 

						</i>
					</span>
					
					



					

	<!-- leancloud -->
	<!--
	时间：2018-11-27
	描述：
		文章访问量：visitors
		文章喜欢量：likes	
		文章排行榜：topNPost
		其他得说明：
			01-Cookie相关的函数 
				https://blog.csdn.net/somehow1002/article/details/78511541（Author：somehow1002）
			02-visitors相关的函数 
				https://blog.csdn.net/u013553529/article/details/63357382（Author：爱博客大伯）
				https://notes.doublemine.me/2015-10-21-为NexT主题添加文章阅读量统计功能.html（Author：夏末）
			03-topNPost相关的函数
				https://hoxis.github.io/hexo-next-read-rank.html（Author：hoxis）
			04-likes相关的函数，
				参考了01 & 02进行简单的设计与实现
-->


	

					
						<span class="right">      	
							<a href="/掘安RE_crypto.html" title="阅读全文">阅读全文</a>	
						</span>
					
				</div>
			</div>
		</div>
	
		<div class="post" id="post">
			<div class="post-text">
				<div class="post-title" id="post-title-index">			
					<i class="fa fa-paper-plane-o" aria-hidden="true"></i>
					
	<a href="/记一次控制流平坦化逆向.html" itemprop="url">
		记一次控制流平坦化逆向
	</a>

				</div>

				<div class="post-content">
					
						flat

是控制流平坦化的题目

ida

可以分析出函数的5个主要函数



fun_check1(char *a1) 主要作用是检查输入字符串长度



fun_check1(char *a1) 主要作用是检查输入前五个字节是否为flag{



fun_check3(char *a1) 主要作用是检查输入的最后一个字节是否为}



fun_check4(char *a1) 主要作用是检查输入的几个特殊部位的值是否为—





输入的字符串进行加密后与字符串进行比较



这就是比较的那个字符串 J2261C63-3I2I-EGE4-IBCC-IE41A5I5F4HB


循环...
					
				</div>
				
				<div class="post-meta">
					<span>
						发布于
						<i>
							






	<a href="/记一次控制流平坦化逆向.html" itemprop="url">
		<time datetime="2019-08-15T13:47:56.000Z" itemprop="datePublished">
	  		2019-08-15
	  </time>
	</a> 

						</i>
					</span>
					
					



					

	<!-- leancloud -->
	<!--
	时间：2018-11-27
	描述：
		文章访问量：visitors
		文章喜欢量：likes	
		文章排行榜：topNPost
		其他得说明：
			01-Cookie相关的函数 
				https://blog.csdn.net/somehow1002/article/details/78511541（Author：somehow1002）
			02-visitors相关的函数 
				https://blog.csdn.net/u013553529/article/details/63357382（Author：爱博客大伯）
				https://notes.doublemine.me/2015-10-21-为NexT主题添加文章阅读量统计功能.html（Author：夏末）
			03-topNPost相关的函数
				https://hoxis.github.io/hexo-next-read-rank.html（Author：hoxis）
			04-likes相关的函数，
				参考了01 & 02进行简单的设计与实现
-->


	

					
						<span class="right">      	
							<a href="/记一次控制流平坦化逆向.html" title="阅读全文">阅读全文</a>	
						</span>
					
				</div>
			</div>
		</div>
	
		<div class="post" id="post">
			<div class="post-text">
				<div class="post-title" id="post-title-index">			
					<i class="fa fa-paper-plane-o" aria-hidden="true"></i>
					
	<a href="/记一次简单的VM程序逆向.html" itemprop="url">
		记一次简单的VM程序逆向
	</a>

				</div>

				<div class="post-content">
					
						题目来源vm crackme


程序给了三个文件，主要是要求我们通过分析vm1.exe文件的虚拟机，然后自己实现虚拟机，执行ram.bin中的opcode

ida分析

程序先申请一个堆，然后将unk_404040copy到Dst中，进而执行sub_4022e0_



依次取出Dst中的数据，然后调用sub_402270，可知255之后的数据是opcode，255之前的数据是data



这就是opcode执行的主要函数

实现自己的虚拟机1234567891011121314151617181920212223242526272829f = open("./ram.bin","...
					
				</div>
				
				<div class="post-meta">
					<span>
						发布于
						<i>
							






	<a href="/记一次简单的VM程序逆向.html" itemprop="url">
		<time datetime="2019-08-14T09:19:17.000Z" itemprop="datePublished">
	  		2019-08-14
	  </time>
	</a> 

						</i>
					</span>
					
					



					

	<!-- leancloud -->
	<!--
	时间：2018-11-27
	描述：
		文章访问量：visitors
		文章喜欢量：likes	
		文章排行榜：topNPost
		其他得说明：
			01-Cookie相关的函数 
				https://blog.csdn.net/somehow1002/article/details/78511541（Author：somehow1002）
			02-visitors相关的函数 
				https://blog.csdn.net/u013553529/article/details/63357382（Author：爱博客大伯）
				https://notes.doublemine.me/2015-10-21-为NexT主题添加文章阅读量统计功能.html（Author：夏末）
			03-topNPost相关的函数
				https://hoxis.github.io/hexo-next-read-rank.html（Author：hoxis）
			04-likes相关的函数，
				参考了01 & 02进行简单的设计与实现
-->


	

					
						<span class="right">      	
							<a href="/记一次简单的VM程序逆向.html" title="阅读全文">阅读全文</a>	
						</span>
					
				</div>
			</div>
		</div>
	
	</div>

	
	<div id="pagination">
		
			<a href="/page/3/" data-title="加载更多" data-status="没有了">加载更多</a>
		
	</div>

	

</div>


		</main>

		<!--footer-->
		
		
	<!-- set '1' to show motto in all pages! -->

	<script src="/plugin/motto/motto.js"></script>
	
	<script type="text/javascript">
		$(".motto").html( getMingYanContent() );
	</script>	




	<!--
	时间：2018-10-3
	描述：
		插件名称：hexo-generator-search-zip
		插件来源: https://github.com/SuperKieran/hexo-generator-search-zip
		代码参考：https://github.com/SuperKieran/TKL/blob/master/layout/_partial/search.ejs(Include: js & css)	
-->
<div class="popup search-popup local-search-popup">
	<div class="local-search-container">
		<span class="popup-btn-close">
      		ESC
   		</span>
		<div class="local-search-header">
			<div class="input-prompt">				
			</div>
			<input autocomplete="off" placeholder="Search..." type="text" id="local-search-input">
		</div>
		<div class="local-search-body">
			<div id="local-search-output"></div>
		</div>
		<div class="local-search-footer">
			<div class="topN-post">				
				
								
			</div>
		</div>
	</div>
</div>

<script src="/plugin/search/ziploader.js"></script>
<script src="/plugin/search/search.js"></script>

<script type="text/javascript">
	var search_path = 'search.xml',
		zip_Path = '/',
		version_Path = '/',
		input_Trigger = 'auto',
		top_N = '2';

	themeLocalSearch({
		search_path, 
		zip_Path, 
		version_Path, 
		input_Trigger, 
		top_N
	});
</script>


<!-- love effect -->

	<script src="/plugin/love/love.js"></script>


<!-- back to top -->

	
	<div id="totop">
  		<a href="javascript:;" name="TOTOP" class="fa fa-arrow-up"></a>
	</div>




<!-- site analysis -->


	<!-- site-analysis -->
	
<script>
	var _hmt = _hmt || [];
	(function() {
		var hm = document.createElement("script");
		hm.src = "//hm.baidu.com/hm.js?926b66e71d8f61b2a08a4f0da34fef80";
		var s = document.getElementsByTagName("script")[0];
		s.parentNode.insertBefore(hm, s);
	})();
</script>


	
	
<!-- Google Analytics -->
<script type="text/javascript">
	(function(i, s, o, g, r, a, m) {
		i['GoogleAnalyticsObject'] = r;
		i[r] = i[r] || function() {
			(i[r].q = i[r].q || []).push(arguments)
		}, i[r].l = 1 * new Date();
		a = s.createElement(o),
			m = s.getElementsByTagName(o)[0];
		a.async = 1;
		a.src = g;
		m.parentNode.insertBefore(a, m)
	})(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');
	ga('create', 'UA-145389457-1', 'auto');
	ga('send', 'pageview');
</script>
<!-- End Google Analytics -->

	
	
 

<script src="/plugin/vibrant/vibrant.js"></script>
<script src="/plugin/chinese/chinese.js"></script>
<script src="/plugin/imgLazyLoader/yall.min.js"></script>
<script src="/plugin/imgResize/jquery.resizeimagetoparent.min.js"></script>
<script src="/plugin/nicescroll/jquery.nicescroll.js"></script>
<script src="/js/resizediv.js"></script>
<script src="/js/main.js"></script>
	</body>	
</html>